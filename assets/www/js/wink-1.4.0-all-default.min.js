define=function(){if(typeof wink=="undefined")wink={};var b=arguments,a=b.length;return(a==1?b[0]:a==2?b[1]:b[2])(wink)};define.amd={vendor:"winktoolkit.org"};define(function(){if(typeof wink=="undefined")wink={};return wink});
define(["../../_kernel/js/kernel"],function(b){b.version="1.4.0";b.api={};b.mm={};b.net={};b.plugins={};b.ui={form:{},layout:{},xy:{},xyz:{}};b.ux={};var a=Array.prototype.slice,c=window;b.byId=function(g){return b.isString(g)?document.getElementById(g):g};b.query=function(g,f){return a.call((f||document).querySelectorAll(g))};var d="en_EN";b.setLocale=function(g){d=g};b.translate=function(g,f){var h=g,i=window.i18n||{};if(b.isSet(f)&&b.isSet(f.i18n))i=f.i18n;var j=i[d];if(b.isUndefined(j))j=i;i=
j[g];b.isUndefined(i)||(h=i);return h};b.isUndefined=function(g){return g===undefined};b.isNull=function(g){return g===null};b.isSet=function(g){return!b.isUndefined(g)&&!b.isNull(g)};b.isCallback=function(g){return!!(g&&g.method)};b.isString=function(g){return typeof g=="string"||g instanceof String};b.isInteger=function(g){return parseInt(g)===g};b.isNumber=function(g){return typeof g=="number"||g instanceof Number};b.isArray=function(g){return typeof g=="array"||g instanceof Array};b.isBoolean=
function(g){return typeof g=="boolean"||g instanceof Boolean};b.isFunction=function(g){return Object.prototype.toString.call(g)==="[object Function]"};b.trim=function(g){return g.replace(/^\s\s*/,"").replace(/\s\s*$/,"")};b.bind=function(g,f){var h=a.call(arguments,2);return function(){var i=h.concat(a.call(arguments,0));return g.apply(f,i)}};b.call=function(g,f){var h=c,i=g.method,j=[];if(b.isSet(g.context))h=g.context;if(arguments.length==2)j=[f];if(b.isSet(g.arguments)){var l=g.arguments;b.isArray(l)||
(l=[g.arguments]);j=j.concat(l)}return h[i].apply(h,j)};b.connect=function(g,f,h){if(!b.isSet(h.context))h.context=c;var i=g[f];if(b.isNull(i)||b.isUndefined(i.cbs)){var j=function(){var k=arguments.callee.target,m=[],n,o=arguments.length;for(n=0;n<o;n++){var p=arguments[n];m=b.isArray(p)?m.concat([p]):m.concat(p)}k&&k.apply(g,m);k=g[f].cbs;for(var q in k)b.isArray(k[q].arguments)?b.call({context:k[q].context,method:k[q].method,arguments:m.concat(k[q].arguments)}):b.call({context:k[q].context,method:k[q].method,
arguments:m.concat([k[q].arguments])})};j.target=i;j.cbs=[];i=g[f]=j}for(var l in i.cbs)if(i.cbs[l].context==h.context&&i.cbs[l].method==h.method)return;i.cbs.push(h)};b.disconnect=function(g,f,h){if(!b.isSet(h.context))h.context=c;g=g[f];if(!b.isUndefined(g.cbs))for(var i in g.cbs)g.cbs[i].context==h.context&&g.cbs[i].method==h.method&&delete g.cbs[i]};b.setTimeout=function(g,f,h){var i=a.call(arguments,3);return setTimeout(function(){g[f].apply(g,i)},h)};b.setInterval=function(g,f,h){var i=a.call(arguments,
3);return setInterval(function(){g[f].apply(g,i)},h)};var e=100;b.getUId=function(){return e+=1};if(b.isUndefined(c._))_=b.bind(b.translate,b);if(b.isUndefined(c.$$))$$=b.bind(b.query,b);if(b.isUndefined(c.$))$=b.bind(b.byId,b);return b});
define(["../../../_base/_base/js/base"],function(b){var a=HTMLElement.prototype,c=b.isUndefined,d=function(l){var k=0,m=this;if(b.isSet(l))for(;m&&m!=l;){k+=m.offsetTop;m=m.offsetParent}else for(;m;){k+=m.offsetTop;m=m.offsetParent}return k},e=function(l){var k=0,m=this;if(b.isSet(l))for(;m&&m!=l;){k+=m.offsetLeft;m=m.offsetParent}else for(;m;){k+=m.offsetLeft;m=m.offsetParent}return k},g=function(l,k,m){b.fx.applyTranslate(this,l,k,m)},f=function(l,k){b.fx.applyScale(this,l,k)},h=function(l){b.fx.applyRotate(this,
l)},i=function(l,k,m){b.ux.gesture.listenTo(this,l,k,m)},j=function(l,k){b.ux.gesture.unlistenTo(this,l,k)};a.winkGetTopPosition=d;a.winkGetLeftPosition=e;a.winkTranslate=g;a.winkScale=f;a.winkRotate=h;a.winkListenToGesture=i;a.winkUnlistenToGesture=j;if(c(a.getTopPosition))a.getTopPosition=d;if(c(a.getLeftPosition))a.getLeftPosition=e;if(c(a.rotate))a.rotate=h;if(c(a.scale))a.scale=f;if(c(a.translate))a.translate=g;if(c(a.listenToGesture))a.listenToGesture=i;if(c(a.unlistenToGesture))a.unlistenToGesture=
j;return b});define(["../../../_base/_base/js/base"],function(b){b.error={logLevel:0,log:function(a){if(this.logLevel==1)typeof console!="undefined"?console.log(a):alert(a)}};b.log=b.bind(b.error.log,b.error);return b.error});
define(["../../../_base/_base/js/base"],function(b){var a=window.JSON;b.json={parse:function(c){if(b.isSet(a)&&b.isSet(a.parse))return a.parse(c);else{var d=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;c=String(c);d.lastIndex=0;if(d.test(c))c=c.replace(d,function(g){return"\\u"+("0000"+g.charCodeAt(0).toString(16)).slice(-4)});if(/^[\],:{}\s]*$/.test(c.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))var e=eval("("+c+")");return e}},concat:function(c,d){for(var e in d)c[e]=d[e];return c}};b.parseJSON=b.bind(b.json.parse,b.json);b.mixin=b.bind(b.json.concat,b.json);return b.json});
define(["../../../_base/_base/js/base","../../error/js/error"],function(b){var a=[],c=function(g,f){if(b.isCallback(f)){var h=[g.toLowerCase(),f];a.push(h)}},d=function(g,f){var h=g.toLowerCase(),i,j=a.length;for(i=0;i<j;i++){var l=a[i];if(l[0]==h&&l[1].method==f.method&&l[1].context==f.context){a.splice(i,1);break}}},e=function(g,f){var h=g.toLowerCase(),i,j=a.length;for(i=0;i<j;i++){var l=a[i];l&&l[0]==h&&b.isSet(l[1])&&b.call(l[1],f)}};b.topics={subscribe:c,unsubscribe:d,publish:e,_getTopics:function(){return a}};
b.publish=e;b.subscribe=c;b.unsubscribe=d;return b.topics});
define(["../../../_base/_base/js/base"],function(b){var a,c,d,e,g,f,h,i,j,l,k,m,n,o,p,q,s,t,u,r,v,x,B;a=c=d=e=g=f=h=i=v=x=B=false;j=l=k=m=n=o=p=q=s=0;var F=b.isSet;c=function(y,E){return RegExp(y).test(E)};var w=function(y,E,z){var I={v:0,r:0,u:0};y=RegExp(E).exec(y);if(F(y)&&y.length>1){y=y[2];E=RegExp("[^\\"+z+"0-9]").exec(y);if(F(E))y=y.slice(0,E.index);z=y.split(z);if(z.length>0)I.v=z[0];if(z.length>1)I.r=z[1];if(z.length>2)I.u=z[2];if(z.length>3)I.u+="."+z[3]}return I};a=navigator||{};t=a.userAgent;
u=a.platform;r=a.appVersion;a=c(" AppleWebKit/",t);x=c(/bada/gi,t);B=c(/Opera/gi,t);if(F(u)){if(c(/iphone/i,u))d=true;if(c(/ipod/i,u))e=true;if(c(/ipad/i,u))g=true;if(c(/blackberry/i,u))v=true}if(F(r)){if(c(/android/i,r))f=true;if(c(/safari/i,r)){h=true;u=w(r,"( Version/)([^ ]+)",".");m=u.v;n=u.r;o=u.u}}if(!h&&!a)i=c(/mozilla/i,t);c=d||e||f||v||x||c(" Mobile/",t);if(a){u=w(t,"( AppleWebKit/)([^ ]+)",".");j=u.v;l=u.r;k=u.u}if(c&&F(r)){p=f?["( Android )([^ ]+)","."]:["( OS )([^ ]+)","_"];if(v)p=["( BlackBerry )([^ ]+)",
"."];w=w(r,p[0],p[1]);p=w.v;q=w.r;s=w.u}b.ua={isWebkit:a,isMobile:c,isIPhone:d,isIPod:e,isIPad:g,isIOS:d||e||g,isAndroid:f,isBlackBerry:v,isBada:x,isOpera:B,isSafari:h,isMozilla:i,webkitVersion:j,webkitMinorVersion:l,webkitUpdateVersion:k,browserVersion:m,browserMinorVersion:n,browserUpdateVersion:o,osVersion:p,osMinorVersion:q,osUpdateVersion:s};return b.ua});
define(["../../../_base/_base/js/base"],function(b){function a(f){if(d(e[f]))e[f]=e[f]();return e[f]}function c(f,h,i){if(typeof e[f]=="undefined"){var j=h;if(i&&d(h))j=h();e[f]=j}}function d(f){return typeof f=="function"}var e={},g={};b.has=a;b.has.prefixes=["-webkit-","-moz-","-o-","-ms-","-khtml-"];b.has.prefix=null;b.has.inquire=c;b.has.inquireMap=function(f,h){if(!(!f||f.length==0))for(var i in f)c(i,f[i],h)};b.has.setProp=function(f,h){g[f]=h};b.has.deferProp=function(f,h){g[f]=d(h)?h:function(){a(h)}};
b.has.prop=function(f){var h=g[f];if(d(h)){h();h=g[f];if(d(h))h=f}return h||f};return b.has});define(["../../../_base/_base/js/base","./feat"],function(b){b=b.has;var a=b.inquire,c=window;a("json-parse",function(){var d;d=false;if(c.JSON&&typeof JSON.parse=="function"){d=JSON.parse('{"w":1}');d=!!(d&&d.w)}return d});return b});
define(["../../../_base/_base/js/base","./feat"],function(b){function a(o){var p=false;if(typeof l[o]==m){g(o,o);p=true}else{var q=d.prefix;q=q!=null?[q]:k;var s,t=q.length;for(s=0;s<t;s++){var u,r=q[s]+o;u=r;var v=/(-)([a-z])/;for(r=r.match(v);r!=null;){u=u.replace(v,RegExp.$2.toUpperCase());r=u.match(v)}u=u;if(typeof l[u]==m){d.prefix=q[s];g(o,u);p=true;break}}}return p}function c(o){return function(){a(o)}}var d=b.has,e=d.inquireMap,g=d.setProp,f=d.deferProp,h=window,i=h.document,j=i.createElement("div"),
l=j.style,k=d.prefixes,m="string",n={a:"transform-property",b:"transition-property",c:"transition-duration",d:"transition-delay",e:"transition-timing-function",f:"border-radius",g:"text-shadow",h:"box-shadow",i:"gradient",j:"perspective",k:"transform-origin",l:"transform-style",m:"transform",n:"css-transition",o:"css-perspective",p:"css-transform",q:"perspective-origin",r:"backface-visibility",s:"tap-highlight-color",t:"user-select",bg:"background-image"};f(n.a,n.p);f(n.m,n.p);f(n.b,n.n);f(n.c,n.n);
f(n.d,n.n);f(n.e,n.n);f(n.f,"css-border-radius");f(n.g,"css-text-shadow");f(n.h,"css-box-shadow");f(n.i,"css-gradient");f(n.j,n.o);f(n.k,n.o);f(n.l,n.o);f(n.q,n.o);f(n.r,c(n.r));f(n.s,c(n.s));f(n.t,c(n.t));e({"css-transform":function(){var o=a(n.m),p=d.prefix,q=n.m;if(p!=null)q=p+q;g(n.a,d.prop(n.m));g(n.m,q);return o},"css-transition":function(){var o=true;return o=(o=(o=(o=o&&a(n.b))&&a(n.c))&&a(n.d))&&a(n.e)},"css-translate3d":function(){return d("css-matrix")},"css-border-radius":function(){return a(n.f)},
"css-text-shadow":function(){return a(n.g)},"css-box-shadow":function(){return a(n.h)},"css-gradient":function(){var o=n.i,p=n.bg,q=d.prefix;q=q!=null?["",q]:[""].concat(k);var s,t=q.length;for(s=0;s<t;s++){var u=q[s]+o;l.cssText=p+":"+(u+"(linear,left top,right bottom,from(#9f9),to(white));");if(l[p]&&l[p].indexOf(o)!=-1){g(o,u);return true}}return false},"css-perspective":function(){var o=a(n.j)&&a(n.k)&&a(n.l)&&a(n.q);o=o&&a(n.k+"-x")&&a(n.k+"-y")&&a(n.k+"-z");if(!o)return false;var p=d.prefix||
"";o=i.createElement("style");o.textContent="@media ("+p+"transform-3d){#wink_has{height:2px}}";i.getElementsByTagName("head")[0].appendChild(o);j.id="wink_has";i.documentElement.appendChild(j);p=j.offsetHeight===2;o.parentNode.removeChild(o);j.parentNode.removeChild(j);return p},"css-matrix":function(){var o=h.WebKitCSSMatrix;if(typeof o=="undefined")return false;var p=new o("matrix(1,0,0,1,6,7)"),q=p.m41==6&&p.m42==7&&p.m41==p.e&&p.m42==p.f;if(q){o=new o("matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,6,7,8,1)");
q=q&&p.m41==o.m41&&p.m42==o.m42&&o.m43==8}return q},"css-matrix-stack-inversed":function(){var o=b.ua;if(!d("css-matrix")||!o)return false;return(o.isIOS?parseInt(""+o.osVersion+o.osMinorVersion+o.osUpdateVersion):500)<421},"css-position-fixed":function(){var o=b.ua;if(o.isAndroid&&o.osVersion==2&&o.osMinorVersion==1||o.isBada)return false;o=document.body;if(document.createElement&&o&&o.appendChild&&o.removeChild){if(!j.getBoundingClientRect)return null;j.innerHTML="x";j.style.cssText="position:fixed;top:100px;";
o.appendChild(j);var p=o.style.height,q=o.scrollTop;o.style.height="3000px";o.scrollTop=500;var s=j.getBoundingClientRect().top;o.style.height=p;p=s===100;o.removeChild(j);o.scrollTop=q;return p}return false}});return d});
define(["../../../_base/_base/js/base","./feat"],function(b){function a(h){return"on"+f[h]in g}var c=b.has;b=c.inquireMap;var d=c.setProp,e=c.deferProp,g=window.document.documentElement,f={ts:"touchstart",tm:"touchmove",te:"touchend",gs:"gesturestart",gc:"gesturechange",ge:"gestureend",tre:"transitionend"};e(f.ts,f.ts);e(f.tm,f.tm);e(f.te,f.te);e(f.tre,f.tre);b({touchstart:function(){var h=a("ts");d(f.ts,h?f.ts:"mousedown");return h},touchmove:function(){var h=a("tm");d(f.tm,h?f.tm:"mousemove");return h},
touchend:function(){var h=a("te");d(f.te,h?f.te:"mouseup");return h},touch:function(){return c(f.ts)&&c(f.tm)&&c(f.te)},gesturestart:function(){return a("gs")},gesturechange:function(){return a("gc")},gestureend:function(){return a("ge")},gesture:function(){return c(f.gs)&&c(f.gc)&&c(f.ge)},transitionend:function(){if(c("css-transition")){var h=c.prefix,i=f.tre;if(h=="-webkit-")i="webkitTransitionEnd";else if(h=="-o-")i="oTransitionEnd";d(f.tre,i);return true}return false}});return c});
define(["../../../_base/_base/js/base","./feat"],function(b){return b.has});
define(["../../../_base/_base/js/base","../../../_base/_feat/js/feat_css"],function(b){var a=b.isSet,c=b.has.prop,d={u:undefined},e=function(k,m){var n=k.className;if((" "+n+" ").indexOf(" "+m+" ")<0)k.className=n+(n?" ":"")+m},g=function(k,m){var n=b.trim((" "+k.className+" ").replace(" "+m+" "," "));if(k.className!=n)k.className=n},f=function(k,m){var n,o=k.style;for(n in m){var p=c(n);o[p]=m[n]}},h=function(k,m,n,o,p){var q=m;if(m.indexOf(",")==-1)q=c(m);else{m=m.split(",");var s=m.length;for(q=
0;q<s;q++)m[q]=c(b.trim(m[q]));q=m.join(",")}f(k,{"transition-property":q,"transition-duration":n,"transition-delay":o,"transition-timing-function":p})},i=function(k){return window.getComputedStyle(k)[c("transform-property")]},j=function(k,m){f(k,{"transform-property":m})},l=function(k,m,n,o,p,q,s){var t=k._cssT||{};t=k._cssT={t:a(m)||a(n)?{tx:m,ty:n}:t.t,s:a(o)||a(p)?{sx:o,sy:p}:t.s,r:a(q)?{a:q}:t.r};o=t.t&&(a(t.t.tx)||a(t.t.ty));n=t.s&&(a(t.s.sx)||a(t.s.sy));m=t.r&&a(t.r.a);if(!b.has("css-translate3d")||
b.ua.isAndroid&&(n||m))s=true;if(o){p=t.t.ty;s=s;o="";o=t.t.tx;a(o)||(o=0);p=p;a(p)||(p=0);q="0";var u=false;u=(u=u||b.isString(o)&&o.indexOf("%",0)!=-1)||b.isString(p)&&p.indexOf("%",0)!=-1;if(!u){o+="px";p+="px";q+="px"}s=o=s?"translate("+o+", "+p+")":"translate3d("+o+", "+p+", "+q+")"}else s="";s=s;if(n){n=t.s.sy;o="";o=t.s.sx;a(o)||(o=1);n=n;a(n)||(n=1);n=o="scale("+o+", "+n+")"}else n="";n=n;if(m){m="";t=t.r.a;a(t)||(t=0);t=m="rotate("+t+"deg)"}else t="";t=b.trim(s+" "+n+" "+t);j(k,t)};b.fx=
{addClass:e,removeClass:g,apply:f,applyTransition:h,applyTransformTransition:function(k,m,n,o){h(k,"transform",m,n,o)},onTransitionEnd:function(k,m,n){var o=c("transitionend"),p=function(q){n!==true&&k.removeEventListener(o,p,false);m(q)};k.addEventListener(o,p,false);return p},getTransformPosition:function(k){var m={x:null,y:null};k=i(k);if(b.has("css-matrix")){k=new WebKitCSSMatrix(k);m.x=k.m41;m.y=k.m42}else{var n=RegExp(/matrix/i);if(n.test(k)){n=RegExp("[, ()]+","g");k=k.split(n);if(k.length>
6&&k[0]=="matrix"){m.x=parseInt(k[5]);m.y=parseInt(k[6])}}}return m},applyTranslate:function(k,m,n,o){l(k,m,n,d.u,d.u,d.u,o)},applyScale:function(k,m,n){l(k,d.u,d.u,m,n,d.u,d.u)},applyRotate:function(k,m){l(k,d.u,d.u,d.u,d.u,m,d.u)},getTransform:i,setTransform:j};b.addClass=e;b.removeClass=g;return b.fx});define(["../../../_base/_base/js/base"],function(b){b.math={round:function(a,c){b.isSet(c)||(c=0);var d=Math.pow(10,c);return Math.round(a*d)/d}};return b.math});
define(["../../../_base/_base/js/base","../../../_base/error/js/error","../../../_base/json/js/json"],function(b){var a=b.isSet;b.ux.Event=function(c){this.uId=b.getUId();b.mixin(this,c);this._validateProperties()};b.ux.Event.prototype={preventDefault:function(){this.srcEvent.preventDefault()},stopPropagation:function(){this.srcEvent.stopPropagation()},dispatch:function(c,d){var e=this.srcEvent,g=e.type;if(a(d))g=d;g=g;var f="HTMLEvents";if(/blur|focus|resize|scroll/i.test(g))f="UIEvent";else if(/click|mouse(down|move|up)/i.test(g))f=
"MouseEvent";else if(/touch(start|move|end|cancel)/i.test(g))f="TouchEvent";var h=document.createEvent(f),i=e.changedTouches;if(f=="HTMLEvents")h.initEvent(g,e.bubbles,e.cancelable);else if(f=="UIEvent")h.initUIEvent(g,e.bubbles,e.cancelable,window,e.detail);else if(f=="MouseEvent"){f=e.screenX;var j=e.screenY,l=e.clientX,k=e.clientY;if(e.initTouchEvent&&i&&i.length>0){i=i[0];f=i.screenX;j=i.screenY;l=i.clientX;k=i.clientY}h.initMouseEvent(g,e.bubbles,e.cancelable,document.defaultView,e.detail,f,
j,l,k,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,e.relatedTarget)}else f=="TouchEvent"&&h.initTouchEvent(g,e.bubbles,e.cancelable,window,e.detail,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.touches,e.targetTouches,i,e.scale,e.rotation);c.dispatchEvent(h)},_validateProperties:function(){return true}};return b.ux.Event});
define(["../../../_base/_base/js/base","../../../_base/error/js/error","../../../_base/_feat/js/feat_event","../../event/js/event"],function(b){var a=[],c=b.has.prop,d={start:c("touchstart"),move:c("touchmove"),end:c("touchend"),gesturestart:c("gesturestart"),gesturechange:c("gesturechange"),gestureend:c("gestureend")},e={};for(var g in d)e[d[g]]=g;var f=function(i){var j={};j.x=i.pageX;j.y=i.pageY;j.target=i.target;return j},h=function(i){var j,l=a.length;for(j=0;j<l;j++)if(a[j].domNode==i)return j;
return null};b.ux.touch={addListener:function(i,j,l,k){if(b.isUndefined(d[j])){b.log("[touch] Cannot add listener for unknown eventType: "+j);return false}b.isSet(k)||(k={});if(k===true)k={preventDefault:true};k={preventDefault:k.preventDefault===true?true:false,tracking:k.tracking===false?false:true,captureFlow:k.captureFlow===true?true:false};var m=null,n=h(i);if(n==null){m=new b.ux.touch.Element({domNode:i,tracking:k.tracking});a.push(m)}else m=a[n];if(!m.isListening(j)){if(m.eventHandler==null)m.eventHandler=
function(o){var p=m,q=e[o.type],s={};s.type=q;s.srcEvent=o;s.timestamp=o.timeStamp;s.multitouch=false;if(!s.timestamp)s.timestamp=(new Date).getTime();if(b.has("touch"))if(q=="gesturestart"||q=="gesturechange"||q=="gestureend"){s.target=o.target;s.x=0;s.y=0}else{var t=null;if(q=="end"){if(o.changedTouches&&o.changedTouches.length>0)t=o.changedTouches[0]}else if(o.targetTouches&&o.targetTouches.length>0)t=o.targetTouches[0];else if(o.changedTouches&&o.changedTouches.length>0)t=o.changedTouches[0];
if(t!=null){t=f(t);s.x=t.x;s.y=t.y;s.target=t.target;if(o.touches&&o.touches.length>1)s.multitouch=true}}else{t=f(o);s.x=t.x;s.y=t.y;s.target=t.target}o=new b.ux.Event(s);if(!p.isListening("start")||p.tracking==false)p.tracked=true;else if(q=="start")p.tracked=true;if(p.tracked==true){if(q=="end")p.tracked=false;p.notifyEvent(o)}};m.eventCaptures[j]=k.captureFlow;m.domNode.addEventListener(d[j],m.eventHandler,m.eventCaptures[j])}m.addEventCallback(j,l,k.preventDefault)},removeListener:function(i,
j,l){i=h(i);if(i!=null){i=a[i];i.removeEventCallback(j,l);i.isListening(j)||i.domNode.removeEventListener(d[j],i.eventHandler,i.eventCaptures[j])}},getTouchProperties:f};b.ux.touch.Element=function(i){this.uId=b.getUId();this.tracked=false;this.eventHandler=null;this.eventCaptures={};this._els={};b.mixin(this,i);this._validateProperties()};b.ux.touch.Element.prototype={addEventCallback:function(i,j,l){if(!b.isCallback(j))return false;var k=this._els[i];if(k){i=k.callbacks;var m=i.length;for(l=0;l<
m;l++){var n=i[l];if(j.context==n.context&&j.method==n.method)return false}}else{k={preventDefault:l,callbacks:[]};this._els[i]=k}k.callbacks.push(j);return true},removeEventCallback:function(i,j){if(!b.isCallback(j))return false;var l=this._els[i];if(!l)return false;var k=l.callbacks,m,n=k.length;for(m=0;m<n;m++){var o=k[m];if(j.context==o.context&&j.method==o.method){l.callbacks.splice(m,1);break}}return true},isListening:function(i){if((i=this._els[i])&&i.callbacks.length>0)return true;return false},
notifyEvent:function(i){var j=this._els[i.type];if(j){j.preventDefault==true&&i.preventDefault();j=j.callbacks;for(var l=0;l<j.length;l++)b.call(j[l],i)}},_validateProperties:function(){return true}};return b.ux.touch});
define(["../../../_base/_base/js/base","../../../_base/error/js/error"],function(b){var a=b.isSet,c=b.isArray;b.net.Xhr=function(d){this.uId=b.getUId();this.request={xhrObject:null,params:d};this._create()};b.net.Xhr.prototype={sendData:function(d,e,g,f,h,i){var j=this.request,l=j.xhrObject,k=encodeURIComponent;g=g.toUpperCase();if(!(a(e)&&!c(e))){if(l){var m=null;if(a(e)){var n,o=e.length;for(n=0;n<o;n++){var p=e[n],q=p.name;p=p.value;if(g=="GET")d+=n==0&&d.indexOf("?")==-1?"?"+k(q)+"="+k(p):"&"+
k(q)+"="+k(p);else if(n==0)m=k(q)+"="+k(p);else m+="&"+k(q)+"="+k(p)}}try{l.open(g,d,true);l.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=utf-8");if(a(i))if(c(i)){o=i.length;for(n=0;n<o;n++){var s=i[n];l.setRequestHeader(s.name,s.value)}}l.send(m)}catch(t){return false}l.onreadystatechange=function(){if(l.readyState==4){var u=l.status;if(u>=200&&u<400||u==0)a(f)&&b.call(f,j);else a(h)&&b.call(h,j)}}}else return false;return true}},_create:function(){var d=window.XMLHttpRequest;
if(d){var e;try{e=new d}catch(g){e=false}this.request.xhrObject=e}}};b.Xhr=b.net.Xhr;return b.Xhr});
define(["../../../../_base/_base/js/base","../../../../fx/_xy/js/2dfx"],function(b){var a=b.fx.apply,c=null,d=null,e=false;b.ui.xy.layer={visible:false,color:"#000",opacity:0.3,zIndex:998,show:function(){e||this._initDom();c.onclick=function(){var g=b.ui.xy.layer.onclick;b.isSet(g)&&g()};if(!this.visible){a(d,{height:document.body.scrollHeight+"px"});a(c,{display:"block"});this.visible=true}},hide:function(){if(e&&this.visible){a(c,{display:"none"});this.visible=false}},refresh:function(){e&&this.visible&&
a(d,{height:document.body.scrollHeight+"px"})},update:function(){e||this._initDom();a(c,{"z-index":this.zIndex});a(d,{backgroundColor:this.color,opacity:this.opacity})},_initDom:function(){var g=document;c=g.createElement("div");a(c,{position:"absolute",display:"none",top:0,width:"100%","z-index":this.zIndex,"tap-highlight-color":"rgba(0, 0, 0, 0)"});d=g.createElement("div");a(d,{width:"100%",backgroundColor:this.color,opacity:this.opacity});c.appendChild(d);g.body.appendChild(c);e=true}};b.layer=
b.ui.xy.layer;return b.layer});define(["../../../_base/_base/js/base","./feat"],function(b){b=b.has;var a=b.inquireMap;a({"native-geolocation":function(){return!!navigator.geolocation},"native-device-orientation":function(){return"ondeviceorientation"in window},"native-device-motion":function(){return"ondevicemotion"in window}});return b});define(["../../../_base/_base/js/base","./feat"],function(b){b=b.has;var a=b.inquireMap,c=window;a({canvas:function(){return!!c.CanvasRenderingContext2D}});return b});
define(["../../../_base/_base/js/base","./json"],function(b){var a=b.json,c=[];a.stringify=function(g){var f;if(g)f=b.isSet(window.JSON)&&b.isSet(window.JSON.stringify)?window.JSON.stringify(g):d(g);return f};var d=function(g){var f;if(g&&b.isSet(g.toJSON)){f=g.toJSON();if(b.isString(f))f=e(f)}else if(b.isString(g))f=e(g);else if(b.isNumber(g))f=isFinite(g)?g:"null";else if(b.isNull(g))f="null";else if(b.isBoolean(g))f=g?"true":"false";else if(!b.isUndefined(g)&&typeof g!="function"){if(b.isArray(g))a:{f=
[];for(var h=0;h<c.length;h++)if(c[h]==g){g=void 0;break a}c.push(g);var i;for(h=0;h<g.length;h++){i=d(g[h]);f.push(b.isUndefined(i)?"null":i)}if(f.length==0)g="[]";else{g="";for(h=0;h<f.length;h++)g+=f[h]+",";g=g.slice(0,-1);g="["+g+"]"}c.pop();g=g}else a:{i=[];f=[];for(h=0;h<c.length;h++)if(c[h]==g){g=void 0;break a}c.push(g);for(var j in g)i.push(j);for(h=0;h<i.length;h++){j=d(g[i[h]]);if(!b.isUndefined(j)){j=e(i[h])+":"+j;f.push(j)}}if(f.length==0)str="{}";else{g="";for(h=0;h<f.length;h++)g+=
f[h]+",";g=g.slice(0,-1);str="{"+g+"}"}c.pop();g=str}f=g}return f},e=function(g){g=g.replace(/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,function(f){var h={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};h[f]||(h[f]="\\u"+("0000"+(+f.charCodeAt(0)).toString(16)).slice(-4));return h[f]});return g='"'+g+'"'};return a});
define(["../../../_amd/core"],function(b){b.api.GeoLocation=function(){if(b.isUndefined(b.api.GeoLocation.singleton)){this.uId=1;this._initGeolocation();b.api.GeoLocation.singleton=this}else return b.api.GeoLocation.singleton};b.api.GeoLocation.prototype={_NOTIFICATION_INTERVAL_MIN:1E3,_NOTIFICATION_INTERVAL_MAX:36E5,_WATCH_TIMEOUT:6E4,_timestamp:null,_latitude:null,_longitude:null,_accuracy:null,_altitude:null,_altitudeAccuracy:null,_heading:null,_speed:null,_listeners:[],_notifier:null,_watcher:null,
_geolocation:null,_positionChanged:false,_notificationIntervalChanged:false,_accuracyChanged:false,_newListener:false,_initialized:false,_highAccuracy:false,_notificationInterval:36E5,_onlyIfPositionChanged:true,addListener:function(a,c,d,e){if(!b.isCallback(a)){b.log("[GeoLocation] Invalid callback: "+a);return false}if(c<this._NOTIFICATION_INTERVAL_MIN){b.log("[GeoLocation] Notification time interval too small [minimum="+this._NOTIFICATION_INTERVAL_MIN+"]");return false}this._listeners.push(this._createListener(a,
c,d,e));this._newListener=true;this._updateConstraints();this._startWatcher();this._startNotifier()},removeListener:function(a){if(!b.isCallback(a)){b.log("[GeoLocation] Invalid callback: "+a);return false}for(var c=0;c<this._listeners.length;c++)if(this._listeners[c].callback.context==a.context&&this._listeners[c].callback.method==a.method){this._listeners.splice(c,1);break}this._updateConstraints();if(this._listeners.length==0){this._stopNotifier();this._stopWatcher()}},getPosition:function(){if(this._initialized==
false)return null;return{timestamp:this._timestamp,latitude:this._latitude,longitude:this._longitude,accuracy:this._accuracy,altitude:this._altitude,altitudeAccuracy:this._altitudeAccuracy,heading:this._heading,speed:this._speed}},_initGeolocation:function(){this._geolocation=navigator.geolocation;if(!b.isSet(this._geolocation)){this._initGoogleGears();if(!b.isUndefined(window.google))this._geolocation=google.gears.factory.create("beta.geolocation")}b.isSet(this._geolocation)},_startWatcher:function(){if(b.isSet(this._geolocation))if(!b.isSet(this._watcher)||
this._notificationIntervalChanged||this._accuracyChanged){b.isSet(this._watcher)&&this._stopWatcher();var a={maximumAge:this._notificationInterval,timeout:this._WATCH_TIMEOUT,enableHighAccuracy:this._highAccuracy};this._watcher=this._geolocation.watchPosition(b.bind(function(c){this._positionWatcher(this,c)},this),this._handleWatchError,a);this._accuracyChanged=false}},_stopWatcher:function(){if(b.isSet(this._watcher)){this._geolocation.clearWatch(this._watcher);this._watcher=null}},_positionWatcher:function(a,
c){if(a._latitude!=c.coords.latitude||a._longitude!=c.coords.longitude){a._timestamp=c.timestamp;a._latitude=c.coords.latitude;a._longitude=c.coords.longitude;a._accuracy=c.coords.accuracy;a._altitude=c.coords.altitude;a._altitudeAccuracy=c.coords.altitudeAccuracy;a._heading=c.coords.heading;a._speed=c.coords.speed;a._positionChanged=true}this._initialized=true},_handleWatchError:function(a){b.log("[GeoLocation] Error["+a.code+"]: "+a.message)},_startNotifier:function(){if(b.isSet(this._geolocation))if(!b.isSet(this._notifier)||
this._notificationIntervalChanged){b.isSet(this._notifier)&&this._stopNotifier();this._notifier=b.setTimeout(this,"_notifierProcess",this._notificationInterval);this._notificationIntervalChanged=false}},_stopNotifier:function(){if(b.isSet(this._notifier)){clearTimeout(this._notifier);this._notifier=null}},_notifierProcess:function(){if(this._initialized&&(this._newListener||this._onlyIfPositionChanged==false||this._onlyIfPositionChanged&&this._positionChanged)){for(var a=this._getTimeStamp(),c=0;c<
this._listeners.length;c++){var d=this._listeners[c],e=false,g=false;if(d.notificationTimestamp==null){d.notificationTimestamp=this._getTimeStamp();g=true}else if(a-d.notificationTimestamp>d.notificationInterval)e=true;if(e||g){var f=false;if(d.latitude!=this._latitude||d.longitude!=this._longitude){d.timestamp=this._timestamp;d.latitude=this._latitude;d.longitude=this._longitude;d.accuracy=this._accuracy;d.altitude=this._altitude;d.altitudeAccuracy=this._altitudeAccuracy;d.heading=this._heading;
d.speed=this._speed;f=true}if(d.onlyIfPositionChanged&&f==false)e=false}if(e||g){b.call(d.callback,d);d.notificationTimestamp=a}}this._positionChanged=this._newListener=false}this._notifier=b.setTimeout(this,"_notifierProcess",this._notificationInterval)},_createListener:function(a,c,d,e){return{callback:a,notificationInterval:c,onlyIfPositionChanged:d,highAccuracy:e,notificationTimestamp:null,timestamp:null,latitude:null,longitude:null,accuracy:null,altitude:null,altitudeAccuracy:null,heading:null,
speed:null}},_updateConstraints:function(){var a=this._getStringentConstraints();this._onlyIfPositionChanged=a.onlyIfPositionChanged;if(this._highAccuracy!=a.highAccuracy){this._highAccuracy=a.highAccuracy;this._accuracyChanged=true}if(this._notificationInterval!=a.notificationInterval){this._notificationInterval=a.notificationInterval;this._notificationIntervalChanged=true}},_getStringentConstraints:function(){for(var a={notificationInterval:this._NOTIFICATION_INTERVAL_MAX,onlyIfPositionChanged:true,
highAccuracy:false},c=0;c<this._listeners.length;c++){var d=this._listeners[c];if(d.notificationInterval<a.notificationInterval)a.notificationInterval=d.notificationInterval;if(d.onlyIfPositionChanged==false)a.onlyIfPositionChanged=false;if(d.highAccuracy==true)a.highAccuracy=true}return a},_getTimeStamp:function(){return(new Date).getTime()},_initGoogleGears:function(){if(!(window.google&&google.gears)){var a=null;if(typeof GearsFactory!="undefined")a=new GearsFactory;else try{a=new ActiveXObject("Gears.Factory");
a.getBuildInfo().indexOf("ie_mobile")!=-1&&a.privateSetGlobalObject(this)}catch(c){if(!b.isUndefined(navigator.mimeTypes)&&!b.isUndefined(navigator.mimeTypes["application/x-googlegears"])){a=document.createElement("object");a.style.display="none";a.width=0;a.height=0;a.type="application/x-googlegears";document.documentElement.appendChild(a)}}if(a){if(!window.google)window.google={};if(!window.google.gears)window.google.gears={factory:a}}}}};return b.api.GeoLocation});
define(["../../../_amd/core"],function(b){b.api.Storage=function(){if(b.isUndefined(b.api.Storage.singleton)){this.uId=1;this.dbAvailable=false;this._db=null;this._init();b.api.Storage.singleton=this}else return b.api.Storage.singleton};b.api.Storage.prototype={connect:function(a){this._db&&this._db.connect(a)&&this._db.createTables()},insert:function(a,c,d){if(this._db){b.isSet(d)||(d={context:null,method:null});this._db.insert(a,c,d)}},update:function(a,c,d){if(this._db){b.isSet(d)||(d={context:null,
method:null});this._db.update(a,c,d)}},remove:function(a,c,d){if(this._db){b.isSet(d)||(d={context:null,method:null});this._db.remove(a,c,d)}},updateDatabase:function(){},getList:function(a,c){this._db&&this._db.getList(a,c)},getListByField:function(a,c,d,e){this._db&&this._db.getListByField(a,c,d,e)},getById:function(a,c,d){this._db&&this._db.getById(a,c,d)},getTableList:function(a){this._db&&this._db.getTableList(a)},createTables:function(){this._db&&this._db.createTables()},emptyDatabase:function(){this._db&&
this._db.emptyDatabase()},_init:function(){if(window.openDatabase){this._db=new b.api.storage.SafariDb;this.dbAvailable=true}else if(window.google&&google.gears){this._db=new b.api.storage.GearsDb;this.dbAvailable=true}}};b.api.storage=b.api.Storage;b.api.storage.fieldtypes={INTEGER:0,TEXT:1,BLOB:2,BLOB_B64:3,REAL:4};b.api.storage.sqlite={getCreateTablesRequests:function(a){var c=[];for(var d in a.tables){var e=a.tables[d],g="CREATE TABLE IF NOT EXISTS ";g+=d;g+=" (id INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT";
for(var f in e){g+=", "+f+" ";switch(e[f]){case b.api.storage.fieldtypes.INTEGER:g+="INTEGER";break;case b.api.storage.fieldtypes.TEXT:g+="TEXT";break;case b.api.storage.fieldtypes.BLOB:case b.api.storage.fieldtypes.BLOB_B64:g+="BLOB";break;case b.api.storage.fieldtypes.REAL:g+="REAL";break;default:b.log("[sqlite] Unknown field type '"+e[f]+"' for field '"+f+"' in table '"+d+"'");return[]}}g+=");";c.push(g)}return c},getInsertRequest:function(a,c,d){if(!a.tables[c]){b.log("[sqlite] getInsertRequest - Wrong table name : '"+
c+"'");return null}var e={request:"",params:[]};e.request+="INSERT INTO ";e.request+=c;e.request+=" (";var g="",f="";for(var h in d)if(h!="id"&&!b.isFunction(h)&&!b.isUndefined(a.tables[c][h])){var i=d[h];if(a.tables[c][h]==b.api.storage.fieldtypes.BLOB_B64)i=b.api.storage.utils.encode(d[h]);e.request+=f+h;e.params.push(i);g+=f+"?";if(f=="")f=", "}e.request+=") VALUES ("+g+")";return e},getUpdateRequest:function(a,c,d){if(!a.tables[c]){b.log("[sqlite] getUpdateRequest - Wrong table name : '"+c+"'");
return null}var e={request:"",params:[]};e.request+="UPDATE ";e.request+=c;e.request+=" SET ";var g="";for(var f in d)if(f!="id"&&!b.isFunction(f)&&!b.isUndefined(a.tables[c][f])){var h=d[f];if(a.tables[c][f]==b.api.storage.fieldtypes.BLOB_B64)h=b.api.storage.utils.encode(d[f]);e.request+=g+f+"=?";e.params.push(h);if(g=="")g=", "}e.request+=" WHERE id="+d.id;return e},getRemoveRequest:function(a,c,d){if(!a.tables[c]){b.log("[sqlite] getRemoveRequest - Wrong table name : '"+c+"'");return null}a={request:"",
params:[]};a.request+="DELETE FROM ";a.request+=c;a.request+=" WHERE id="+d;return a},getSelectRequest:function(a,c,d,e){if(!a.tables[c]){b.log("[sqlite] getSelectRequest - Wrong table name : '"+c+"'");return null}var g={request:"",params:[]};g.request+="SELECT * FROM ";g.request+=c;if(typeof d!="undefined"&&typeof d!="undefined"&&(typeof a.tables[c][d]!="undefined"||d=="id")){g.request+=" WHERE "+d+"=?";g.params.push(e)}return g},getTableListRequest:function(){var a={request:"",params:[]};a.request+=
"SELECT * FROM sqlite_master";a.request+=' WHERE name NOT LIKE "%WebKitDatabaseInfoTable%"';a.request+=' AND name <> "sqlite_sequence";';return a},getDropTableRequest:function(a,c){if(!a.tables[c]){b.log("[sqlite] getDropTableRequest - Wrong table name : '"+c+"'");return null}var d={request:"",params:[]};d.request+="DROP TABLE "+c;return d},getLastInsertRowIdRequest:function(a,c){if(!a.tables[c]){b.log("[sqlite] getLastInsertRowIdRequest - Wrong table name : '"+c+"'");return null}var d={request:"",
params:[]};d.request+="SELECT DISTINCT last_insert_rowid() FROM "+c;return d}};b.api.storage.utils={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(a){var c="",d,e,g,f,h,i,j=0;for(a=this._utf8_encode(a);j<a.length;){d=a.charCodeAt(j++);e=a.charCodeAt(j++);g=a.charCodeAt(j++);f=d>>2;d=(d&3)<<4|e>>4;h=(e&15)<<2|g>>6;i=g&63;if(isNaN(e))h=i=64;else if(isNaN(g))i=64;c=c+this._keyStr.charAt(f)+this._keyStr.charAt(d)+this._keyStr.charAt(h)+this._keyStr.charAt(i)}return c},
decode:function(a){var c="",d,e,g,f,h,i=0;for(a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");i<a.length;){d=this._keyStr.indexOf(a.charAt(i++));e=this._keyStr.indexOf(a.charAt(i++));f=this._keyStr.indexOf(a.charAt(i++));h=this._keyStr.indexOf(a.charAt(i++));d=d<<2|e>>4;e=(e&15)<<4|f>>2;g=(f&3)<<6|h;c+=String.fromCharCode(d);if(f!=64)c+=String.fromCharCode(e);if(h!=64)c+=String.fromCharCode(g)}return c=this._utf8_decode(c)},_utf8_encode:function(a){a=a.replace(/\r\n/g,"\n");for(var c="",d=0;d<a.length;d++){var e=
a.charCodeAt(d);if(e<128)c+=String.fromCharCode(e);else{if(e>127&&e<2048)c+=String.fromCharCode(e>>6|192);else{c+=String.fromCharCode(e>>12|224);c+=String.fromCharCode(e>>6&63|128)}c+=String.fromCharCode(e&63|128)}}return c},_utf8_decode:function(a){for(var c="",d=0,e=c1=c2=0;d<a.length;){e=a.charCodeAt(d);if(e<128){c+=String.fromCharCode(e);d++}else if(e>191&&e<224){c2=a.charCodeAt(d+1);c+=String.fromCharCode((e&31)<<6|c2&63);d+=2}else{c2=a.charCodeAt(d+1);c3=a.charCodeAt(d+2);c+=String.fromCharCode((e&
15)<<12|(c2&63)<<6|c3&63);d+=3}}return c}};return b.api.Storage});
define(["../../../_amd/core","./storage"],function(b){b.api.storage.SafariDb=function(){this.uId=b.getUId();this._descriptor=this.database=null};b.api.storage.SafariDb.prototype={MAX_SIZE:5242880,VERSION:"1.0",connect:function(a){this._descriptor=a;try{this.database=window.openDatabase(this._descriptor.name,this.VERSION,this._descriptor.name,this.MAX_SIZE)}catch(c){c!=2&&b.log("[SafariDb] Unknown error "+c+".");return false}return true},insert:function(a,c,d){var e=b.api.storage.sqlite.getInsertRequest(this._descriptor,
a,c);if(e){var g=this._insertSuccessHandler,f=this._insertErrorHandler;this.database.transaction(function(h){h.callback=d;h.entry=c;h.executeSql(e.request,e.params,g,f)})}},update:function(a,c,d){var e=b.api.storage.sqlite.getUpdateRequest(this._descriptor,a,c);if(e){var g=this._updateSuccessHandler,f=this._updateErrorHandler;this.database.transaction(function(h){h.callback=d;h.entry=c;h.executeSql(e.request,e.params,g,f)})}},remove:function(a,c,d){var e=b.api.storage.sqlite.getRemoveRequest(this._descriptor,
a,c);if(e){var g=this._removeSuccessHandler,f=this._removeErrorHandler;this.database.transaction(function(h){h.callback=d;h.entryId=c;h.executeSql(e.request,e.params,g,f)})}},getList:function(a,c){var d=b.api.storage.sqlite.getSelectRequest(this._descriptor,a);if(d){var e=this._selectListSuccessHandler,g=this._selectListErrorHandler,f=this;this.database.transaction(function(h){h.callback=c;h.tb_descriptor=f._descriptor.tables[a];h.executeSql(d.request,d.params,e,g)})}},getListByField:function(a,c,
d,e){var g=b.api.storage.sqlite.getSelectRequest(this._descriptor,a,c,d);if(g){var f=this._selectListSuccessHandler,h=this._selectListErrorHandler,i=this;this.database.transaction(function(j){j.callback=e;j.tb_descriptor=i._descriptor.tables[a];j.executeSql(g.request,g.params,f,h)})}},getById:function(a,c,d){var e=b.api.storage.sqlite.getSelectRequest(this._descriptor,a,"id",c);if(e){var g=this._selectByIdSuccessHandler,f=this._selectByIdErrorHandler,h=this;this.database.transaction(function(i){i.callback=
d;i.tb_descriptor=h._descriptor.tables[a];i.executeSql(e.request,e.params,g,f)})}},getTableList:function(a){var c=b.api.storage.sqlite.getTableListRequest();if(c){var d=this._getTableListSuccessHandler,e=this._getTableListErrorHandler;this.database.transaction(function(g){g.callback=a;g.executeSql(c.request,c.params,d,e)})}},createTables:function(){var a=b.api.storage.sqlite.getCreateTablesRequests(this._descriptor),c=this._nullDataHandler,d=this._createTablesErrorHandler;this.database.transaction(function(e){for(var g=
0;g<a.length;g++)e.executeSql(a[g],[],c,d)})},emptyDatabase:function(){this.getTableList({context:this,method:"_dropTables"})},_insertSuccessHandler:function(a,c){if(a.callback.method)if(c.rowsAffected){a.entry.id=c.insertId;b.call(a.callback,a.entry)}else b.call(a.callback)},_insertErrorHandler:function(a,c){b.log('[SafariDb] insertErrorHandler : "'+c.message+'" (Code '+c.code+")")},_updateSuccessHandler:function(a,c){if(a.callback.method)c.rowsAffected?b.call(a.callback,a.entry):b.call(a.callback)},
_updateErrorHandler:function(a,c){b.log('[SafariDb] updateErrorHandler : "'+c.message+'" (Code '+c.code+")")},_removeSuccessHandler:function(a,c){if(a.callback.method)c.rowsAffected?b.call(a.callback,a.entryId):b.call(a.callback)},_removeErrorHandler:function(a,c){b.log('[SafariDb] removeErrorHandler : "'+c.message+'" (Code '+c.code+")")},_selectListSuccessHandler:function(a,c){if(a.callback.method){var d=[];if(c.rows.length)for(var e=0;e<c.rows.length;e++){var g=c.rows.item(e),f={};for(var h in g)f[h]=
a.tb_descriptor[h]==b.api.storage.fieldtypes.BLOB_B64?Base64.decode(g[h]):g[h];d.push(f)}b.call(a.callback,d)}},_selectListErrorHandler:function(a,c){b.log('[SafariDb] selectListErrorHandler : "'+c.message+'" (Code '+c.code+")")},_selectByIdSuccessHandler:function(a,c){if(a.callback.method)if(c.rows.length){var d=c.rows.item(0),e={};for(var g in d)e[g]=a.tb_descriptor[g]==b.api.storage.fieldtypes.BLOB_B64?b.api.storage.utils.decode(d[g]):d[g];b.call(a.callback,e)}else b.call(a.callback)},_selectByIdErrorHandler:function(a,
c){b.log('[SafariDb] selectErrorHandler : "'+c.message+'" (Code '+c.code+")")},_getTableListSuccessHandler:function(a,c){if(a.callback.method){var d=[];if(c.rows.length){for(var e=0;e<c.rows.length;e++){var g=c.rows.item(e);d.push(g.name)}b.call(a.callback,d)}else b.call(a.callback)}},_getTableListErrorHandler:function(a,c){b.log('[SafariDb] getTableListErrorHandler : "'+c.message+'" (Code '+c.code+")")},_nullDataHandler:function(){},_createTablesErrorHandler:function(){},_dropTableErrorHandler:function(a,
c){b.log('[SafariDb] dropTableErrorHandler : "'+c.message+'" (Code '+c.code+")")},_dropTables:function(a){for(var c=this._nullDataHandler,d=this._dropTableErrorHandler,e=[],g=0;g<a.length;g++){var f=b.api.storage.sqlite.getDropTableRequest(this._descriptor,a[g]);if(!f)return;e.push(f.request)}this.database.transaction(function(h){for(var i=0;i<e.length;i++)h.executeSql(e[i],[],c,d)})}};return b.api.storage.SafariDb});
define(["../../../_amd/core","./storage"],function(b){b.api.storage.GearsDb=function(){this.uId=b.getUId();this._descriptor=this.database=null};b.api.storage.GearsDb.prototype={connect:function(a){this._descriptor=a;try{this.database=google.gears.factory.create("beta.database");this.database.open(this._descriptor.name)}catch(c){b.log("[GearsDb] Unknown error "+c+".");return false}return true},insert:function(a,c,d){if(a=b.api.storage.sqlite.getInsertRequest(this._descriptor,a,c)){this.database.execute(a.request,
a.params);if(d.method)if(this.database.rowsAffected){c.id=this.database.lastInsertRowId;b.call(d,c)}else b.call(d)}},update:function(a,c,d){if(a=b.api.storage.sqlite.getUpdateRequest(this._descriptor,a,c)){this.database.execute(a.request,a.params);if(d.method)this.database.rowsAffected?b.call(d,c):b.call(d)}},remove:function(a,c,d){if(a=b.api.storage.sqlite.getRemoveRequest(this._descriptor,a,c)){this.database.execute(a.request,a.params);if(d.method)this.database.rowsAffected?b.call(d,c):b.call(d)}},
getList:function(a,c){var d=b.api.storage.sqlite.getSelectRequest(this._descriptor,a);if(d){d=this.database.execute(d.request,d.params);if(c.method){for(var e=[];d.isValidRow();){for(var g={},f=0;f<d.fieldCount();f++)if(this._descriptor.tables[a][d.fieldName(f)]==b.api.storage.fieldtypes.BLOB_B64)g[d.fieldName(f)]=b.api.storage.utils.decode(d.field(f));else g[d.fieldName(f)]=d.field(f);e.push(g);d.next()}d.close();b.call(c,e)}}},getListByField:function(a,c,d,e){if(c=b.api.storage.sqlite.getSelectRequest(this._descriptor,
a,c,d)){c=this.database.execute(c.request,c.params);if(e.method){for(d=[];c.isValidRow();){for(var g={},f=0;f<c.fieldCount();f++)if(this._descriptor.tables[a][c.fieldName(f)]==b.api.storage.fieldtypes.BLOB_B64)g[c.fieldName(f)]=b.api.storage.utils.decode(c.field(f));else g[c.fieldName(f)]=c.field(f);d.push(g);c.next()}c.close();b.call(e,d)}}},getById:function(a,c,d){if(c=b.api.storage.sqlite.getSelectRequest(this._descriptor,a,"id",c)){c=this.database.execute(c.request,c.params);if(d.method){var e=
{};if(c.isValidRow()){for(var g=0;g<c.fieldCount();g++)if(this._descriptor.tables[a][c.fieldName(g)]==b.api.storage.fieldtypes.BLOB_B64)e[c.fieldName(g)]=b.api.storage.utils.decode(c.field(g));else e[c.fieldName(g)]=c.field(g);c.next()}else e=null;c.close();b.call(d,e)}}},getTableList:function(a){var c=b.api.storage.sqlite.getTableListRequest();if(c){c=this.database.execute(c.request,c.params);if(a.method){for(var d=[];c.isValidRow();){d.push(c.fieldByName("name"));c.next()}c.close();b.call(a,d)}}},
createTables:function(){for(var a=b.api.storage.sqlite.getCreateTablesRequests(this._descriptor),c=0;c<a.length;c++)this.database.execute(a[c])},emptyDatabase:function(){this.getTableList({context:this,method:"_dropTables"})},_dropTables:function(a){for(var c=0;c<a.length;c++){var d=b.api.storage.sqlite.getDropTableRequest(this._descriptor,a[c]);if(!d)return;this.database.execute(d.request)}}};return b.api.storage.GearsDb});
(function(){if(!(window.google&&google.gears)){var b=null;if(typeof GearsFactory!="undefined")b=new GearsFactory;else try{b=new ActiveXObject("Gears.Factory");b.getBuildInfo().indexOf("ie_mobile")!=-1&&b.privateSetGlobalObject(this)}catch(a){if(typeof navigator.mimeTypes!="undefined"&&navigator.mimeTypes["application/x-googlegears"]){b=document.createElement("object");b.style.display="none";b.width=0;b.height=0;b.type="application/x-googlegears";document.documentElement.appendChild(b)}}if(b){window.google||
(google={});if(!google.gears)google.gears={factory:b}}}})();
define(["../../../_amd/core","../../../math/_matrix/js/matrix"],function(b){var a=[];b.fx.set3dTransform=function(e,g,f){if(!c(g))return false;var h;if(f===true)h=b.fx.getTransform(e);f=b.math.createTransformMatrix(h);g=d(g);f.multiply(g);b.fx.setTransform(e,f.getCssMatrix())};b.fx.initComposedTransform=function(e,g){var f;if(g===true)f=b.fx.getTransform(e);f=b.math.createTransformMatrix(f);b.fx.removeComposedTransform(e);a.push({node:e,transforms:[f]})};b.fx.setTransformPart=function(e,g,f){if(!c(f))return false;
if(g<1||g>10)return false;var h,i=a.length;for(h=0;h<i;h++){var j=a[h];if(j.node==e){e=null;if(b.isSet(f))e=d(f);j.transforms[g]=e;break}}};b.fx.applyComposedTransform=function(e,g){var f,h=a.length;for(f=0;f<h;f++){var i=a[f];if(i.node==e){f=i.transforms;h=f[0].clone();var j,l=f.length;for(j=1;j<l;j++){var k=f[j];b.isSet(k)&&h.multiply(k)}if(g===true)i.transforms=[h];b.fx.setTransform(e,h.getCssMatrix());break}}};b.fx.storeComposedTransform=function(e){b.fx.applyComposedTransform(e,true)};b.fx.removeComposedTransform=
function(e){var g,f=a.length;for(g=0;g<f;g++)if(a[g].node==e){a.splice(g,1);break}};var c=function(e){var g=true,f=b.isSet;if(f(e)){var h=["translate","scale","rotate"];if((g=(g=(g=(g=(g=g&&f(e.type))&&h.indexOf(e.type)!=-1)&&f(e.x))&&f(e.y))&&f(e.z))&&e.type=="rotate")g=g&&f(e.angle)}return g},d=function(e){var g=b.math.createTransformMatrix();switch(e.type){case "translate":g.translate(e.x,e.y,e.z);break;case "scale":g.scale(e.x,e.y,e.z);break;case "rotate":g.rotateAxisAngle(e.x,e.y,e.z,e.angle);
break}return g};console.log("3dfx;",b.fx.initComposedTransform);return b.fx});
define(["../../../_amd/core"],function(b){if(typeof b.fx.animation=="undefined")b.fx.animation={};b.fx.animate=function(f,h,i){return a(f,h,i)};b.fx.fadeIn=function(f,h){return c(f,1,h)};b.fx.fadeOut=function(f,h){return c(f,0,h)};b.fx.collapse=function(f,h){var i=h||{},j=g(f,i.rows,i.cols);if(j!=null){f.parentNode.appendChild(j.copy.container.node);b.fx.apply(f,{opacity:0});var l=i.duration||2E3;d(j,{x:i.x-j.source.x,y:i.y-j.source.y});var k=b.math.round(l/3,0);l=(l-k)/j.copy.orderMax;for(var m=
new b.fx.animation.AnimationGroup,n={translate:function(r,v,x){r.node.translate(v,x)}},o=0;o<j.rows;o++)for(var p=0;p<j.cols;p++){var q=j.copy.subparts[o][p],s=Math.max(j.rows,j.cols)-Math.ceil(q.order),t=new b.fx.animation.Animation;t.addStep({property:"transform",value:{context:n,method:"translate",arguments:[i.dx,i.dy]},duration:k,delay:b.math.round(q.order*l,0),func:"cubic-bezier(1.0, 0.0, 1.0, 1.0)"});b.fx.apply(q.node,{zIndex:s});m.addAnimation(q.node,t)}var u=b.isCallback(i.onEnd)?i.onEnd:
null;m.start({onEnd:{context:{onEnd:function(){f.parentNode.removeChild(j.copy.container.node);b.isSet(u)&&b.call(u,{})}},method:"onEnd"}})}};b.fx.split=function(f,h,i){return g(f,h,i)};var a=function(f,h,i){var j=i||{};i=j.start!==false;j=j.onEnd?j.onEnd:null;h=b.isArray(h)?h:[h];for(var l=0;l<h.length;l++){var k=h[l];if(!b.isSet(k.property)||!b.isSet(k.value))return null;if(!b.isSet(k.duration))k.duration=1E3;if(!b.isSet(k.delay))k.delay=0;if(!b.isSet(k.func))k.func="linear"}f=new b.fx.animation.Animation({node:f,
onEnd:j});f.addStep(h);i&&f.start();return f},c=function(f,h,i){i=i||{};return a(f,{property:"opacity",value:h,duration:i.duration,delay:i.delay,func:i.func},i)},d=function(f,h){for(var i=Math.abs(f.cols*f.copy.subW),j=Math.abs(f.rows*f.copy.subH),l=Math.sqrt(i*i+j*j),k=Math.max(f.rows,f.cols),m=Number.MAX_VALUE,n={i:0,j:0},o=0,p=0;p<f.rows;p++)for(var q=0;q<f.cols;q++){var s=f.copy.subparts[p][q];j={x:s.x+s.w/2,y:s.y+s.h/2};i=Math.abs(j.x-h.x);j=Math.abs(j.y-h.y);i=Math.sqrt(i*i+j*j);s.distance=
i;if(i<m){m=i;n={i:p,j:q}}i=s.distance*k/l;s.order=Math.max(i,1);if(o<i)o=i}f.copy.subparts[n.i][n.j].order=0;f.copy.orderMax=o},e=function(f){var h=function(i,j,l){i=(i.ownerDocument.defaultView||window).getComputedStyle(i,null).getPropertyValue(j);return l?parseFloat(i):i};return{x:f.getLeftPosition(),y:f.getTopPosition(),h:h(f,"height",true),w:h(f,"width",true),bh:h(f,"border-top-width",true)+h(f,"border-bottom-width",true),bw:h(f,"border-left-width",true)+h(f,"border-right-width",true),zIndex:h(f,
"z-index")}},g=function(f,h,i){if(!b.isSet(f)||!b.isSet(h)||!b.isSet(i))return null;h={rows:h,cols:i,source:e(f),copy:{subH:null,subW:null,container:{node:null,style:null},subparts:[]}};var j=(h.source.h+h.source.bh)/h.rows,l=(h.source.w+h.source.bw)/h.cols;h.copy.subH=j;h.copy.subW=l;i=b.math.round(j,0);var k=b.math.round(l,0);l=l-k;j=b.math.round((j-i)*h.rows,0);l=b.math.round(l*h.cols,0);h.copy.container.node=document.createElement(f.tagName);b.fx.apply(h.copy.container.node,{position:"absolute",
padding:0,margin:0,border:"none",top:h.source.y+"px",left:h.source.x+"px",height:h.source.h+h.source.bh+"px",width:h.source.w+h.source.bw+"px",background:"none",overflow:"hidden",zIndex:h.source.zIndex});for(var m=0;m<h.rows;m++){h.copy[m]||(h.copy.subparts[m]=[]);for(var n=0;n<h.cols;n++){var o={i:m,j:n},p=n==h.cols-1,q=m==h.rows-1;o.x=n*k;o.y=m*i;o.h=i;o.w=k;if(p)o.w=Math.max(o.w+l,0);if(q)o.h=Math.max(o.h+j,0);o.node=document.createElement(f.tagName);b.fx.apply(o.node,{position:"absolute",padding:0,
margin:0,border:"none",left:o.x+"px",top:o.y+"px",height:o.h+"px",width:o.w+"px",overflow:"hidden"});o.inner=f.cloneNode(true);o.inner.removeAttribute("id");b.fx.apply(o.inner,{position:"static",marginTop:-o.y+"px",marginLeft:-o.x+"px"});o.node.appendChild(o.inner);h.copy.subparts[m].push(o);h.copy.container.node.appendChild(o.node)}}return h};b.fx.animation.Animation=function(f){this.uId=b.getUId();f=f||{};this._steps=[];this._node=f.node;this._onEnd=f.onEnd};b.fx.animation.Animation.prototype={addStep:function(f){f=
b.isArray(f)?f:[f];for(var h=[],i=[],j=[],l=[],k={},m=0;m<f.length;m++){var n=f[m],o=n.property,p=n.value,q=n.duration,s=Math.max(b.isSet(n.delay)?n.delay:1,1);n=b.isSet(n.func)?n.func:"default";o=b.has.prop(o);h.push(o);i.push(q+"ms");j.push(s+"ms");l.push(n);k[o]=p}this._steps.push({propValues:k,transition:{property:h.join(","),duration:i.join(","),delay:j.join(","),func:l.join(",")}})},start:function(f,h){var i=h||{},j=f||this._node;i.onEnd=i.onEnd||this._onEnd;if(b.isSet(j))this._nextStep({uId:b.getUId(),
node:j,currentStep:-1,iterations:i.iterations?i.iterations:1,currentIt:0,onEnd:b.isCallback(i.onEnd)?i.onEnd:null})},getSteps:function(){return this._steps},chain:function(f){if(!(!f instanceof b.fx.animation.Animation)){f=f.getSteps();for(var h=0;h<f.length;h++)this._steps.push(f[h]);return this}},_end:function(f){f.currentIt++;if(f.currentIt<f.iterations){f.currentStep=-1;this._nextStep(f)}else b.isSet(f.onEnd)&&b.call(f.onEnd,{})},_nextStep:function(f){f.currentStep++;if(f.currentStep>=this._steps.length)this._end(f);
else{var h=f.node,i=this._steps[f.currentStep];f.transitionStates={};for(var j in i.propValues)f.transitionStates[j]=false;j=b.bind(this._transitionEnd,this,f);f.trEndHandler=b.fx.onTransitionEnd(h,j,true);f.timer=b.setTimeout(this,"_startStep",0,h,i,f)}},_startStep:function(f,h,i){clearTimeout(i.timer);i=h.transition;b.fx.applyTransition(f,i.property,i.duration,i.delay,i.func);this._setStyle(f,h.propValues)},_transitionEnd:function(f,h){var i=f.transitionStates[h.propertyName]=true;for(var j in f.transitionStates)if(f.transitionStates[j]==
false){i=false;break}if(i){f.node.removeEventListener(b.has.prop("transitionend"),f.trEndHandler,false);this._nextStep(f)}},_setStyle:function(f,h){var i=0,j={};for(var l in h){var k=h[l];if(b.isCallback(k))b.call(k,{node:f});else{j[l]=k;i++}}i>0&&b.fx.apply(f,j)}};b.fx.animation.AnimationGroup=function(){this.uId=b.getUId();this._animations=[];this._onEndCallback=this._countDone=null};b.fx.animation.AnimationGroup.prototype={addAnimation:function(f,h){!h instanceof b.fx.animation.Animation||this._animations.push({node:f,
anim:h})},start:function(f){f=f||{};this._countDone=0;var h=b.isCallback(f.onEnd);this._onEndCallback=h?f.onEnd:null;f={onEnd:h?{context:this,method:"_onAnimEnd"}:null};for(h=0;h<this._animations.length;h++){var i=this._animations[h];i.anim.start(i.node,f)}},clear:function(){this._animations=[]},_onAnimEnd:function(){this._countDone++;this._countDone==this._animations.length&&b.call(this._onEndCallback,{})}};return b.fx});
define(["../../../_amd/core"],function(b){b.math.radToDeg=function(a){return a*180/Math.PI};b.math.degToRad=function(a){return a*Math.PI/180};b.math.getAngle=function(a,c){var d=Math.abs(c);if(d>a*2)d=a*2;var e=2*a*a;d=Math.acos(-((Math.pow(d,2)-(Math.pow(a,2)+Math.pow(a,2)))/e));if(isNaN(d))d=0;return d};b.math.getAngleBetweenVectors=function(a,c){var d=b.math.getScalarVector(a,c),e=b.math.getNormVector(a)*b.math.getNormVector(c);d=Math.acos(d/e);if(isNaN(d))d=0;return d};b.math.normalizeVector=
function(a){var c=[0,0,0,1],d=b.math.getNormVector(a);if(d<=0)return c;c[0]=a[0]/d;c[1]=a[1]/d;c[2]=a[2]/d;return c};b.math.getNormVector=function(a){a=a[0]*a[0]+a[1]*a[1]+a[2]*a[2];return a=Math.sqrt(a)};b.math.getNormalVector=function(a,c){var d=[0,0,0,1];d[0]=a[1]*c[2]-a[2]*c[1];d[1]=a[2]*c[0]-a[0]*c[2];d[2]=a[0]*c[1]-a[1]*c[0];return d};b.math.getScalarVector=function(a,c){var d=0;return d=a[0]*c[0]+a[1]*c[1]+a[2]*c[2]};b.math.getVector=function(a,c){var d=[0,0,0,1];d[0]=c[0]-a[0];d[1]=c[1]-a[1];
d[2]=c[2]-a[2];return d};b.math.multiplyMatrixVector=function(a,c){var d=[0,0,0,1];c[3]||(c[3]=1);d[0]=c[0]*a[0]+c[1]*a[1]+c[2]*a[2]+c[3]*a[3];d[1]=c[0]*a[4]+c[1]*a[5]+c[2]*a[6]+c[3]*a[7];d[2]=c[0]*a[8]+c[1]*a[9]+c[2]*a[10]+c[3]*a[11];d[3]=c[0]*a[12]+c[1]*a[13]+c[2]*a[14]+c[3]*a[15];return d};return b.math});
define(["../../../_amd/core"],function(b){b.math.createTransformMatrix=function(a){var c=new b.math.Matrix({});b.isSet(a)&&c.loadCssTransform(a);return c};b.math.Matrix=function(a){this.uId=b.getUId();this._properties=a;this._values=[];this._cssMatrix=null;this._validateProperties()!==false&&this._initProperties()};b.math.Matrix.prototype={scale:function(a,c,d){this._load(this._cssMatrixToValues(this._cssMatrix.scale(a,c,d)))},translate:function(a,c,d){this._load(this._cssMatrixToValues(this._cssMatrix.translate(a,
c,d)))},rotateAxisAngle:function(a,c,d,e){this._load(this._cssMatrixToValues(this._cssMatrix.rotateAxisAngle(a,c,d,e)))},multiply:function(a){a=a.getCssMatrix();var c=this._cssMatrix;if(b.has("css-matrix-stack-inversed")){var d=a;a=c;c=d}this._load(this._cssMatrixToValues(a.multiply(c)))},clone:function(){return new b.math.Matrix({values:this._values})},loadCssTransform:function(a){if(isString(a)){if(a.indexOf("matrix3d")!=-1){a=a.substring(9,a.length-1).split(", ");for(var c=[],d=0;d<a.length;d++)c[d]=
a[d]*1;this._load(c)}}else try{this._load(this._cssMatrixToValues(a))}catch(e){}},getValues:function(){return this._values},getCssMatrix:function(){return this._cssMatrix},_validateProperties:function(){return true},_initProperties:function(){b.isSet(this._properties.values)?this._load(this._properties.values):this._loadIdentity()},_loadIdentity:function(){this._load([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])},_load:function(a){if(!b.isSet(a)||a.length!=16)return false;this._values=a;this._cssMatrix=this._valuesToCssMatrix(this._values)},
_valuesToCssMatrix:function(a){var c=new WebKitCSSMatrix;c.m11=a[0];c.m12=a[1];c.m13=a[2];c.m14=a[3];c.m21=a[4];c.m22=a[5];c.m23=a[6];c.m24=a[7];c.m31=a[8];c.m32=a[9];c.m33=a[10];c.m34=a[11];c.m41=a[12];c.m42=a[13];c.m43=a[14];c.m44=a[15];return c},_cssMatrixToValues:function(a){var c=[];c[0]=a.m11;c[1]=a.m12;c[2]=a.m13;c[3]=a.m14;c[4]=a.m21;c[5]=a.m22;c[6]=a.m23;c[7]=a.m24;c[8]=a.m31;c[9]=a.m32;c[10]=a.m33;c[11]=a.m34;c[12]=a.m41;c[13]=a.m42;c[14]=a.m43;c[15]=a.m44;return c}};return b.math});
define(["../../../_amd/core"],function(b){b.net.CssLoader=function(){if(b.isUndefined(b.net.CssLoader.singleton)){this.uId=1;this._index=0;this._currentData=null;this._isProcessing=false;this._queue=[];b.net.CssLoader.singleton=this}else return b.net.CssLoader.singleton};b.net.CssLoader.prototype={load:function(a){this._addToQueue(a);this._process()},_addToQueue:function(a){if(b.isString(a))a=[a];b.isArray(a)&&this._queue.push(a)},_process:function(){if(this._isProcessing===false)if(this._queue.length>
0){this._isProcessing=true;this._currentData=this._queue[0];this._queue.splice(0,1);b.publish("/cssloader/events/loadstart",{items:this._currentData});if(this._currentData instanceof Array)for(var a=this._currentData.length,c=0;c<a;c++)(new b.Xhr({caller:this,index:c,src:this._currentData[c]})).sendData(this._currentData[c],null,"GET",{context:this,method:"_onSuccess"},{context:this,method:"_onFailure"})}},_onSuccess:function(a){if(a.xhrObject.responseText!=""){var c=document.createElement("link");
c.type="text/css";c.rel="stylesheet";c.href=a.params.src;document.getElementsByTagName("head")[0].appendChild(c);a.params.caller._processDownloadedStyle(1,a.params.index)}},_onFailure:function(a){a.params.caller._processDownloadedStyle(-1,a.params.index)},_processDownloadedStyle:function(a,c){this._index++;if(this._index==this._currentData.length){b.publish("/cssloader/events/load",{items:this._currentData,currentItem:c,progress:100,success:a});b.publish("/cssloader/events/loadend",{items:this._currentData});
this._cleanup()}else b.publish("/cssloader/events/load",{items:this._currentData,currentItem:c,progress:Math.floor(this._index/this._currentData.length*100),success:a})},_cleanup:function(){this._index=0;this._currentData=null;this._isProcessing=false;this._process()}};return b.net.CssLoader});
define(["../../../_amd/core"],function(b){b.net.ImagesLoader=function(){if(b.isUndefined(b.net.ImagesLoader.singleton)){this.uId=1;this._index=0;this._currentData=null;this._isProcessing=false;this._queue=[];this._images=[];b.net.ImagesLoader.singleton=this}else return b.net.ImagesLoader.singleton};b.net.ImagesLoader.prototype={load:function(a){this._addToQueue(a);this._process()},_addToQueue:function(a){if(b.isString(a))a=[a];b.isArray(a)&&this._queue.push(a)},_process:function(){var a=this;if(this._isProcessing===
false)if(this._queue.length>0){this._isProcessing=true;this._currentData=this._queue[0];this._queue.splice(0,1);b.publish("/imagesloader/events/loadstart",{items:this._currentData});if(this._currentData instanceof Array)for(var c=this._currentData.length,d=0;d<c;d++){var e=new Image;e.src=this._currentData[d];e.value=d;e.onload=function(){this.complete===true?a._processDownloadedImage(1,this.value):a._processDownloadedImage(-1,this.value)};e.onerror=function(){a._processDownloadedImage(-1,this.value)};
this._images.push(e)}}},_processDownloadedImage:function(a,c){this._index++;if(this._index==this._currentData.length){b.publish("/imagesloader/events/load",{items:this._currentData,currentItem:c,progress:100,success:a});b.publish("/imagesloader/events/loadend",{items:this._currentData});this._cleanup()}else b.publish("/imagesloader/events/load",{items:this._currentData,currentItem:c,progress:Math.floor(this._index/this._currentData.length*100),success:a})},_cleanup:function(){this._index=0;this._currentData=
null;this._isProcessing=false;this._images=[];this._process()}};return b.net.ImagesLoader});
define(["../../../_amd/core"],function(b){b.net.JsLoader=function(){if(b.isUndefined(b.net.JsLoader.singleton)){this.uId=1;this._index=0;this._currentData=null;this._isProcessing=false;this._queue=[];b.net.JsLoader.singleton=this}else return b.net.JsLoader.singleton};b.net.JsLoader.prototype={load:function(a){this._addToQueue(a);this._process()},_addToQueue:function(a){if(b.isString(a))a=[a];b.isArray(a)&&this._queue.push(a)},_process:function(){var a=this;if(this._isProcessing===false)if(this._queue.length>
0){this._isProcessing=true;this._currentData=this._queue[0];this._queue.splice(0,1);b.publish("/jsloader/events/loadstart",{items:this._currentData});if(this._currentData instanceof Array)for(var c=this._currentData.length,d=0;d<c;d++){var e=document.createElement("script");e.type="text/javascript";e.src=this._currentData[d];e.value=d;e.onload=function(){a._processDownloadedScript(1,this.value)};e.onerror=function(){a._processDownloadedScript(-1,this.value)};document.getElementsByTagName("head")[0].appendChild(e)}}},
_processDownloadedScript:function(a,c){this._index++;if(this._index==this._currentData.length){b.publish("/jsloader/events/load",{items:this._currentData,currentItem:c,progress:100,success:a});b.publish("/jsloader/events/loadend",{items:this._currentData});this._cleanup()}else b.publish("/jsloader/events/load",{items:this._currentData,currentItem:c,progress:Math.floor(this._index/this._currentData.length*100),success:a})},_cleanup:function(){this._index=0;this._currentData=null;this._isProcessing=
false;this._process()}};return b.net.JsLoader});
define(["../../../_amd/core","../../imagesloader/js/imagesloader","../../cssloader/js/cssloader","../../jsloader/js/jsloader","../../../ui/xy/progressbar/js/progressbar"],function(b){b.net.SmartLoader=function(a){if(b.isUndefined(b.net.SmartLoader.singleton)){this.uId=1;this._imagesQueue=[];this._cssQueue=[];this._jsQueue=[];this._progressBar=null;this._progressBarProperties=a;this._imagesLoader=new b.net.ImagesLoader;this._cssLoader=new b.net.CssLoader;this._jsLoader=new b.net.JsLoader;this._domNode=
this._progressTimer=null;this._subscribeToEvents();this._initDom();b.net.SmartLoader.singleton=this}else return b.net.SmartLoader.singleton};b.net.SmartLoader.prototype={load:function(a){this._addToQueue(a);this._process()},getDomNode:function(){return this._domNode},_addToQueue:function(a){if(b.isSet(a.images)){if(b.isString(a.images))a.images=[a.images];this._imagesQueue=a.images}if(b.isSet(a.scripts)){if(b.isString(a.scripts))a.scripts=[a.scripts];this._jsQueue=a.scripts}if(b.isSet(a.styles)){if(b.isString(a.styles))a.styles=
[a.styles];this._cssQueue=a.styles}},_process:function(){this._progressBar.setValue(0);this._jsQueue.length>0?this._jsLoader.load(this._jsQueue):this._jsLoaded({progress:100})},_jsLoaded:function(a){a=a.progress;if(a==100){this._progressBar.setValue(33);this._cssQueue.length>0?this._cssLoader.load(this._cssQueue):this._cssLoaded({progress:100})}else{a=Math.floor(0.33*a);this._progressBar.setValue(a)}},_cssLoaded:function(a){a=a.progress;if(a==100){this._progressBar.setValue(66);this._imagesQueue.length>
0?this._imagesLoader.load(this._imagesQueue):this._imagesLoaded({progress:100})}else{a=Math.floor(0.33*a);this._progressBar.setValue(33+a)}},_imagesLoaded:function(a){a=a.progress;if(a==100){this._progressBar.setValue(100);this._progressTimer=b.setTimeout(this,"_cleanup",800)}else{a=Math.floor(0.33*a);this._progressBar.setValue(66+a)}},_initDom:function(){this._progressBar=new b.ui.xy.ProgressBar(this._progressBarProperties);this._domNode=document.createElement("div");this._domNode.className="sld_container";
var a=document.createElement("div");a.style.width=this._progressBar._width+"px";a.appendChild(this._progressBar.getDomNode());this._domNode.appendChild(a)},_subscribeToEvents:function(){b.subscribe("/imagesloader/events/load",{context:this,method:"_imagesLoaded"});b.subscribe("/cssloader/events/load",{context:this,method:"_cssLoaded"});b.subscribe("/jsloader/events/load",{context:this,method:"_jsLoaded"})},_cleanup:function(){this._imagesQueue=[];this._cssQueue=[];this._jsQueue=[];clearTimeout(this._progressTimer);
b.publish("/smartloader/events/loadend",null)}};return b.net.SmartLoader});
define(["../../../_amd/core"],function(b){b.net.Tracking=function(a){this.uId=b.getUId();this._properties=a;this._tracks=[];this._statTracker=this._timerFlush=null;this._intervalFlush=0;if(this._validateProperties()!==false){this._initProperties();this._start()}};b.net.Tracking.prototype={flush:function(){for(var a=0;a<this._tracks.length;a++)this._statTracker.send(this._tracks[a]);this.reset()},push:function(a){this._tracks.push(a)},reset:function(){this._tracks=[]},setIntervalFlush:function(a){this._intervalFlush=
a;this._setTimerFlush()},setStatTracker:function(a){this._statTracker=a;this._statTracker.start()},_initProperties:function(){this._statTracker=this._properties.statTracker;this._intervalFlush=this._properties.intervalFlush;if(!b.isSet(this._statTracker))this._statTracker=new b.net.tracking.defaulttracker({cbAfterSend:null})},_setTimerFlush:function(){this._timerFlush&&clearInterval(this._timerFlush);this._timerFlush=null;if(this._intervalFlush>0)this._timerFlush=b.setInterval(this,"flush",this._intervalFlush*
1E3)},_start:function(){this._statTracker.start();this._setTimerFlush()},_validateProperties:function(){return true}};b.net.tracking=b.net.Tracking;b.net.tracking.DefaultTracker=function(a){this.uId=b.getUId();this._properties=a;this._cbAfterSend=null;this._validateProperties()!==false&&this._initProperties()};b.net.tracking.DefaultTracker.prototype={send:function(){(new b.Xhr).sendData("defaulttracker.html",null,"GET",{context:this,method:"_onSuccess"},{context:this,method:"_onFailure"})},start:function(){this._init()},
_init:function(){},_initProperties:function(){this._cbAfterSend=this._properties.cbAfterSend},_validateProperties:function(){return true},_onSuccess:function(a){a.xhrObject.responseText!=""&&this._cbAfterSend&&this._cbAfterSend(a.xhrObject.responseText)},_onfailure:function(){alert("Unable to load the page")}};return b.net.Tracking});
define(["../../../_amd/core"],function(b){b.mm.AudioPlayer=function(a){if(b.isUndefined(b.mm.AudioPlayer.singleton)){this.uId=b.getUId();this.state=this._PAUSE;this.silentSeeking=this.displayCursor=this.displayDuration=this.displayControls=1;this.source={type:undefined,url:undefined,lyrics:undefined};this._lyricsReader=this._currentProgress=this._currentBuffering=this._currentDuration=null;this._fileLoaded=false;this._cursorPosition=this._cursorCurrentX=this._cursorBeginX=0;this._cursorDragging=false;
this._domNode=this._lyricsNode=this._controlsNode=this._durationNode=this._playPauseButton=this._cursor=this._bufferingBar=this._progressBar=this._progressBarNode=this._progressNode=this._playerNode=this._subtitlesNode=this._audioNode=null;this._resetHandler=b.bind(this._reset,this);this._onErrorHandler=b.bind(this._onError,this);this._getLyricsHandler=b.bind(this._getLyrics,this);this._updateDurationHandler=b.bind(this._updateDuration,this);this._updateBufferBarHandler=b.bind(this._updateBufferBar,
this);this._updateProgressBarHandler=b.bind(this._updateProgressBar,this);b.mixin(this,a);if(this._validateProperties()!==false){this._initProperties();this._initDom();this._initAudioNode();b.mm.AudioPlayer.singleton=this}}else return b.mm.AudioPlayer.singleton};b.mm.AudioPlayer.prototype={i18n:{},_PLAY:"play",_PAUSE:"pause",_STREAM:"stream",_FILE:"file",play:function(){if(this.source.url!=""){this.state=this._PLAY;b.removeClass(this._playPauseButton,"w_button_play");b.addClass(this._playPauseButton,
"w_button_pause");if(this._cursor.style.display=="none"&&this.displayCursor==1&&this.source.type!=this._STREAM)this._cursor.style.display="block";this._audioNode.play();b.publish("/audioplayer/events/play",{})}},pause:function(){this.state=this._PAUSE;b.removeClass(this._playPauseButton,"w_button_pause");b.addClass(this._playPauseButton,"w_button_play");this._audioNode.pause();b.publish("/audioplayer/events/pause",{})},forward:function(a){this._setDuration(this._audioNode.currentTime+a);this._updateDuration();
this._updateProgressBar()},changeSource:function(a,c,d){this.source.url=c;this.source.type=a;this.source.lyrics=d;this._reset();this._deleteAudioNode();this._fileLoaded=false;this._durationNode.innerHTML="";this._currentBuffering=0;this._progressBar.style.width="0%";this._bufferingBar.style.width="0%";this._cursor.style.display="none";this._initAudioNode()},getDomNode:function(){return this._domNode},_reset:function(){this._setDuration(0);this.pause();this._cursorPosition=0;this._cursor.translate(this._cursorPosition,
0);this._updateDuration();this._updateProgressBar()},_tooglePlayButton:function(){this.state==this._PAUSE?this.play():this.pause()},_updateBufferBar:function(){if(this.source.type!=this._STREAM)if(!b.isUndefined(this._progressBarNode.clientWidth)&&b.isSet(this._currentDuration)&&!this._fileLoaded){this._currentBuffering=this._audioNode.buffered.end();this._bufferingBar.style.width=this._currentBuffering/this._currentDuration*100+"%";if(this._currentBuffering==this._currentDuration)this._fileLoaded=
true}},_updateProgressBar:function(){this._currentProgress=this._audioNode.currentTime;if(this.source.type!=this._STREAM)if(!b.isUndefined(this._progressBarNode.clientWidth)&&b.isSet(this._currentDuration)){this._progressBar.style.width=this._currentProgress/this._currentDuration*100+"%";if(!this._cursorDragging){this._cursor.translate(this._currentProgress/this._currentDuration*this._progressBarNode.clientWidth,0);this._cursorCurrentX=this._currentProgress/this._currentDuration*this._progressBarNode.clientWidth}}this._updateDisplay()},
_setDuration:function(a){try{this._audioNode.currentTime=a;this._updateDuration()}catch(c){}},_updateDuration:function(){this._currentDuration=this._audioNode.duration},_getLyrics:function(){this._lyricsNode.innerHTML=this._lyricsReader.getLyric(this._audioNode.currentTime)},_updateDisplay:function(){var a=this._getTranslatedDuration(this._currentProgress);if(this.source.type!=this._STREAM){var c=this._getTranslatedDuration(this._currentDuration);this._durationNode.innerHTML=a+"/"+c}else this._durationNode.innerHTML=
a},_getTranslatedDuration:function(a){a=Math.floor(a);if(a>=60){var c=Math.floor(a/60);return c+_("minutes",this)+(a-c*60)+_("seconds",this)}else return a+_("seconds",this)},_convert:function(a,c){return a/c*this._currentDuration},_touchStart:function(a){this._cursorBeginX=a.x;this._cursorDragging=true;this.state==this._PLAY&&this.silentSeeking==1&&this._audioNode.pause()},_touchMove:function(a){if(!isNaN(this._audioNode.duration)){this._cursorPosition=this._cursorCurrentX+a.x-this._cursorBeginX;
if(this._cursorCurrentX+a.x-this._cursorBeginX>=0&&this._cursorCurrentX+a.x-this._cursorBeginX<=this._progressBarNode.clientWidth){this._cursor.translate(this._cursorPosition,0);this._setDuration(this._convert(this._cursorPosition,this._progressBarNode.clientWidth));this._updateProgressBar()}}},_touchEnd:function(){this._cursorCurrentX=this._cursorPosition;this._cursorDragging=false;this.state==this._PLAY&&this.silentSeeking==1&&this._audioNode.play()},_validateProperties:function(){return true},
_initProperties:function(){if(b.isSet(this.source.lyrics))this._lyricsReader=new b.mm.LRCReader({file:this.source.lyrics})},_initAudioNode:function(){this._audioNode=document.createElement("audio");this._audioNode.src=this.source.url;this._audioNode.addEventListener("loadedmetadata",this._updateDurationHandler,false);this._audioNode.addEventListener("canplay",this._updateDurationHandler,false);this._audioNode.addEventListener("progress",this._updateBufferBarHandler,false);this._audioNode.addEventListener("timeupdate",
this._updateProgressBarHandler,false);this._audioNode.addEventListener("ended",this._resetHandler,false);this._audioNode.addEventListener("error",this._onErrorHandler,false);if(b.isSet(this.source.lyrics)){this._audioNode.addEventListener("timeupdate",this._getLyricsHandler,false);this._lyricsReader=new b.mm.LRCReader({file:this.source.lyrics});this._lyricsNode.style.display="block"}else this._lyricsNode.style.display="none";this._audioNode.style.height="0";this._audioNode.style.width="0";document.body.appendChild(this._audioNode)},
_deleteAudioNode:function(){this._audioNode.removeEventListener("loadedmetadata",this._updateDurationHandler,false);this._audioNode.removeEventListener("canplay",this._updateDurationHandler,false);this._audioNode.removeEventListener("progress",this._updateBufferBarHandler,false);this._audioNode.removeEventListener("timeupdate",this._updateProgressBarHandler,false);this._audioNode.removeEventListener("ended",this._resetHandler,false);this._audioNode.removeEventListener("error",this._onErrorHandler,
false);b.isSet(this.source.lyrics)&&this._audioNode.removeEventListener("timeupdate",this._getLyricsHandler,false);document.body.removeChild(this._audioNode);delete this._audioNode},_initDom:function(){this._domNode=document.createElement("div");this._domNode.className="w_box ap_container w_radius w_bg_dark";this._playerNode=document.createElement("div");this._progressNode=document.createElement("div");this._progressBarNode=document.createElement("div");this._progressBar=document.createElement("div");
this._bufferingBar=document.createElement("div");this._cursor=document.createElement("div");this._playerNode.className="w_layout_box";this._progressNode.className="w_box w_expand ap_progress_container";this._progressBarNode.className="w_bar w_radius w_border ap_progress";this._progressBar.className="w_bar_progress w_radius";this._bufferingBar.className="w_bar_progress w_radius ap_buffering_bar";this._cursor.className="w_icon w_button_handle ap_cursor";this._cursor.style.display="none";this._controlsNode=
document.createElement("div");this._durationNode=document.createElement("div");this._playPauseButton=document.createElement("input");this._durationNode.className="ap_duration";this._playPauseButton.className="w_icon w_button_play";this._playPauseButton.type="button";if(b.ua.isIOS){this._playPauseButton.style.position="relative";this._playPauseButton.style.top="-4px"}this._playPauseButton.onclick=b.bind(this._tooglePlayButton,this);this._lyricsNode=document.createElement("div");this._lyricsNode.className=
"ap_lyrics";this._progressBarNode.appendChild(this._progressBar);this._progressBarNode.appendChild(this._bufferingBar);this._progressBarNode.appendChild(this._cursor);this._progressNode.appendChild(this._progressBarNode);this._controlsNode.appendChild(this._playPauseButton);this._playerNode.appendChild(this._controlsNode);this._playerNode.appendChild(this._progressNode);this._playerNode.appendChild(this._durationNode);this._domNode.appendChild(this._playerNode);this._domNode.appendChild(this._lyricsNode);
if(this.displayDuration==0)this._durationNode.style.display="none";if(this.displayControls==0)this._controlsNode.style.display="none";if(this.displayCursor==1){b.ux.touch.addListener(this._cursor,"start",{context:this,method:"_touchStart",arguments:null},{preventDefault:true});b.ux.touch.addListener(this._progressBarNode,"move",{context:this,method:"_touchMove",arguments:null},{preventDefault:true});b.ux.touch.addListener(this._cursor,"end",{context:this,method:"_touchEnd",arguments:null},{preventDefault:true})}window.addEventListener("orientationchange",
b.bind(this._updateProgressBar,this),false)},_onError:function(){}};b.mm.LRCReader=function(a){this.uId=b.getUId();this.offset=this.creator=this.version=this.editor=this.album=this.artist=this.title=null;this.lyricsTab=[];this._isReady=false;this._properties=a;this._file=null;this._validateProperties()!==false&&this._load()};b.mm.LRCReader.prototype={getLyric:function(a){a=b.math.round(a,1);a=this.lyricsTab['"'+a+'"'];return b.isUndefined(a)?"":a},_checkTitle:function(a){a=a.match(/^(\[ti:)(.*)(\])/i);
return a!=null?a[2]:a},_checkArtist:function(a){a=a.match(/^(\[ar:)(.*)(\])/i);return a!=null?a[2]:a},_checkAlbum:function(a){a=a.match(/^(\[al:)(.*)(\])/i);return a!=null?a[2]:a},_checkEditor:function(a){a=a.match(/^(\[re:)(.*)(\])/i);return a!=null?a[2]:a},_checkVersion:function(a){a=a.match(/^(\[ve:)(.*)(\])/i);return a!=null?a[2]:a},_checkCreator:function(a){a=a.match(/^(\[by:)(.*)(\])/i);return a!=null?a[2]:a},_checkOffset:function(a){a=a.match(/^(\[offset:)(.*)(\])/i);return a!=null?a[2]:a},
_checkLyrics:function(a){a=a.match(/^(\[)(\d*)(:)(.*)(\])(.*)/i);if(a!=null){var c=parseInt(a[2])*60+parseFloat(a[4]);if(this.offset!=null)c-=parseInt(this.offset)/1E3;return{time:c,lyric:a[6]}}else return a},_treatLyrics:function(){for(var a=[],c=this.lyricsTab.length,d=0;d<c-1;d++){var e=this.lyricsTab[d].time,g=this.lyricsTab[d].lyric,f=this.lyricsTab[d+1].time;e=b.math.round(e,1);for(f=b.math.round(f,1);e<f;){a['"'+b.math.round(e,1)+'"']=g;e+=0.1}}this.lyricsTab=a},_load:function(){(new b.Xhr).sendData(this._file,
null,"GET",{context:this,method:"_onLoadSuccess"},{context:this,method:"_onLoadFailure"})},_onLoadSuccess:function(a){if(a.xhrObject.responseText!=""){a=a.xhrObject.responseText.split(/\r\n|\r|\n/);for(var c=a.length,d=0;d<c;d++){var e=a[d];if(this.title==null)this.title=this._checkTitle(e);if(this.artist==null)this.artist=this._checkArtist(e);if(this.album==null)this.album=this._checkAlbum(e);if(this.editor==null)this.editor=this._checkEditor(e);if(this.version==null)this.version=this._checkVersion(e);
if(this.creator==null)this.creator=this._checkCreator(e);if(this.offset==null)this.offset=this._checkOffset(e);e=this._checkLyrics(e);e!=null&&this.lyricsTab.push(e)}this._treatLyrics();this._isReady=true}},_onLoadFailure:function(){},_validateProperties:function(){return true}};return b.mm.AudioPlayer});define(["../../../../_amd/core","../../js/audioplayer"],function(b){b=b.mm.AudioPlayer;b.prototype.i18n.en_EN={minutes:":",seconds:""};return b});
define(["../../../_amd/core"],function(b){b.mm.VideoPlayer=function(a){this.uId=b.getUId();this.state=this._PAUSE;this.silentSeeking=this.displayCursor=this.displayDuration=this.displayControls=this.customControls=1;this.source={type:undefined,url:undefined,height:undefined,width:undefined,poster:undefined};this._checkBufferTimeout=this._currentProgress=this._currentBuffering=this._currentDuration=null;this._fileLoaded=false;this._cursorPosition=this._cursorCurrentX=this._cursorBeginX=0;this._cursorDragging=
false;this._domNode=this._controlsNode=this._durationNode=this._fullScreenButton=this._playPauseButton=this._cursor=this._bufferingBar=this._progressBar=this._progressBarNode=this._progressNode=this._videoContainerNode=this._videoNode=this._playerNode=null;this._resetHandler=b.bind(this._reset,this);this._onErrorHandler=b.bind(this._onError,this);this._updateDurationHandler=b.bind(this._updateDuration,this);this._updateBufferBarHandler=b.bind(this._updateBufferBar,this);this._updateProgressBarHandler=
b.bind(this._updateProgressBar,this);b.mixin(this,a);if(this._validateProperties()!==false){this._initDom();this._initVideoNode();this._initListeners()}};b.mm.VideoPlayer.prototype={i18n:{},_PLAY:"play",_PAUSE:"pause",_STREAM:"stream",_FILE:"file",play:function(){if(this.source.url!=""){this.state=this._PLAY;b.removeClass(this._playPauseButton,"w_button_play");b.addClass(this._playPauseButton,"w_button_pause");if(this._cursor.style.display=="none"&&this.displayCursor==1&&this.source.type!=this._STREAM)this._cursor.style.display=
"block";this._videoNode.play();b.publish("/videoplayer/events/play",{id:this.uId})}},pause:function(){this.state=this._PAUSE;if(this.customControls==1){b.removeClass(this._playPauseButton,"w_button_pause");b.addClass(this._playPauseButton,"w_button_play")}this._videoNode.pause();b.publish("/videoplayer/events/pause",{id:this.uId})},forward:function(a){this._setDuration(this._videoNode.currentTime+a);this._updateDuration();this._updateProgressBar()},changeSource:function(a,c,d,e,g){this.source.url=
c;this.source.type=a;this.source.height=null;this.source.width=null;this.source.poster=null;if(b.isSet(d))this.source.height=d;if(b.isSet(e))this.source.width=e;if(b.isSet(g))this.source.poster=g;this._reset();this._deleteVideoNode();this._fileLoaded=false;this._currentBuffering=0;if(this.customControls==1){this._durationNode.innerHTML="";this._progressBar.style.width="0%";this._bufferingBar.style.width="0%";this._cursor.style.display="none"}this._initVideoNode()},getDomNode:function(){return this._domNode},
_reset:function(){this._setDuration(0);this.pause();this._cursorPosition=0;this.customControls==1&&this._cursor.translate(this._cursorPosition,0);this._updateDuration();this._updateProgressBar()},_tooglePlayButton:function(){this.state==this._PAUSE?this.play():this.pause()},_enterFullScreen:function(){try{this._videoNode.webkitEnterFullScreen()}catch(a){}},_cancel:function(a){a.id!=this.uId&&this.pause()},_updateBufferBar:function(){b.isSet(this._checkBufferTimeout)&&clearTimeout(this._checkBufferTimeout);
if(this.source.type!=this._STREAM)if(!b.isUndefined(this._progressBarNode.clientWidth)&&b.isSet(this._currentDuration)&&!this._fileLoaded){try{this._currentBuffering=this._videoNode.buffered.end()}catch(a){}this._bufferingBar.style.width=this._currentBuffering/this._currentDuration*100+"%";if(this._currentBuffering==this._currentDuration)this._fileLoaded=true;else this._checkBufferTimeout=b.setTimeout(this,"_updateBufferBar",200)}else this._checkBufferTimeout=b.setTimeout(this,"_updateBufferBar",
200)},_updateProgressBar:function(){if(this.customControls==1){this._currentProgress=this._videoNode.currentTime;if(this.source.type!=this._STREAM)if(!b.isUndefined(this._progressBarNode.clientWidth)&&b.isSet(this._currentDuration)){this._progressBar.style.width=this._currentProgress/this._currentDuration*100+"%";if(!this._cursorDragging){this._cursor.translate(this._currentProgress/this._currentDuration*this._progressBarNode.clientWidth,0);this._cursorCurrentX=this._currentProgress/this._currentDuration*
this._progressBarNode.clientWidth}}this._updateDisplay()}},_setDuration:function(a){try{this._videoNode.currentTime=a;this._updateDuration()}catch(c){}},_updateDuration:function(){this._currentDuration=this._videoNode.duration},_updateDisplay:function(){var a=this._getTranslatedDuration(this._currentProgress);if(this.source.type!=this._STREAM){var c=this._getTranslatedDuration(this._currentDuration);this._durationNode.innerHTML=a+" / "+c}else this._durationNode.innerHTML=a},_getTranslatedDuration:function(a){a=
Math.floor(a);if(a>=60){var c=Math.floor(a/60);return c+_("minutes",this)+(a-c*60)+_("seconds",this)}else return a+_("seconds",this)},_convert:function(a,c){return a/c*this._currentDuration},_touchStart:function(a){this._cursorBeginX=a.x;this._cursorDragging=true;this.state==this._PLAY&&this.silentSeeking==1&&this._videoNode.pause()},_touchMove:function(a){if(!isNaN(this._videoNode.duration)){this._cursorPosition=this._cursorCurrentX+a.x-this._cursorBeginX;if(this._cursorCurrentX+a.x-this._cursorBeginX>=
0&&this._cursorCurrentX+a.x-this._cursorBeginX<=this._progressBarNode.clientWidth){this._cursor.translate(this._cursorPosition,0);this._setDuration(this._convert(this._cursorPosition,this._progressBarNode.clientWidth));this._updateProgressBar()}}},_touchEnd:function(){this._cursorCurrentX=this._cursorPosition;this._cursorDragging=false;this.state==this._PLAY&&this.silentSeeking==1&&this._videoNode.play()},_validateProperties:function(){return true},_initListeners:function(){b.subscribe("/videoplayer/events/play",
{method:"_cancel",context:this})},_initVideoNode:function(){this._videoNode=document.createElement("video");this._videoNode.src=this.source.url;this._videoNode.className="vp_video";if(b.isSet(this.source.height))this._videoNode.style.height=this.source.height+"px";if(b.isSet(this.source.width))this._videoNode.style.width=this.source.width+"px";if(b.isSet(this.source.poster))this._videoNode.poster=this.source.poster;if(this.customControls==0)this._videoNode.controls=true;else{this._videoNode.addEventListener("loadedmetadata",
this._updateDurationHandler,false);this._videoNode.addEventListener("canplay",this._updateDurationHandler,false);this._videoNode.addEventListener("durationchange",this._updateBufferBarHandler,false);this._videoNode.addEventListener("timeupdate",this._updateProgressBarHandler,false);this._videoNode.addEventListener("ended",this._resetHandler,false);this._videoNode.addEventListener("error",this._onErrorHandler,false)}this._videoContainerNode.appendChild(this._videoNode)},_deleteVideoNode:function(){if(this.customControls==
1){this._videoNode.removeEventListener("loadedmetadata",this._updateDurationHandler,false);this._videoNode.removeEventListener("canplay",this._updateDurationHandler,false);this._videoNode.removeEventListener("durationchange",this._updateBufferBarHandler,false);this._videoNode.removeEventListener("timeupdate",this._updateProgressBarHandler,false);this._videoNode.removeEventListener("ended",this._resetHandler,false);this._videoNode.removeEventListener("error",this._onErrorHandler,false)}this._videoContainerNode.removeChild(this._videoNode);
delete this._videoNode},_initDom:function(){this._domNode=document.createElement("div");this._domNode.className="w_box vp_container w_radius w_bg_dark";this._videoContainerNode=document.createElement("div");this._videoContainerNode.className="vp_video_container";if(this.customControls==1){this._playerNode=document.createElement("div");this._progressNode=document.createElement("div");this._progressBarNode=document.createElement("div");this._progressBar=document.createElement("div");this._bufferingBar=
document.createElement("div");this._cursor=document.createElement("div");this._playerNode.className="w_layout_box vp_player";this._progressNode.className="w_box w_expand vp_progress_container";this._progressBarNode.className="w_bar w_radius w_border vp_progress";this._progressBar.className="w_bar_progress w_radius";this._bufferingBar.className="w_bar_progress w_radius vp_buffering_bar";this._cursor.className="w_icon w_button_handle vp_cursor";this._cursor.style.display="none";this._controlsNode=document.createElement("div");
this._extendedControlsNode=document.createElement("div");this._durationNode=document.createElement("div");this._playPauseButton=document.createElement("input");if(b.ua.isIOS){this._playPauseButton.style.position="relative";this._playPauseButton.style.top="-4px"}this._fullScreenButton=document.createElement("input");if(b.ua.isIOS){this._fullScreenButton.style.position="relative";this._fullScreenButton.style.top="-4px"}this._durationNode.className="vp_duration";this._playPauseButton.className="w_icon w_button_play";
this._fullScreenButton.className="w_icon w_button_zoom";this._playPauseButton.type="button";this._fullScreenButton.type="button";this._playPauseButton.onclick=b.bind(this._tooglePlayButton,this);this._fullScreenButton.onclick=b.bind(this._enterFullScreen,this);this._progressBarNode.appendChild(this._progressBar);this._progressBarNode.appendChild(this._bufferingBar);this._progressBarNode.appendChild(this._cursor);this._progressNode.appendChild(this._progressBarNode);this._controlsNode.appendChild(this._playPauseButton);
this._extendedControlsNode.appendChild(this._fullScreenButton);this._playerNode.appendChild(this._controlsNode);this._playerNode.appendChild(this._progressNode);this._playerNode.appendChild(this._durationNode);this._playerNode.appendChild(this._extendedControlsNode);this._domNode.appendChild(this._videoContainerNode);this._domNode.appendChild(this._playerNode);if(this.displayDuration==0)this._durationNode.style.display="none";if(this.displayControls==0)this._controlsNode.style.display="none";if(this.displayCursor==
1){b.ux.touch.addListener(this._cursor,"start",{context:this,method:"_touchStart",arguments:null},{preventDefault:true});b.ux.touch.addListener(this._cursor,"move",{context:this,method:"_touchMove",arguments:null},{preventDefault:true});b.ux.touch.addListener(this._cursor,"end",{context:this,method:"_touchEnd",arguments:null},{preventDefault:true})}window.addEventListener("orientationchange",b.bind(this._updateProgressBar,this),false)}else this._domNode.appendChild(this._videoContainerNode)},_onError:function(){}};
return b.mm.VideoPlayer});define(["../../../../_amd/core","../../js/videoplayer"],function(b){b=b.mm.VideoPlayer;b.prototype.i18n.en_EN={minutes:":",seconds:""};return b});
define(["../../../_amd/core","../../../math/_geometric/js/geometric","../../../ux/movementtracker/js/movementtracker"],function(b){b.mm.MediaWheel=function(f){this.uId=b.getUId();b.mixin(this,f);if(this._validateProperties()!==false){this._initProperties();this._initDom();this._initListeners()}};b.mm.MediaWheel.prototype={getDomNode:function(){return this._domNode},setDuration:function(f){this._duration=f;this._draw()},setTime:function(f){this._time=f;this._cursorAngle=this._timeToAngle(f);this._draw()},
setBufferedTime:function(f){this._bufferedTime=f;this._draw()},_draw:function(){var f=this;f._ctx.clearRect(0,0,f.width,f.height);var h=Math.max(f.startAngle,f._timeToAngle(f._time)),i=Math.max(h,f._timeToAngle(f._bufferedTime)),j=function(l,k,m){var n=f._ctx,o=f._cx,p=f._cy,q=f._r1,s=f._r2,t=k-l;if(t!=0){k=a(t*100/360,0);k=k=Math.max(k,1);t=t/k;var u=l;for(l=0;l<k;l++){var r=n,v=o,x=p,B=q,F=s,w=u,y=u+t,E=m;r.beginPath();var z=e(v,x,B,w);r.moveTo(z.x,z.y);z=void 0;z=y>w?false:true;r.arc(v,x,B,c(w-
90),c(y-90),z);z=e(v,x,F,y);r.lineTo(z.x,z.y);z=void 0;z=w>y?false:true;r.arc(v,x,F,c(y-90),c(w-90),z);z=e(v,x,B,w);r.lineTo(z.x,z.y);r.closePath();B=e(v,x,B,w+Math.abs(y-w)/2);v=e(v,x,F,w+Math.abs(y-w)/2);v=r.createLinearGradient(B.x,B.y,v.x,v.y);x=void 0;F=E.length;for(x=0;x<F;x++){w=E[x];v.addColorStop(w.pos,w.color)}r.fillStyle=v;r.fill();r.lineWidth=1;r.strokeStyle=v;r.stroke();u+=t}}};j(f.startAngle,h,f.readGradientColors);j(h,i,f.bgGradientColors);j(i,f.endAngle,f.unbufferedGradientColors);
this._drawCursor()},_drawCursor:function(){var f=this._getCursorRect();this._ctxCursor.clearRect(0,0,this.width,this.height);var h=this._ctxCursor,i=this._cx,j=this._cy,l=f.h,k=f.w,m=f.x,n=f.y,o=this._cursorAngle;f=this.cursorRectColor;var p=this.cursorTriangleColor;h.save();h.translate(i,j);h.rotate(c(o));h.translate(m,n);i=k/2;l=l/2;h.save();h.beginPath();h.moveTo(i,l);h.lineTo(i,-l);h.lineTo(-i,-l);h.lineTo(-i,l);h.lineTo(i,l);h.closePath();h.fillStyle=f[0];h.fill();h.lineWidth=1;h.strokeStyle=
f[1];h.stroke();h.restore();h.save();h.beginPath();h.moveTo(i*4,0);h.lineTo(-i*2,l/2);h.lineTo(-i*2,-l/2);h.lineTo(i*4,0);h.closePath();h.fillStyle=p[0];h.fill();h.lineWidth=1;h.strokeStyle=p[1];h.stroke();h.restore();h.restore()},_getCursorRect:function(){var f=this._r2-this._r1;f=f+0.4*f;return{x:0,y:-(this._r1+this._r2)/2,h:f,w:f/6}},_mvtStart:function(f){if(f.publisher.uId==this._movementtracker.uId){f=f.uxEvent;this._track=this._drag=false;if(this._duration!=0){f=g(this._canvasCursorNode,f.x,
f.y,this._cx,this._cy);var h=this._getCursorRect(),i=h.h/2,j=h.w/2,l={coords:f};if(f.rho>=-h.y-i&&f.rho<=-h.y+i){l.onWheel=true;if(f.theta>=this._cursorAngle-j&&f.theta<=this._cursorAngle+j){this._track=true;l.onCursor=true}}this._startInfo=l}}},_mvtMove:function(f){if(f.publisher.uId==this._movementtracker.uId){this._drag=true;if(this._track){f=f.uxEvent;f=this._angleToTime(this._adjustAngle(g(this._canvasCursorNode,f.x,f.y,this._cx,this._cy).theta));this.setTime(f);this._notifyTimeUpdate(f)}}},
_mvtEnd:function(f){if(f.publisher.uId==this._movementtracker.uId)if(this._duration!=0)if(!this._drag)if(this._startInfo.onWheel){f=this._angleToTime(this._adjustAngle(this._startInfo.coords.theta));this.setTime(f);this._notifyTimeUpdate(f)}},_notifyTimeUpdate:function(f){b.publish("/mediawheel/events/timeupdate",{publisher:this,time:f})},_timeToAngle:function(f){if(this._duration==0)return 0;return f*this._at/this._duration+this.startAngle},_angleToTime:function(f){if(this._duration==0)return 0;
return(f-this.startAngle)*this._duration/this._at},_adjustAngle:function(f){f=f;if(f<this.startAngle)f=this.startAngle;else if(f>this.endAngle)f=this.endAngle;return f},_initDom:function(){var f=this._domNode=document.createElement("div"),h=this._canvasNode=document.createElement("canvas"),i=this._canvasCursorNode=document.createElement("canvas");b.addClass(f,"mw_container");this._ctx=h.getContext("2d");this._ctxCursor=i.getContext("2d");f.appendChild(h);f.appendChild(i);h.translate(0,0);i.translate(0,
0);h.width=this.width;h.height=this.height;i.width=this.width;i.height=this.height;b.fx.apply(f,{width:this.width+"px",height:this.height+"px"});this._draw()},_initListeners:function(){if(this.canChangeTime){this._movementtracker=new b.ux.MovementTracker({target:this._canvasCursorNode});b.subscribe("/movementtracker/events/mvtbegin",{context:this,method:"_mvtStart"});b.subscribe("/movementtracker/events/mvtchanged",{context:this,method:"_mvtMove"});b.subscribe("/movementtracker/events/mvtstored",
{context:this,method:"_mvtEnd"})}},_initProperties:function(){this.height=this.height||300;this.width=this.width||300;var f=Math.min(this.height,this.width);this.radius=this.radius||f/2-f/10;this.thickness=this.thickness||Math.max(f/20,25);this.startAngle=this.startAngle||10;this.endAngle=this.endAngle||350;this.cursorRectColor=this.cursorRectColor||["rgba(255, 255, 255, 0.5)","rgba(255, 255, 255, 0.7)"];this.cursorTriangleColor=this.cursorTriangleColor||["rgba(255, 255, 255, 1.0)","rgba(0, 0, 0, 0.6)"];
f=function(h,i,j){return[{pos:0,color:h},{pos:0.75,color:i},{pos:1,color:j}]};this.bgGradientColors=this.bgGradientColors||f("#000","#cacaca","#000");this.unbufferedGradientColors=this.unbufferedGradientColors||f("#000","#a1a1a1","#000");this.readGradientColors=this.readGradientColors||f("#111","#fff","#111");this.canChangeTime=this.canChangeTime!==false;this._cx=this.width/2;this._cy=this.height/2;this._r1=this.radius;this._r2=this._r1+this.thickness;this._at=this.endAngle-this.startAngle;this._time=
this._bufferedTime=this._duration=0;this._cursorAngle=this.startAngle},_validateProperties:function(){return true}};var a=b.math.round,c=b.math.degToRad,d=b.math.radToDeg,e=function(f,h,i,j){return{x:f+i*Math.cos(c(j-90)),y:h+i*Math.sin(c(j-90))}},g=function(f,h,i,j,l){for(var k={x:0,y:0},m=f;m&&m!=document.body;){var n=b.fx.getTransformPosition(m);k.x+=n.x;k.y+=n.y;m=m.parentNode}f={x:f.getLeftPosition()+k.x,y:f.getTopPosition()+k.y};h=h-f.x-j;l=-(i-f.y-l);i=Math.sqrt(h*h+l*l);l=d(Math.PI/2-Math.atan2(l,
h));if(l<0)l+=360;return{rho:i,theta:l}};return b.mm.MediaWheel});
define(["../../../_amd/core"],function(b){b.ux.history={_historyTimer:null,_historyQueue:[],_historyIndex:0,_historyCheckInterval:100,start:function(){window.location.hash="";this._historyQueue.push({hash:"",id:"main",params:""});if("onhashchange"in window)window.addEventListener("hashchange",b.bind(function(){this._check()},this),true);else this._historyTimer=b.setInterval(this,"_check",this._historyCheckInterval)},stop:function(){"onhashchange"in window?window.removeEventListener("hashchange",b.bind(function(){this._check()},
this),true):clearInterval(this._historyTimer)},push:function(a,c,d){b.isSet(d)||(d=b.getUId());window.location.hash=d;this._historyQueue.splice(this._historyIndex+1,this._historyQueue.length-this._historyIndex-1);this._historyQueue.push({hash:d,id:a,params:c});this._historyIndex=this._historyQueue.length-1},pop:function(a){for(var c=this._historyIndex-1;c>=0;c--)if(this._historyQueue[c]&&this._historyQueue[c].id==a){window.history.back(c-this._historyIndex);this._historyIndex=c;return}window.history.back(-this._historyIndex);
this._historyIndex=0},updateCheckInterval:function(a){if(!("onhashchange"in window)){this.stop();this._historyCheckInterval=a;this._historyTimer=b.setInterval(this,"_check",this._historyCheckInterval)}},_check:function(){if(this._historyQueue.length>0)for(var a=window.location.hash.substring(1,window.location.hash.length),c=this._historyQueue.length,d=0;d<c;d++)if(a==this._historyQueue[d].hash&&d!=this._historyIndex){if(d<this._historyIndex)for(a=this._historyIndex;a>d;a--)b.publish("/history/events/back",
{id:this._historyQueue[a-1].id,params:this._historyQueue[a-1].params});else if(d>this._historyIndex)for(a=this._historyIndex;a<d;a++)b.publish("/history/events/forward",{id:this._historyQueue[a+1].id,params:this._historyQueue[a+1].params});this._historyIndex=d;break}}};b.ux.history.start();return b.ux.history});
define(["../../../_amd/core"],function(b){b.ux.Dnd=function(a){this.uId=b.getUId();this.zone=null;this._targets=[];this._sources=[];this._multitouch=0;this._currentAvatar=this._currentTarget=this._currentSource=this._endEvent=this._startEvent=null;this._lastY=this._lastX=0;b.mixin(this,a);this._initListeners()};b.ux.Dnd.prototype={addSource:function(a){this._sources[this._sources.length]={source:a}},addTarget:function(a){a.dnd=this;var c=$(a.id).offsetLeft,d=$(a.id).offsetTop,e=c+$(a.id).clientWidth,
g=d+$(a.id).clientHeight;this._targets[this._targets.length]={target:a,X1:c,Y1:d,X2:e,Y2:g}},updateTargets:function(){for(var a=this._targets.length,c=0;c<a;c++)if($(this._targets[c].target.id)){var d=$(this._targets[c].target.id),e=d.offsetLeft,g=d.offsetTop,f=e+d.clientWidth;d=g+d.clientHeight;this._targets[c].X1=e;this._targets[c].X2=f;this._targets[c].Y1=g;this._targets[c].Y2=d}},clean:function(){this._targets=[];this._sources=[]},_startDrag:function(a){if(a.multitouch)this._multitouch++;else{this._startEvent=
a;if(a.target.className&&a.target.className.search(/dnd_movable/i)>-1){this._currentSource=this._getSource(a.target.id);if(this._currentSource!==null){this._currentSource.activate();this._currentAvatar={target:this._currentSource.getAvatar(),beginX:a.x,beginY:a.y,pozX:a.target.pozXinit,pozY:a.target.pozYinit};document.body.appendChild(this._currentAvatar.target)}}}},_drag:function(a){if(!(this._multitouch>0))if(this._currentAvatar!==null){this._currentAvatar.target.pozXinit=this._currentAvatar.pozX+
a.x-this._currentAvatar.beginX;this._currentAvatar.target.pozYinit=this._currentAvatar.pozY+a.y-this._currentAvatar.beginY;this._currentAvatar.target.translate(this._currentAvatar.target.pozXinit,this._currentAvatar.target.pozYinit);this._currentTarget=this._getTarget(a.x,a.y);if(this._currentTarget!==null)for(var c=0;c<this._currentSource._events.length;c++)this._currentSource._events[c].event==this._currentTarget._event&&this._currentTarget.onSourceOver(this._currentSource);this.lastX=a.x;this.lastY=
a.y;if(a.y>=window.innerHeight+window.scrollY-60)scrollTo(window.scrollX,window.scrollY+5);else a.y<=window.scrollY+60&&window.scrollY>0&&scrollTo(window.scrollX,window.scrollY-5);if(a.x>=window.innerWidth+window.scrollX-40)scrollTo(window.scrollX+5,window.scrollY);else a.x<=window.scrollX+40&&window.scrollX>0&&scrollTo(window.scrollX-5,window.scrollY)}},_endDrag:function(a){if(this._multitouch>0)this._multitouch--;else{this._endEvent=a;this._endEvent.timestamp-this._startEvent.timestamp<250&&Math.abs(this._endEvent.x-
this._startEvent.x)<20&&this._endEvent.dispatch(this._endEvent.target,"click");if(this._currentAvatar!==null){this._currentTarget=this._getTarget(this.lastX,this.lastY);this._currentTarget!==null&&this._currentTarget._onDrop(this._currentSource);document.body.removeChild(this._currentAvatar.target);this._currentSource.deactivate();this._currentAvatar=this._currentTarget=this._currentSource=null;this.lastY=this.lastX=0;this.updateTargets()}}},_getSource:function(a){if(a!==null&&a!="")for(var c=0;c<
this._sources.length;c++)if(this._sources[c].source.id==a)return this._sources[c].source;return null},_getTarget:function(a,c){for(var d=null,e=this._targets.length,g=0;g<e;g++)if(this._targets[g].X1<=a&&a<=this._targets[g].X2)if(this._targets[g].Y1<=c&&c<=this._targets[g].Y2)d=this._targets[g].target;else this._targets[g].target.onSourceOut();else this._targets[g].target.onSourceOut();return d},_initListeners:function(){b.ux.touch.addListener(b.isSet(this.zone)?this.zone:document,"start",{context:this,
method:"_startDrag",arguments:null},{preventDefault:true,tracking:false});b.ux.touch.addListener(b.isSet(this.zone)?this.zone:document,"move",{context:this,method:"_drag",arguments:null},{preventDefault:true});b.ux.touch.addListener(b.isSet(this.zone)?this.zone:document,"end",{context:this,method:"_endDrag",arguments:null},{preventDefault:true})}};b.ux.dnd=b.ux.Dnd;b.ux.dnd.Source=function(a){this.uId=b.getUId();this.id=a.id;this._events=[];this._validateProperties()!==false&&this._initDom()};b.ux.dnd.Source.prototype=
{registerEvent:function(a,c,d){this._events.push({event:a,context:c,method:d})},getAvatar:function(){return null},activate:function(){for(var a=this._events.length,c=0;c<a;c++)b.subscribe(this._events[c].event,{context:this._events[c].context,method:this._events[c].method})},deactivate:function(){for(var a=this._events.length,c=0;c<a;c++)b.unsubscribe(this._events[c].event,{context:this._events[c].context,method:this._events[c].method})},_validateProperties:function(){return true},_initDom:function(){b.addClass($(this.id),
"dnd_movable");$(this.id).pozXinit=0;$(this.id).pozYinit=0}};b.ux.dnd.Target=function(a){this.uId=b.getUId();this.id=a.id;this.dnd=null;this._event=a.event;this._isOver=false;this._validateProperties()};b.ux.dnd.Target.prototype={onSourceOver:function(){if(!this._isOver){this.dnd.updateTargets();this._isOver=true}},onSourceOut:function(){if(this._isOver){this.dnd.updateTargets();this._isOver=false}},_onDrop:function(a){if(this._isOver){this.dnd.updateTargets();b.publish(this._event,{target:this,source:a});
this._isOver=false}},_validateProperties:function(){return true}};return b.ux.Dnd});
define(["../../../_amd/core"],function(b){b.ux.gesture={_gestureElements:[],_knownGestures:["two_digits_click","two_digits_press","enlargement","narrowing","rotation","instant_scale","instant_rotation","gesture_end"],TWO_DIGITS_CLICK_MAX_DURATION:350,TWO_DIGITS_PRESS_MIN_DURATION:400,SCALE_MIN_VALUE:0.2,ROTATION_MIN_VALUE:5,listenTo:function(a,c,d,e){if(!this._isGestureKnown(c)){b.log("[gesture] Cannot listen to this unknown gesture: "+c);return false}if(!b.isCallback(d)){b.log("[gesture] Invalid callback: "+
d);return false}var g={preventDefault:false};if(b.isSet(e))g.preventDefault=e===true?true:e.preventDefault===true;e=null;e=this._getGestureElementIndex(a);if(e==null){e=this._createGestureElement(a,g.preventDefault);this._gestureElements.push(e);b.ux.touch.addListener(e.domNode,"start",{context:this,method:"_handleStart",arguments:[e]},{preventDefault:e.preventDefault,tracking:false});b.ux.touch.addListener(e.domNode,"gesturestart",{context:this,method:"_handleGestureStart",arguments:[e]},{preventDefault:e.preventDefault})}else e=
this._gestureElements[e];e.addCallback(c,d)},unlistenTo:function(a,c,d){if(!this._isGestureKnown(c)){b.log("[gesture] Cannot listen to this unknown gesture: "+c);return false}if(!b.isCallback(d)){b.log("[gesture] Invalid callback: "+d);return false}var e=null;a=this._getGestureElementIndex(a);if(a!=null){e=this._gestureElements[a];e.removeCallback(c,d)}},_createGestureElement:function(a,c){return{uId:b.getUId(),domNode:a,preventDefault:c,digits:[],multitouch:false,multitouchStartTime:null,multitouchEndTime:null,
scale:1,rotation:0,gestureHandlers:[],getGestureHandler:function(d){for(var e=0;e<this.gestureHandlers.length;e++)if(this.gestureHandlers[e].gesture==d)return this.gestureHandlers[e];return null},isListening:function(d){return this.getGestureHandler(d)!=null},addCallback:function(d,e){this.isListening(d)?this.getGestureHandler(d).callbacks.push(e):this.gestureHandlers.push({gesture:d,callbacks:[e]})},removeCallback:function(d,e){if(this.isListening(d))for(var g=0;g<this.getGestureHandler(d).callbacks.length;g++){var f=
this.getGestureHandler(d).callbacks[g];if(f.context==e.context&&f.method==e.method){if(this.getGestureHandler(d).callbacks.length==1)for(g=0;g<this.gestureHandlers.length;g++){if(this.gestureHandlers[g].gesture==d){this.gestureHandlers.splice(g,1);break}}else this.getGestureHandler(d).callbacks.splice(g,1);break}}},reset:function(){this.digits=[];this.multitouch=false;this.multitouchEndTime=this.multitouchStartTime=null;this.scale=1;this.rotation=0}}},_isGestureKnown:function(a){return this._knownGestures.indexOf(a)!=
-1},_getGestureElementIndex:function(a){for(var c=0;c<this._gestureElements.length;c++)if(this._gestureElements[c].domNode==a)return c;return null},_notifyGesture:function(a,c,d){if(c.isListening(a)){a=c.getGestureHandler(a).callbacks;for(c=0;c<a.length;c++)b.call(a[c],d)}},_handleStart:function(a,c){c.reset();c.checkTimer&&clearTimeout(c.checkTimer);var d=0;if(b.isSet(a.srcEvent.targetTouches))d=a.srcEvent.targetTouches.length;if(d==2){c.multitouch=true;c.multitouchStartTime=this._getTimeStamp();
c.digits.push(this._getDigit(a.srcEvent.targetTouches[0],a));c.digits.push(this._getDigit(a.srcEvent.targetTouches[1],a));b.ux.touch.addListener(c.domNode,"move",{context:this,method:"_handleMove",arguments:[c]},{preventDefault:c.preventDefault});b.ux.touch.addListener(c.domNode,"end",{context:this,method:"_handleEnd",arguments:[c]});c.checkTimer=b.setTimeout(this,"_checkTwoDigitsPressed",this.TWO_DIGITS_PRESS_MIN_DURATION,c)}else{c.multitouch=false;b.ux.touch.removeListener(c.domNode,"move",{context:this,
method:"_handleMove",arguments:[c]});b.ux.touch.removeListener(c.domNode,"end",{context:this,method:"_handleEnd",arguments:[c]})}},_handleMove:function(a,c){var d=0;if(b.isSet(a.srcEvent.targetTouches))d=a.srcEvent.targetTouches.length;if(d==2){c.digits=[];c.digits.push(this._getDigit(a.srcEvent.targetTouches[0],a));c.digits.push(this._getDigit(a.srcEvent.targetTouches[1],a))}},_handleEnd:function(a,c){if(c.multitouch==true){var d=0;if(b.isSet(a.srcEvent.targetTouches))d=a.srcEvent.targetTouches.length;
if(d!=2)c.multitouch=false;if(d==0){b.ux.touch.removeListener(c.domNode,"move",{context:this,method:"_handleMove"});b.ux.touch.removeListener(c.domNode,"end",{context:this,method:"_handleEnd"});c.multitouchEndTime=this._getTimeStamp();c.multitouchEndTime-c.multitouchStartTime<this.TWO_DIGITS_CLICK_MAX_DURATION&&this._notifyGesture("two_digits_click",c,{digit1:c.digits[0],digit2:c.digits[1]})}}},_checkTwoDigitsPressed:function(a){a.multitouch==true&&this._notifyGesture("two_digits_press",a,{digit1:a.digits[0],
digit2:a.digits[1]})},_handleGestureStart:function(a,c){b.ux.touch.addListener(c.domNode,"gesturechange",{context:this,method:"_handleGestureChange",arguments:[c]},{preventDefault:c.preventDefault});b.ux.touch.addListener(c.domNode,"gestureend",{context:this,method:"_handleGestureEnd",arguments:[c]});c.gestureStartTime=this._getTimeStamp()},_handleGestureChange:function(a,c){if(c.multitouch==true){var d=a.srcEvent.scale-c.scale,e=a.srcEvent.rotation-c.rotation,g={digit1:c.digits[0],digit2:c.digits[1],
scale:b.math.round(a.srcEvent.scale,2)},f={digit1:c.digits[0],digit2:c.digits[1],rotation:b.math.round(a.srcEvent.rotation,2)};if(Math.abs(d)>this.SCALE_MIN_VALUE){c.scale=a.srcEvent.scale;var h=null;h=d>0?"enlargement":"narrowing";this._notifyGesture(h,c,g)}if(Math.abs(e)>this.ROTATION_MIN_VALUE){c.rotation=a.srcEvent.rotation;this._notifyGesture("rotation",c,f)}this._notifyGesture("instant_scale",c,g);this._notifyGesture("instant_rotation",c,f)}},_handleGestureEnd:function(a,c){b.ux.touch.removeListener(c.domNode,
"gesturechange",{context:this,method:"_handleGestureChange"});b.ux.touch.removeListener(c.domNode,"gestureend",{context:this,method:"_handleGestureEnd"});c.gestureEndTime=this._getTimeStamp();this._notifyGesture("gesture_end",c,{gestureDuration:c.gestureEndTime-c.gestureStartTime})},_getDigit:function(a,c){var d=b.ux.touch.getTouchProperties(a);return{x:d.x,y:d.y,timestamp:c.timestamp,target:d.target}},_getTimeStamp:function(){return(new Date).getTime()}};return b.ux.gesture});
define(["../../../_amd/core"],function(b){b.ux.GestureRecognizer=function(a){this.uId=b.getUId();this._properties=a;this._gestureEndCallback=this._gestureCallback=this._gestureStartCallback=null;this._points=[];this._templates=[];this._isDown=false;this.numTemplates=8;this.numPoint=64;this.squareSize=250;this.origin={x:0,y:0};this.diagonal=Math.sqrt(this.squareSize*this.squareSize+this.squareSize*this.squareSize);this.halfDiagonal=0.5*this.diagonal;this.angleRange=b.ux.GestureRecognizer.prototype.utils.deg2Rad(45);
this.anglePrecision=b.ux.GestureRecognizer.prototype.utils.deg2Rad(2);this.phi=0.5*(-1+Math.sqrt(5));this._domNode=null;this._validateProperties()!==false&&this._initListeners()};b.ux.GestureRecognizer.prototype={utils:{resample:function(a,c){for(var d=b.ux.GestureRecognizer.prototype.utils.pathLength(a)/(c-1),e=0,g=Array(a[0]),f=1;f<a.length;f++){var h=b.ux.GestureRecognizer.prototype.utils.distance(a[f-1],a[f]);if(e+h>=d){e={x:a[f-1].x+(d-e)/h*(a[f].x-a[f-1].x),y:a[f-1].y+(d-e)/h*(a[f].y-a[f-1].y)};
g[g.length]=e;a.splice(f,0,e);e=0}else e+=h}if(g.length==c-1)g[g.length]={x:a[a.length-1].x,y:a[a.length-1].y};return g},indicativeAngle:function(a){var c=b.ux.GestureRecognizer.prototype.utils.centroid(a);return Math.atan2(c.y-a[0].y,c.x-a[0].x)},rotateBy:function(a,c){for(var d=b.ux.GestureRecognizer.prototype.utils.centroid(a),e=Math.cos(c),g=Math.sin(c),f=[],h=0;h<a.length;h++)f[f.length]={x:(a[h].x-d.x)*e-(a[h].y-d.y)*g+d.x,y:(a[h].x-d.x)*g+(a[h].y-d.y)*e+d.y};return f},scaleTo:function(a,c){for(var d=
b.ux.GestureRecognizer.prototype.utils.boundingBox(a),e=[],g=0;g<a.length;g++)e[e.length]={x:a[g].x*(c/d.width),y:a[g].y*(c/d.height)};return e},translateTo:function(a,c){for(var d=b.ux.GestureRecognizer.prototype.utils.centroid(a),e=[],g=0;g<a.length;g++)e[e.length]={x:a[g].x+c.x-d.x,y:a[g].y+c.y-d.y};return e},distanceAtBestAngle:function(a,c,d,e,g,f){for(var h=f*d+(1-f)*e,i=b.ux.GestureRecognizer.prototype.utils.distanceAtAngle(a,c,h),j=(1-f)*d+f*e,l=b.ux.GestureRecognizer.prototype.utils.distanceAtAngle(a,
c,j);Math.abs(e-d)>g;)if(i<l){e=j;j=h;l=i;h=f*d+(1-f)*e;i=b.ux.GestureRecognizer.prototype.utils.distanceAtAngle(a,c,h)}else{d=h;h=j;i=l;j=(1-f)*d+f*e;l=b.ux.GestureRecognizer.prototype.utils.distanceAtAngle(a,c,j)}return Math.min(i,l)},distanceAtAngle:function(a,c,d){a=b.ux.GestureRecognizer.prototype.utils.rotateBy(a,d);return b.ux.GestureRecognizer.prototype.utils.pathDistance(a,c.points)},centroid:function(a){for(var c=0,d=0,e=0;e<a.length;e++){c+=a[e].x;d+=a[e].y}c/=a.length;d/=a.length;return{x:c,
y:d}},boundingBox:function(a){for(var c=+Infinity,d=-Infinity,e=+Infinity,g=-Infinity,f=0;f<a.length;f++){if(a[f].x<c)c=a[f].x;if(a[f].x>d)d=a[f].x;if(a[f].y<e)e=a[f].y;if(a[f].y>g)g=a[f].y}return{x:c,y:e,width:d-c,height:g-e}},pathDistance:function(a,c){for(var d=0,e=0;e<a.length;e++)d+=b.ux.GestureRecognizer.prototype.utils.distance(a[e],c[e]);return d/a.length},pathLength:function(a){for(var c=0,d=1;d<a.length;d++)c+=b.ux.GestureRecognizer.prototype.utils.distance(a[d-1],a[d]);return c},distance:function(a,
c){var d=c.x-a.x,e=c.y-a.y;return Math.sqrt(d*d+e*e)},deg2Rad:function(a){return a*Math.PI/180},rad2Deg:function(a){return a*180/Math.PI}},getDomNode:function(){return this._domNode},_touchStart:function(a){var c=a.x,d=a.y;this._points.length=1;this._points[0]={x:c,y:d};this._isDown=true;this._gestureStartCallback!=null&&b.call(this._gestureStartCallback,a)},_touchMove:function(a){var c=a.x,d=a.y;if(this._isDown)this._points[this._points.length]={x:c,y:d};this._gestureCallback!=null&&b.call(this._gestureCallback,
a)},_touchEnd:function(a){if(this._isDown){if(this._points.length>=10){var c=this._recognize(this._points);b.publish("/gesturerecognizer/events/result",c)}else b.publish("/gesturerecognizer/events/result",{result:null,score:0});this._isDown=false;this._gestureEndCallback!=null&&b.call(this._gestureEndCallback,a)}},_addTemplate:function(a,c){this._templates.push(new this.Template(a,this.numPoint,this.squareSize,this.origin,c))},_recognize:function(a){a=b.ux.GestureRecognizer.prototype.utils.resample(a,
this.numPoint);var c=b.ux.GestureRecognizer.prototype.utils.indicativeAngle(a);a=b.ux.GestureRecognizer.prototype.utils.rotateBy(a,-c);a=b.ux.GestureRecognizer.prototype.utils.scaleTo(a,this.squareSize);a=b.ux.GestureRecognizer.prototype.utils.translateTo(a,this.origin);c=+Infinity;for(var d=0,e=0;e<this._templates.length;e++){var g=b.ux.GestureRecognizer.prototype.utils.distanceAtBestAngle(a,this._templates[e],-this.angleRange,+this.angleRange,this.anglePrecision,this.phi);if(g<c){c=g;d=e}}return{result:this._templates[d].name,
score:1-c/this.halfDiagonal}},_initListeners:function(){b.ux.touch.addListener(this._domNode,"start",{context:this,method:"_touchStart",arguments:null},{preventDefault:true});b.ux.touch.addListener(this._domNode,"move",{context:this,method:"_touchMove",arguments:null},{preventDefault:true});b.ux.touch.addListener(this._domNode,"end",{context:this,method:"_touchEnd",arguments:null},{preventDefault:true})},_validateProperties:function(){return true},Template:function(a,c,d,e,g){this.name=a;this.points=
b.ux.GestureRecognizer.prototype.utils.resample(g,c);a=b.ux.GestureRecognizer.prototype.utils.indicativeAngle(this.points);this.points=b.ux.GestureRecognizer.prototype.utils.rotateBy(this.points,-a);this.points=b.ux.GestureRecognizer.prototype.utils.scaleTo(this.points,d);this.points=b.ux.GestureRecognizer.prototype.utils.translateTo(this.points,e)}};return b.ux.GestureRecognizer});
define(["../../../_amd/core","../../movementtracker/js/movementtracker"],function(b){b.ux.Inertia=function(a){this.uId=b.getUId();this._properties=a;this._movementtracker=null;if(this._validateProperties()!==false){this._initProperties();this._initListeners()}};b.ux.Inertia.prototype={_DIRECTION_X:"x",_DIRECTION_Y:"y",_INTERRUPTION_THRESHOLD:150,_EVENT_INERTIA_COMPUTED:"/inertia/events/inertiacomputed",destroy:function(){this._removeListeners()},_validateProperties:function(){return true},_initProperties:function(){this._movementtracker=
this._properties.movementtracker;delete this._properties},_initListeners:function(){b.subscribe("/movementtracker/events/mvtstored",{context:this,method:"_computeInertia"})},_removeListeners:function(){b.unsubscribe("/movementtracker/events/mvtstored",{context:this,method:"_computeInertia"})},_computeInertia:function(a){if(a.publisher.uId==this._movementtracker.uId){var c=a.movement,d={pointStatement:c.pointStatement},e=this._getSignificantMovement(c,this._DIRECTION_X);c=this._getSignificantMovement(c,
this._DIRECTION_Y);var g=e.pointStatement[0],f=c.pointStatement[0],h=e.pointStatement[e.pointStatement.length-1],i=c.pointStatement[c.pointStatement.length-1];d.dx=Math.abs(h.x-g.x);d.dy=Math.abs(i.y-f.y);d.dtx=h.globalDuration-g.globalDuration;if(d.dtx==0)d.dtx=1;d.dty=i.globalDuration-f.globalDuration;if(d.dty==0)d.dty=1;d.directionX=e.direction;d.directionY=c.direction;d.speedX=d.dx/d.dtx;d.speedY=d.dy/d.dty;b.publish(this._EVENT_INERTIA_COMPUTED,{publisher:this,movement:d,uxEvent:a.uxEvent,target:a.target})}},
_getSignificantMovement:function(a,c){var d=this._extractDirectedMovement(a,c);d=this._extractInterruptedMovement(d[d.length-1]);return d[d.length-1]},_extractDirectedMovement:function(a,c){var d=[],e=a.pointStatement,g=0,f=e[0].directionX;if(c==this._DIRECTION_Y)f=e[0].directionY;for(var h=0;h<e.length;h++){var i=e[h],j=i.directionX;if(c==this._DIRECTION_Y)j=i.directionY;if(f!=j||h==e.length-1){i=h;if(h==e.length-1)i=e.length;g={pointStatement:e.slice(g,i),direction:f};d.push(g);g=h;f=j}}return d},
_extractInterruptedMovement:function(a){for(var c=[],d=a.pointStatement,e=0,g=0,f=0;f<d.length;f++){g+=d[f].duration;var h=f;if(g>this._INTERRUPTION_THRESHOLD||f==d.length-1){if(f==d.length-1&&g<=this._INTERRUPTION_THRESHOLD)h=d.length;g=0;var i=d.slice(e,h);i={pointStatement:i,direction:a.direction};c.push(i);e=f;if(f==d.length-1&&g>this._INTERRUPTION_THRESHOLD){i=d.slice(h,h+1);i={pointStatement:i,direction:a.direction};c.push(i)}}}return c}};return b.ux.Inertia});
define(["../../../_amd/core"],function(b){b.ux.MovementTracker=function(a){this.uId=b.getUId();this._properties=a;this._previousPoint=this._startPoint=this._pointStatement=this._target=null;this._tracking=false;this._acceptEvents=true;this._multitouch=false;this._params={captureFlow:true,preventStart:true,preventMove:false,shiftThreshold:0,trackThresholdX:0,trackThresholdY:0};if(this._validateProperties()!==false){this._initProperties();this._initListeners()}};b.ux.MovementTracker.prototype={updateTrackThresholdX:function(a){if(this._isValidThreshold(a))this._params.trackThresholdX=
a;else this._raisePropertyError("trackThresholdX")},updateTrackThresholdY:function(a){if(this._isValidThreshold(a))this._params.trackThresholdY=a;else this._raisePropertyError("trackThresholdY")},destroy:function(){this._removeListeners()},_validateProperties:function(){return true},_isValidThreshold:function(a){return b.isInteger(a)&&a>=0},_raisePropertyError:function(a){b.log("[MovementTracker] Error: "+a+" missing or invalid")},_initProperties:function(){this._target=$(this._properties.target);
if(this._properties.captureFlow===false)this._params.captureFlow=false;if(this._properties.preventStart===false)this._params.preventStart=false;if(this._properties.preventMove===true)this._params.preventMove=true;if(b.isSet(this._properties.trackThresholdX))this._params.trackThresholdX=this._properties.trackThresholdX;if(b.isSet(this._properties.trackThresholdY))this._params.trackThresholdY=this._properties.trackThresholdY;delete this._properties},_initListeners:function(){b.ux.touch.addListener(this._target,
"start",{context:this,method:"_handleTouchStart"},{preventDefault:this._params.preventStart,captureFlow:this._params.captureFlow});b.ux.touch.addListener(this._target,"move",{context:this,method:"_handleTouchMove"},{preventDefault:this._params.preventMove,captureFlow:this._params.captureFlow});b.ux.touch.addListener(this._target,"end",{context:this,method:"_handleTouchEnd"},{captureFlow:this._params.captureFlow})},_removeListeners:function(){b.ux.touch.removeListener(this._target,"start",{context:this,
method:"_handleTouchStart"});b.ux.touch.removeListener(this._target,"move",{context:this,method:"_handleTouchMove"});b.ux.touch.removeListener(this._target,"end",{context:this,method:"_handleTouchEnd"})},_handleTouchStart:function(a){if(b.ua.isAndroid)if(!this.defered){this.defered=true;if((new Date).getTime()-a.timestamp>100){this._acceptEvents=false;a.preventDefault();var c,d={exec:b.bind(function(){clearTimeout(c);this._acceptEvents=true;this._handleTouchStart(a)},this)};c=b.setTimeout(d,"exec",
0);return}}if(this._acceptEvents!=false){this._multitouch=false;if(a.multitouch==true)this._multitouch=true;else{this._acceptEvents=false;this._pointStatement=[];this._previousPoint=null;this._tracking=false;this._startPoint={x:a.x,y:a.y};d=this._onNewTouch(a);b.publish(d.name,d.params);this._acceptEvents=true}}},_handleTouchMove:function(a){if(this._acceptEvents!=false)if(!this._multitouch){this._acceptEvents=false;a=this._onNewTouch(a);b.publish(a.name,a.params);this._acceptEvents=true}},_handleTouchEnd:function(a){if(this._acceptEvents!=
false)if(!this._multitouch){this._acceptEvents=false;a=this._onNewTouch(a);b.publish(a.name,a.params);this._acceptEvents=true}},_onNewTouch:function(a){if(this._tracking==false)if(this._params.trackThresholdX==0||this._params.trackThresholdY==0)this._tracking=true;else{var c={x:a.x,y:a.y},d=Math.abs(c.x-this._startPoint.x);c=Math.abs(c.y-this._startPoint.y);if(d>this._params.trackThresholdX||c>this._params.trackThresholdY)this._tracking=true}d={name:"/movementtracker/events/notrack",params:{publisher:this,
uxEvent:a,target:this._target}};if(this._tracking==false)return d;if(this._pointStatement.length==0)d.name="/movementtracker/events/mvtbegin";else if(a.type=="move")d.name="/movementtracker/events/mvtchanged";else if(a.type=="end")d.name="/movementtracker/events/mvtstored";this._addTouch(a);d.params.movement=this._getCurrentMovement();return d},_addTouch:function(a){a={x:a.x,y:a.y,timestamp:a.timestamp};var c=0,d=0,e=0,g=0,f=0,h=0;if(this._previousPoint==null){a.duration=0;a.globalDuration=0;c=a.x;
d=a.y}else{c=this._previousPoint.x;d=this._previousPoint.y;e=this._previousPoint.globalDx;g=this._previousPoint.globalDy;f=this._previousPoint.directionX;h=this._previousPoint.directionY;a.duration=a.timestamp-this._previousPoint.timestamp;a.globalDuration=a.duration+this._previousPoint.globalDuration}a.dx=Math.abs(a.x-c);a.dy=Math.abs(a.y-d);a.globalDx=a.dx+e;a.globalDy=a.dy+g;a.directionX=f;a.directionY=h;if(f==0&&this._previousPoint!=null){if(a.x<c)a.directionX=-1;else if(a.x>c)a.directionX=1;
this._previousPoint.directionX=a.directionX}if(h==0&&this._previousPoint!=null){if(a.y<d)a.directionY=-1;else if(a.y>d)a.directionY=1;this._previousPoint.directionY=a.directionY}if(f>0&&a.x+this._params.shiftThreshold<c)a.directionX=-1;else if(f<0&&a.x-this._params.shiftThreshold>c)a.directionX=1;if(h>0&&a.y+this._params.shiftThreshold<d)a.directionY=-1;else if(h<0&&a.y-this._params.shiftThreshold>d)a.directionY=1;this._pointStatement.push(a);this._previousPoint=a},_getCurrentMovement:function(){var a=
this._pointStatement[this._pointStatement.length-1];return{pointStatement:this._pointStatement,duration:a.globalDuration,dx:a.globalDx,dy:a.globalDy}}};return b.ux.MovementTracker});
define(["../../../_amd/core"],function(b){b.ux.Search=function(a){this.uId=b.getUId();this.currentResult=this.totalResults=0;this._properties=a;this._resultSpanEnd=this._resultSpanBetween=this._resultSpanBegin=this._originalText="";this._validateProperties()!==false&&this._initProperties()};b.ux.Search.prototype={search:function(a){var c=this._originalText,d=c.toLowerCase();a=a.toLowerCase();var e=0,g=[];for(d.lastIndexOf(a);;){var f=d.indexOf(a,e);if(f==-1)break;e=d.substr(0,f);var h=e.lastIndexOf("<");
e=e.lastIndexOf(">");if(h==-1||e!=-1&&h<e)g.push(f);e=f+a.length}d=0;this.totalResults=g.length;for(d=f=0;d<this.totalResults;d++){var i=g[d]+f;e=c.substr(0,i);h=c.substr(i,a.length);c=c.substr(i+a.length);i=d+1;c=e+this._resultSpanBegin+i+this._resultSpanBetween+h+this._resultSpanEnd+c;f+=this._resultSpanBegin.length+this._resultSpanBetween.length+this._resultSpanEnd.length+(""+i).length}this._properties.textNode.innerHTML=c;if(this.totalResults>0){this.currentResult=1;if(b.isSet(this._properties.resultSelectClassName))$("search_1").className=
this._properties.resultSelectClassName;else $("search_1").className="";return $("search_1")}else{this.currentResult=0;return null}},reset:function(){this.totalResults=0;this._properties.textNode.innerHTML=this._originalText},next:function(){this._unselect(this.currentResult);if(this.currentResult<this.totalResults){this.currentResult++;this._select(this.currentResult);return $("search_"+this.currentResult)}else if(this.totalResults>0){this.currentResult=1;this._select(this.currentResult);return $("search_"+
this.currentResult)}else{this.currentResult=0;return null}},previous:function(){this._unselect(this.currentResult);if(this.currentResult>1){this.currentResult--;this._select(this.currentResult);return $("search_"+this.currentResult)}else if(this.totalResults>0){this.currentResult=this.totalResults;this._select(this.currentResult);return $("search_"+this.currentResult)}else{this.currentResult=0;return null}},_validateProperties:function(){return true},_initProperties:function(){this._originalText=
this._properties.textNode.innerHTML;this._resultSpanBegin="<span";if(b.isSet(this._properties.resultClassName))this._resultSpanBegin+=' class="'+this._properties.resultClassName+'"';this._resultSpanBegin+=' id="search_';this._resultSpanBetween='">';this._resultSpanEnd="</span>"},_unselect:function(a){if(b.isSet(this._properties.resultClassName))$("search_"+a).className=this._properties.resultClassName;else $("search_"+a).className=""},_select:function(a){if(b.isSet(this._properties.resultSelectClassName))$("search_"+
a).className=this._properties.resultSelectClassName;else $("search_"+a).className=""}};return b.ux.Search});
define(["../../../_amd/core"],function(b){b.ux.window={height:null,width:null,fullHeight:null,fullWidth:null,screenHeight:screen.height,screenWidth:screen.width,orientation:null,_i:null,_V:"vertical",_H:"horizontal",_init:function(){var a=b.bind(this._updateData,this);"onorientationchange"in window?window.addEventListener("orientationchange",a,true):window.addEventListener("resize",a,true);if(b.ua.isAndroid){scrollTo(0,1,0);this._i=setInterval(a,1E3)}else window.addEventListener("scroll",a,true);
a()},_updateData:function(){var a=window.innerWidth,c=window.innerHeight,d=false;if(this.width+2<a||this.width-2>a||this.height+2<c||this.height-2>c)d=true;this._updateSize();this._updateOrientation();d&&b.publish("/window/events/resize",{height:c,width:a,orientation:this.orientation})},_updateSize:function(){this.height=window.innerHeight;this.width=window.innerWidth;try{this.fullHeight=document.body.scrollHeight;this.fullWidth=document.body.scrollWidth}catch(a){}},_updateOrientation:function(){var a;
a=b.isSet(window.orientation)&&b.ua.isIOS?Math.abs(window.orientation)==90?this._H:this._V:this.width>this.height?this._H:this._V;if(a!=this.orientation){this.orientation=a;b.publish("/window/events/orientationchange",{height:this.height,width:this.width,orientation:this.o})}}};window.addEventListener("DOMContentLoaded",function(){b.ux.window._init()});b.ux.Window=function(){this.getProperties=function(){return{screenWidth:b.ux.window.screenWidth,screenHeight:b.ux.window.screenHeight,width:b.ux.window.width,
height:b.ux.window.height,orientation:b.ux.window.orientation}}};return b.ux.window});
define(["../../../../_amd/core"],function(b){b.ui.layout.Accordion=function(){this.uId=b.getUId();this._sectionsList=[];this._height=this._selectedSection=0;this._domNode=null;this._initDom();this._subscribeToEvents()};b.ui.layout.Accordion.prototype={DURATION:500,addSection:function(a,c){var d=new b.ui.layout.Accordion.Section({title:a,content:c,position:this._sectionsList.length,accordion:this});this._sectionsList.push(d);this._domNode.appendChild(d.containerNode);this._updateHeight();return d.uId},
deleteSection:function(a){for(var c=-1,d=-1,e=-1,g=this._sectionsList.length,f=0;f<g;f++){if(c==1){this._sectionsList[f].position=f-1;this._sectionsList[f]._updatePosition()}if(this._sectionsList[f].uId==this._selectedSection)e=f;if(this._sectionsList[f].uId==a){c=1;d=f;this._domNode.removeChild(this._sectionsList[f].containerNode);if(this._sectionsList[f].uId==this._selectedSection)f>0?this.selectSection(this._sectionsList[f-1].uId):this.selectSection(this._sectionsList[0].uId)}}this._domNode.style.height=
this._sectionsList[0].TITLE_HEIGHT*this._sectionsList.length-1+this._sectionsList[e].contentNode.scrollHeight+"px";d!=-1&&this._sectionsList.splice(d,1)},selectSection:function(a){for(var c=this._sectionsList.length,d=-1,e=0;e<c;e++)if(this._sectionsList[e].uId==a){if(this._sectionsList[e].opened==false&&this._sectionsList[e].TITLE_HEIGHT*this._sectionsList.length+this._sectionsList[e].contentNode.scrollHeight>this._height)this._domNode.style.height=this._sectionsList[e].TITLE_HEIGHT*this._sectionsList.length+
this._sectionsList[e].contentNode.scrollHeight+"px";d=e;this._sectionsList[e].show();this._selectedSection=a}else d==-1||d!=-1&&this._sectionsList[d].opened===false?this._sectionsList[e].hide(-1):this._sectionsList[e].hide(this._sectionsList[d].contentNode.scrollHeight)},refreshContentHeight:function(){this.selectSection(this._selectedSection)},getDomNode:function(){return this._domNode},getSections:function(){return this._sectionsList},_updateHeight:function(){this._height=this._sectionsList[0].TITLE_HEIGHT*
this._sectionsList.length;this._domNode.style.height=this._height+"px"},_selectSection:function(a){this.selectSection(a.sectionId)},_initDom:function(){this._domNode=document.createElement("div");this._domNode.className="w_list w_border_top ac_accordion"},_subscribeToEvents:function(){b.subscribe("/section/events/selectsection",{context:this,method:"_selectSection"})}};b.ui.layout.Accordion.Section=function(a){this.uId=b.getUId();this.title=a.title;this.content=a.content;this.position=a.position;
this.opened=false;this.DURATION=500;this.HIGHER_INDEX=999;this.TITLE_HEIGHT=44;this.containerNode=this.contentNode=this.chevronNode=this.titleNode=null;this._accordion=a.accordion;this._validateProperties()!==false&&this._initDom()};b.ui.layout.Accordion.Section.prototype={show:function(){this.containerNode.translate(0,0);this.chevronNode.rotate(0);b.fx.onTransitionEnd(this.contentNode,b.bind(this._scroll,this));if(this.opened===false){this.contentNode.translate(0,this.contentNode.scrollHeight);this.chevronNode.rotate(90);
this.opened=true}else{this.contentNode.translate(0,0);this.chevronNode.rotate(0);this.opened=false}},hide:function(a){a==-1?this.containerNode.translate(0,0):this.containerNode.translate(0,a);this.opened=false;this.contentNode.translate(0,0);this.chevronNode.rotate(0)},_scroll:function(){this._accordion._height=this.opened==false?this.TITLE_HEIGHT*this._accordion._sectionsList.length:this.TITLE_HEIGHT*this._accordion._sectionsList.length+this.contentNode.scrollHeight;this._accordion._domNode.style.height=
this._accordion._height+"px";scrollTo(0,this.titleNode.getTopPosition())},_validateProperties:function(){return true},_updatePosition:function(){this.containerNode.style.top=this.position*this.TITLE_HEIGHT+"px"},_initDom:function(){this.containerNode=document.createElement("div");this.containerNode.className="ac_section";this.containerNode.style.zIndex=this.HIGHER_INDEX-this.position;this.containerNode.style.top=this.position*this.TITLE_HEIGHT+"px";this.containerNode.translate(0,0);b.fx.applyTransformTransition(this.containerNode,
this.DURATION+"ms","","ease-in-out");this.contentNode=document.createElement("div");this.contentNode.className="w_bloc w_box w_border ac_content";this.contentNode.translate(0,0);b.fx.applyTransformTransition(this.contentNode,this.DURATION+"ms","","ease-in-out");if(b.isString(this.content))this.contentNode.innerHTML=this.content;else{this.contentNode.innerHTML="";this.contentNode.appendChild(this.content)}this.titleNode=document.createElement("div");this.titleNode.innerHTML=this.title;this.titleNode.className=
"w_box w_list_item w_border_bottom w_border_left w_border_right w_bg_light ac_title";this.titleNode.onclick=b.bind(function(){b.publish("/section/events/selectsection",{sectionId:this.uId})},this);this.chevronNode=document.createElement("div");this.chevronNode.className="w_icon w_chevron";this.chevronNode.rotate(0);b.fx.applyTransformTransition(this.chevronNode,this.DURATION+"ms","","ease-in-out");this.titleNode.appendChild(this.chevronNode);this.containerNode.appendChild(this.titleNode);this.containerNode.appendChild(this.contentNode)}};
return b.ui.layout.Accordion});
define(["../../../../_amd/core","../../../../ux/window/js/window"],function(b){b.ui.layout.FixedLayout=function(a){var c=window,d=b.isSet,e=b.addClass,g=false,f=false,h=null,i=null,j=null,l=null,k=null,m=null,n=null,o=function(r){c.scrollTo(0,r)},p=function(){return true},q=function(){g=d(this.header);f=d(this.footer);j=$(this.target);e(j,"fl_target");if(g){h=$(this.header);e(h,"fl_bar");l=h.style}if(f){i=$(this.footer);e(i,"fl_bar");k=i.style}s.call(this)},s=function(){var r=j.style;m=this.paddingTop;
n=this.paddingBottom;if(g)r.paddingTop=(d(m)?m:h.offsetHeight)+"px";if(f)r.paddingBottom=(d(n)?n:i.offsetHeight)+"px"},t=function(){var r=null,v=function(x){r=this;r.uId=b.getUId();b.mixin(r,x);if(p.call(r)!==false){q.call(r);g&&e(h,"fl_header fixed");f&&e(i,"fl_footer fixed")}};v.prototype={enable:function(){},disable:function(){},getPosition:function(){return c.pageYOffset},refreshView:function(){s.call(this)},scrollTo:o};return v}(),u=function(){var r=null,v=function(A){r=this;r.uId=b.getUId();
r.displayDuration=0;r.moveDuration=0;r.preventTouchBar=true;r.activated=true;r.showHideOnClick=false;r.urlBarShorcutHeight=0;r.scrollAtStart=false;b.mixin(r,A);J=r.scrollAtStart;if(p.call(r)!==false){q.call(r);U();r.activated&&K()}};v.prototype={enable:function(){r.activated=true},disable:function(){r.activated=false;R()},getPosition:function(){return B},refreshView:function(){s.call(this);K()},scrollTo:o};var x=b.ux.touch.addListener,B=null,F=false,w=null,y=null,E=false,z=null,I=null,G=null,J=false,
L=true,M=0,N=false,V=b.has("touchstart"),W=b.has("touchmove"),K=function(A,C){if(r.activated){if(!C)if(!E&&!F){if(g)l.visibility="hidden";if(f)k.visibility="hidden";if(g){var D=0;if(I!=D){l.top=D+"px";l.WebkitTransition="";l.WebkitAnimation="";I=D}l.visibility=""}if(f){D=j.offsetHeight-i.offsetHeight;if(G!=D){k.top=D+"px";k.WebkitTransition="";k.WebkitAnimation="";G=D}k.visibility=""}}if(J&&A&&A.type&&A.type!="start")L=true;if(!F){F=true;M=0;z=b.setInterval(O,"_scrollTest",300)}}},R=function(){if(z){clearInterval(z);
z=null}F=false;if(J)L=false},S=function(A,C,D){var H=A.style;if(!E)if(D)b.fx.applyTransition(A,"top",r.moveDuration+"ms","0ms","ease-in");else r.displayDuration>0&&P(H);H.top=C+"px"},P=function(A,C){A.WebkitAnimation=(C?"opacity-inv":"opacity")+" "+r.displayDuration+"ms";A.opacity=C?0:1},X=function(){if(!(F&&L)){N=true;E=!E;g&&P(l,E);f&&P(k,E)}},U=function(){if(W){if(J){L=false;x(j,"start",{context:T,method:"perform",arguments:K},{captureFlow:true})}x(j,"move",{context:T,method:"perform",arguments:K},
{captureFlow:true})}c.addEventListener("scroll",function(C){K(C,true)},false);b.subscribe("/window/events/orientationchange",{context:O,method:"_handleScroll"});r.showHideOnClick&&j.addEventListener("click",X,false);if(V&&r.preventTouchBar){var A=function(C,D,H){x(C,D,{context:O,method:H})};if(g){A(h,"start","_onTouchBar");A(h,"end","_onTouchBar")}if(f){A(i,"start","_onTouchBar");A(i,"end","_onTouchBar")}}},T=function(){var A,C,D={},H=function(){A||(A=setInterval(function(){clearInterval(A);A=null;
C=false},100))};D.perform=function(Q,Y){if(!C){C=true;Y(Q)}H()};return D}(),O={_onTouchBar:function(A){if(A.type=="start"){w=A;A.preventDefault()}else{y=A;y.timestamp-w.timestamp<250&&Math.abs(y.x-w.x)<20&&y.dispatch(y.target,"click")}},_handleScroll:K,_scrollTest:function(){if(J&&!E){M+=300;if(!L&&M<500)return}var A=c.pageYOffset;if(B!=A)B=A;else{R();if(J&&N)N=false;else{A=B+c.innerHeight;if(g){var C=false,D=B,H=r.urlBarShorcutHeight;if(H>0&&B>0)D+=H;if(D!=I){if(!E&&r.moveDuration>0){H=h.offsetTop;
C=H<=B;C=H+h.offsetHeight>B&&C}I=D;S(h,D,C)}}if(f){C=false;H=i.offsetHeight;D=A-H;if(D!=G){if(!E&&r.moveDuration>0){C=i.offsetTop;var Q=C<A;C=C+H>=A&&Q}G=D;S(i,D,C)}}}}}};return v}();return a.nativeFixed!==false&&b.has("css-position-fixed")?new t(a):new u(a)};return b.ui.layout.FixedLayout});
define(["../../../../_amd/core","../../../../ux/inertia/js/inertia"],function(b){b.ui.layout.Scroller=function(a){this.uId=b.getUId();this._direction=this._target=null;this._captureFlow=true;this._view={x:0,y:0,viewportSizeX:0,viewportSizeY:0,sizeX:0,sizeY:0,limitX:0,limitY:0,shiftOriginY:0,shiftLimitY:0,scrollbars:{x:null,y:null,active:true,width:null,backgroundColor:null,borderColor:null,opacityTransition:null},autoRefreshOptions:{active:false,checkDelay:1E3,handler:null},timerSize:null};this._scroll=
{canScrollX:false,canScrollY:false,mustScrollX:false,mustScrollY:false,friction:14,acceleration:-0.00126,minSpeed:0.05};this._transition={duration:0,delay:0,func:"cubic-bezier(0.1, 0.2, 0.5, 1)",endHandler:null};this._callbacks={scrollerTouched:null,scrollerClicked:null,startScrolling:null,scrolling:null,endScrolling:null,startSliding:null,stopSliding:null};this._inertia=this._movementtracker=null;this._activated=true;this._animated=this._moveOutside=false;this._selectionEvent=null;this._updateContext(a)};
b.ui.layout.Scroller.prototype={_DIRECTION_X:"x",_DIRECTION_Y:"y",_DIRECTION_XY:"xy",updateTargetSize:function(a,c,d){if(this._view.timerSize==null)if(d===true&&this._view.timerSize==null){this._refreshTargetSize(a,c,false);this._view.timerSize=b.setTimeout(this,"_refreshTargetSize",this._view.autoRefreshOptions.checkDelay,a,c,d)}else this._refreshTargetSize(a,c,d)},updateViewportSize:function(a,c){var d=this._target.parentNode.clientWidth,e=this._target.parentNode.clientHeight;if(b.isSet(a))d=a;
if(b.isSet(c))e=c;if(this._view.viewportSizeX!=d||this._view.viewportSizeY!=e){this._setViewportSize(d,e);this._refreshView()}},updateShiftBounds:function(a,c){var d=false;if(a!=this._view.shiftOriginY){this._view.shiftOriginY=a;if(this._view.y==0)this._view.y=a;d=true}if(c!=this._view.shiftLimitY){this._view.shiftLimitY=c;d=true}if(d){this._refreshView();this._backToBounds()}},autoRefresh:function(a){if(b.isSet(a.checkDelay)&&a.checkDelay>=0)this._view.autoRefreshOptions.checkDelay=a.checkDelay;
if(b.isSet(a.active)&&this._view.autoRefreshOptions.active!==a.active){this._view.autoRefreshOptions.active=a.active;this._listenToContentChanges(a.active)}},scrollTo:function(a,c,d){this._slideTo(a,c,{duration:d})},backToBounds:function(){this._backToBounds()},getPosition:function(){return{x:this._view.x,y:this._view.y}},getViewProperties:function(){return this._view},enable:function(){this._activated=true},disable:function(){this._activated=false},destroy:function(){this._removeListeners();this._movementtracker.destroy();
delete this._movementtracker;this._inertia.destroy();delete this._inertia;this._removeScrollbars(true,true);for(var a in this._callbacks)this._callbacks[a]=null;if(this._view.timerSize!=null){clearTimeout(this._view.timerSize);this._view.timerSize=null}b.fx.apply(this._target,{"user-select":""});b.fx.applyTransition(this._target,"","","","");b.fx.setTransform(this._target,"");this._target=null},changeContext:function(a){this.destroy();this._updateContext(a)},_setTargetSize:function(a,c){this._view.sizeX=
a;this._view.sizeY=c},_setViewportSize:function(a,c){this._view.viewportSizeX=a;this._view.viewportSizeY=c},_updateContext:function(a){this._properties=a;if(this._validateProperties()!==false){this._initProperties();this._initListeners();this._slideTo(0,0);this._refreshView()}},_validateProperties:function(){return true},_raisePropertyError:function(a){b.log("[Scroller] Error: "+a+" missing or invalid")},_initProperties:function(){this._target=$(this._properties.target);b.fx.apply(this._target,{"user-select":"none"});
if(b.isSet(this._properties.shiftOriginY))this._view.shiftOriginY=this._properties.shiftOriginY;if(b.isSet(this._properties.shiftLimitY))this._view.shiftLimitY=this._properties.shiftLimitY;this._setTargetSize(this._target.offsetWidth,this._target.offsetHeight);this._setViewportSize(this._target.parentNode.clientWidth,this._target.parentNode.clientHeight);this._direction=this._properties.direction;if(this._direction==this._DIRECTION_X||this._direction==this._DIRECTION_XY)this._scroll.mustScrollX=true;
if(this._direction==this._DIRECTION_Y||this._direction==this._DIRECTION_XY)this._scroll.mustScrollY=true;if(this._properties.captureFlow===false)this._captureFlow=false;if(b.isSet(this._properties.callbacks))for(var a in this._callbacks){var c=this._properties.callbacks[a];if(b.isSet(c))this._callbacks[a]=c}if(b.isSet(this._properties.scrollbars))for(a in this._view.scrollbars){c=this._properties.scrollbars[a];if(b.isSet(c))this._view.scrollbars[a]=c}a=this._properties.friction;if(b.isSet(a)&&b.isInteger(a)){this._scroll.friction=
Math.max(Math.min(a,100),1);this._scroll.acceleration=Math.min(-9.0E-5*this._scroll.friction,-1.0E-4);this._scroll.minSpeed=Math.sqrt(Math.abs(this._scroll.acceleration*2))}delete this._properties},_initListeners:function(){this._movementtracker=new b.ux.MovementTracker({target:this._target,captureFlow:this._captureFlow,preventStart:false,preventMove:false,trackThresholdX:5,trackThresholdY:5});b.subscribe("/movementtracker/events/notrack",{context:this,method:"_handleTouchNotTracked"});b.subscribe("/movementtracker/events/mvtbegin",
{context:this,method:"_handleMovementBegin"});b.subscribe("/movementtracker/events/mvtchanged",{context:this,method:"_handleMovementChanged"});this._inertia=new b.ux.Inertia({movementtracker:this._movementtracker});b.subscribe("/inertia/events/inertiaComputed",{context:this,method:"_handleMovementStored"});this._transition.endHandler=b.fx.onTransitionEnd(this._target,b.bind(this._handleTransitionEnd,this),true)},_removeListeners:function(){b.unsubscribe("/movementtracker/events/notrack",{context:this,
method:"_handleTouchNotTracked"});b.unsubscribe("/movementtracker/events/mvtbegin",{context:this,method:"_handleMovementBegin"});b.unsubscribe("/movementtracker/events/mvtchanged",{context:this,method:"_handleMovementChanged"});b.unsubscribe("/inertia/events/inertiaComputed",{context:this,method:"_handleMovementStored"});this._target.removeEventListener(b.has.prop("transitionend"),this._transition.endHandler,false);this._transition.endHandler=null;this._listenToContentChanges(false)},_listenToContentChanges:function(a){if(a){var c=
this._view.autoRefreshOptions.checkDelay>0;this._view.autoRefreshOptions.handler=b.bind(function(){var d=this._target.offsetHeight;if(this._view.sizeX!=this._target.offsetWidth||this._view.sizeY!=d)this.updateTargetSize(null,null,c)},this);this._target.addEventListener("DOMSubtreeModified",this._view.autoRefreshOptions.handler,false)}else if(this._view.autoRefreshOptions.handler!=null){this._target.removeEventListener("DOMSubtreeModified",this._view.autoRefreshOptions.handler,false);this._view.autoRefreshOptions.handler=
null}},_refreshTargetSize:function(a,c,d){this._view.timerSize!=null&&clearTimeout(this._view.timerSize);var e=this._target.offsetWidth,g=this._target.offsetHeight;if(b.isSet(a))e=a;if(b.isSet(c))g=c;this._view.timerSize=null;if(this._view.sizeX!=e||this._view.sizeY!=g){this._setTargetSize(e,g);this._refreshView();if(d===true)this._view.timerSize=b.setTimeout(this,"_refreshTargetSize",this._view.autoRefreshOptions.checkDelay,a,c,d)}},_refreshView:function(){var a=this._scroll.canScrollX,c=this._scroll.canScrollY;
if(this._view.sizeX>this._view.viewportSizeX){this._view.limitX=this._view.viewportSizeX-this._view.sizeX;this._scroll.canScrollX=true}else{this._view.limitX=0;this._scroll.canScrollX=false}shiftSizeY=this._view.sizeY-(this._view.shiftOriginY+this._view.shiftLimitY);if(shiftSizeY>this._view.viewportSizeY){this._view.limitY=this._view.viewportSizeY-shiftSizeY;this._scroll.canScrollY=true}else{this._view.limitY=0;this._scroll.canScrollY=false}this._scroll.canScrollX?this._movementtracker.updateTrackThresholdX(5):
this._movementtracker.updateTrackThresholdX(999);this._scroll.canScrollY?this._movementtracker.updateTrackThresholdY(5):this._movementtracker.updateTrackThresholdY(999);if(a!=this._scroll.canScrollX)if(this._view.x!=0){this._view.x=0;this._slideTo(null,null,{backToBound:true,duration:1})}if(c!=this._scroll.canScrollY)if(this._view.y!=0){this._view.y=0;this._slideTo(null,null,{backToBound:true,duration:1})}if(this._view.scrollbars.active==true){if(this._scroll.canScrollX&&this._scroll.mustScrollX){a=
this._view.scrollbars.x;if(a==null)a=this._view.scrollbars.x=new b.ui.layout.Scroller.Scrollbar({direction:"x",width:this._view.scrollbars.width,backgroundColor:this._view.scrollbars.backgroundColor,borderColor:this._view.scrollbars.borderColor,opacityTransition:this._view.scrollbars.opacityTransition});a.updateSize(this._view.viewportSizeX,this._view.sizeX);this._target.parentNode.appendChild(a.getDomNode())}else this._removeScrollbars(true,false);if(this._scroll.canScrollY&&this._scroll.mustScrollY){a=
this._view.scrollbars.y;if(a==null)a=this._view.scrollbars.y=new b.ui.layout.Scroller.Scrollbar({direction:"y",width:this._view.scrollbars.width,backgroundColor:this._view.scrollbars.backgroundColor,borderColor:this._view.scrollbars.borderColor,opacityTransition:this._view.scrollbars.opacityTransition});a.updateSize(this._view.viewportSizeY,shiftSizeY);this._target.parentNode.appendChild(a.getDomNode())}else this._removeScrollbars(false,true);a={timeout:null,hide:function(d){clearTimeout(this.timeout);
d._hideScrollbars()}};a.timeout=b.setTimeout(a,"hide",1E3,this)}},_removeScrollbars:function(a,c){if(a==true&&this._view.scrollbars.x!=null){this._target.parentNode.removeChild(this._view.scrollbars.x.getDomNode());this._view.scrollbars.x=null}if(c==true&&this._view.scrollbars.y!=null){this._target.parentNode.removeChild(this._view.scrollbars.y.getDomNode());this._view.scrollbars.y=null}},_handleTouchNotTracked:function(a){if(a.publisher.uId==this._movementtracker.uId){a=a.uxEvent;a.type=="start"&&
b.isSet(this._callbacks.scrollerTouched)&&b.call(this._callbacks.scrollerTouched,{uxEvent:a});if(this._activated!=false){a.preventDefault();a.stopPropagation();if(a.type=="start"){this._selectionEvent=null;if(this._animated==false)this._selectionEvent=a;a=this._getInstantPosition();if(!this._isAtPosition(a.x,a.y)){b.isSet(this._callbacks.stopSliding)&&b.call(this._callbacks.stopSliding,{});this._slideTo(a.x,a.y)}}else if(a.type=="end"){this._backToBounds();this._hideScrollbars();if(b.isSet(this._selectionEvent)){b.isSet(this._callbacks.scrollerClicked)&&
b.call(this._callbacks.scrollerClicked,{uxEvent:a});this._handleSelection(a)}}}}},_handleMovementBegin:function(a){if(a.publisher.uId==this._movementtracker.uId)if(this._activated!=false){a=a.uxEvent;a.preventDefault();a.stopPropagation();b.isSet(this._callbacks.startScrolling)&&b.call(this._callbacks.startScrolling,{uxEvent:a});b.isSet(this._view.autoRefreshOptions.handler)&&this._view.autoRefreshOptions.handler()}},_handleSelection:function(a){var c=this._getProperEventTarget(a);if(b.has("touch"))a.dispatch(c,
"click");else{a=c.tagName;if(b.isSet(a)&&(a.toLowerCase()=="textarea"||a.toLowerCase()=="input"&&c.type.toLowerCase()=="text"))c.focus()}},_getProperEventTarget:function(a){var c=a.target;if(a.target.nodeType==3)c=c.parentNode;return c},_handleMovementChanged:function(a){if(a.publisher.uId==this._movementtracker.uId)if(this._activated!=false){a.uxEvent.stopPropagation();var c=a.movement,d=c.pointStatement[c.pointStatement.length-2];c=c.pointStatement[c.pointStatement.length-1];var e=c.x-d.x;d=c.y-
d.y;var g=this._view.y;if(g>0)g-=this._view.shiftOriginY;else if(g<this._view.limitY)g+=this._view.shiftLimitY;this._moveOutside=false;g=this._getBoundsInfos(this._view.x,g);if(g.outsideOfBoundsX)if(g.directionX>0&&c.directionX>0||g.directionX<0&&c.directionX<0){e/=3;this._moveOutside=true}if(g.outsideOfBoundsY)if(g.directionY>0&&c.directionY>0||g.directionY<0&&c.directionY<0){d/=3;this._moveOutside=true}c=this._view.x+b.math.round(e,0);e=this._view.y+b.math.round(d,0);this._slideTo(c,e);b.isSet(this._callbacks.scrolling)&&
b.call(this._callbacks.scrolling,{uxEvent:a.uxEvent})}},_handleMovementStored:function(a){if(a.publisher.uId==this._inertia.uId)if(this._activated!=false){b.isSet(this._callbacks.endScrolling)&&b.call(this._callbacks.endScrolling,{uxEvent:a.uxEvent});a=a.movement;this._interpretInertia(a);if(!this._moveOutside&&!this._isAtPosition(a.destX,a.destY))this._slideTo(a.destX,a.destY,{duration:a.duration,speed:a.speed});else{this._backToBounds();this._hideScrollbars()}}},_interpretInertia:function(a){var c=
this._scroll.canScrollX&&this._scroll.mustScrollX,d=this._scroll.canScrollY&&this._scroll.mustScrollY,e=b.math.round(this._view.viewportSizeX/3,1),g=b.math.round(this._view.viewportSizeY/3,1),f=this._scroll.acceleration,h=this._scroll.minSpeed,i=a.speedX,j=a.speedY;i=i<h?0:i;j=j<h?0:j;h=-(i*i)/(2*f);var l=-(j*j)/(2*f),k=-i/f;f=-j/f;c||(h=k=0);d||(l=f=0);var m=this._getBoundsInfos(this._view.x+h*a.directionX,this._view.y+l*a.directionY);if(m.outsideOfBoundsX&&m.distanceToBoundX>e){e=m.distanceToBoundX-
e;var n=e/h;h-=e;k-=n*k}if(m.outsideOfBoundsY&&m.distanceToBoundY>g){e=m.distanceToBoundY-g;n=e/l;l-=e;f-=n*f}a.destX=this._view.x+b.math.round(h*a.directionX,0);a.destY=this._view.y+b.math.round(l*a.directionY,0);k=Math.max(b.math.round(k,0),1);f=Math.max(b.math.round(f,0),1);a.duration=f;a.speed=b.math.round(j,3);if(c&&!d||c&&d&&k>f){a.duration=k;a.speed=b.math.round(i,3)}},_handleTransitionEnd:function(){if(this._animated==true){this._animated=false;b.isSet(this._callbacks.stopSliding)&&b.call(this._callbacks.stopSliding,
{});var a=0;if(this._backToBounds())a=350;this._hideScrollbars(a)}},_backToBounds:function(){var a=this._getBoundsInfos(this._view.x,this._view.y);if(a.outsideOfBounds){var c=this._view.x,d=this._view.y;if(a.outsideOfBoundsX)c=a.positionOfBoundX;if(a.outsideOfBoundsY)d=a.positionOfBoundY;this._slideTo(c,d,{backToBound:true});return true}return false},_getBoundsInfos:function(a,c){var d={outsideOfBoundsX:false,outsideOfBoundsY:false,distanceToBoundX:0,distanceToBoundY:0};if(a>0||a<this._view.limitX){d.outsideOfBoundsX=
true;if(a>0){d.distanceToBoundX=Math.abs(a);d.directionX=1;d.positionOfBoundX=0}else{d.distanceToBoundX=Math.abs(a-this._view.limitX);d.directionX=-1;d.positionOfBoundX=this._view.limitX}}if(c>0||c<this._view.limitY){d.outsideOfBoundsY=true;if(c>0){d.distanceToBoundY=Math.abs(c);d.directionY=1;d.positionOfBoundY=0}else{d.distanceToBoundY=Math.abs(c-this._view.limitY);d.directionY=-1;d.positionOfBoundY=this._view.limitY}}d.outsideOfBounds=d.outsideOfBoundsX||d.outsideOfBoundsY;return d},_isAtPosition:function(a,
c){if(this._view.x==a&&this._view.y==c)return true;return false},_slideTo:function(a,c,d){var e=d&&d.duration?d.duration:0,g=d&&d.speed?d.speed:0;d=d&&d.backToBound?d.backToBound:false;this._transition.duration=e;if(e>=1){this._animated=true;b.isSet(this._callbacks.startSliding)&&b.call(this._callbacks.startSliding,{duration:e,speed:g})}else this._animated=false;e=e+"ms";g=this._transition.delay+"ms";var f=this._transition.func;if(d){e="350ms";f="cubic-bezier(0.3, 0.1, 1.0, 0.5)"}b.fx.applyTransformTransition(this._target,
e,g,f);if(this._view.scrollbars.active==true){this._view.scrollbars.x!=null&&this._view.scrollbars.x.applyTransition(e,g,f);this._view.scrollbars.y!=null&&this._view.scrollbars.y.applyTransition(e,g,f)}this._translateTo(a,c)},_getInstantPosition:function(){var a=b.fx.getTransformPosition(this._target);a.y+=this._view.shiftOriginY;return a},_translateTo:function(a,c){var d=this._view.x,e=this._view.y;if(b.isSet(a)&&this._scroll.canScrollX&&this._scroll.mustScrollX)d=a;if(b.isSet(c)&&this._scroll.canScrollY&&
this._scroll.mustScrollY)e=c;this._view.x=parseInt(d);this._view.y=parseInt(e);this._target.translate(this._view.x,this._view.y-this._view.shiftOriginY);if(this._view.scrollbars.active==true){this._view.scrollbars.x!=null&&this._view.scrollbars.x.updatePosition(this._view.x,this._view.y);this._view.scrollbars.y!=null&&this._view.scrollbars.y.updatePosition(this._view.x,this._view.y)}},_hideScrollbars:function(a){if(this._view.scrollbars.active==true){this._view.scrollbars.x!=null&&this._view.scrollbars.x.hide(a);
this._view.scrollbars.y!=null&&this._view.scrollbars.y.hide(a)}}};b.ui.layout.Scroller.Scrollbar=function(a){this.uId=b.getUId();this._properties=a;this._direction=null;this._backgroundColor="rgba(0, 0, 0, 0.55)";this._borderColor="rgba(0, 0, 0, 0.2)";this._opacityTransition=true;this._view={x:0,y:0,viewportSize:0,contentSize:0,size:0,width:0,ratioSize:0,ratioPosition:0,ratioBounce:0,borderSize:1,availableSpace:0,showed:true};this._transition={duration:"",delay:"",func:""};this._ctx=this._canvasNode=
this._domNode=null;this._firstHide=true;if(this._validateProperties()!==false){this._initProperties();this._initDom()}};b.ui.layout.Scroller.Scrollbar.prototype={_DEFAULT_WIDTH:5,getDomNode:function(){return this._domNode},updateSize:function(a,c){var d=0,e=0;this._view.viewportSize=a-this._view.borderSize*2;this._view.contentSize=c;if(a<c){this._view.ratioSize=this._view.viewportSize/this._view.contentSize;this._view.ratioSize*=0.11*(this._view.contentSize/this._view.viewportSize)+0.89}else this._view.ratioSize=
1;d=e=this._view.ratioSize*this._view.viewportSize;if(this._direction=="y")d=this._view.width;else e=this._view.width;this._resize(d,e);this._view.availableSpace=this._view.viewportSize-this._view.size;this._view.ratioPosition=this._view.availableSpace/(this._view.contentSize-this._view.viewportSize);this._view.ratioBounce=0.001*this._view.contentSize+3},updatePosition:function(a,c){this._view.showed==false&&this.show();var d=0,e=0,g=this._view.availableSpace;if(this._direction=="y"){e=-c*this._view.ratioPosition;
if(e<0||e>g)e=e<0?Math.max(e+e*this._view.ratioBounce,-this._view.size+5):Math.min(e+(e-g)*this._view.ratioBounce,this._view.viewportSize-5)}else{d=-a*this._view.ratioPosition;if(d<0||d>g)d=d<0?Math.max(d+d*this._view.ratioBounce,-this._view.size+5):Math.min(d+(d-g)*this._view.ratioBounce,this._view.viewportSize-5)}this._translateTo(d,e)},show:function(){if(this._view.showed!=true){this._view.showed=true;b.fx.applyTransition(this._canvasNode,"opacity","0ms","0ms","default");this._canvasNode.style.opacity=
1}},hide:function(a){if(this._view.showed!=false){this._view.showed=false;if(this._opacityTransition==true){var c=300;if(b.isSet(a))c+=a;if(this._firstHide){this._firstHide=false;c+=600}c+="ms";b.fx.applyTransition(this._canvasNode,"opacity","200ms",c,"default")}this._canvasNode.style.opacity=0}},applyTransition:function(a,c,d){var e=false;if(e=(e=(e=e||a!=this._transition.duration)||c!=this._transition.delay)||d!=this._transition.func){this._transition.duration=a;this._transition.delay=c;this._transition.func=
d;b.fx.applyTransformTransition(this._domNode,a,c,d)}},_validateProperties:function(){return true},_raisePropertyError:function(a){b.log("[Scrollbar] Error: "+a+" missing or invalid")},_initProperties:function(){this._direction=this._properties.direction;this._view.width=this._DEFAULT_WIDTH;if(b.isSet(this._properties.width))this._view.width=this._properties.width;if(b.isSet(this._properties.borderColor))this._borderColor=this._properties.borderColor;if(b.isSet(this._properties.backgroundColor))this._backgroundColor=
this._properties.backgroundColor;if(b.isSet(this._properties.opacityTransition))this._opacityTransition=this._properties.opacityTransition},_initDom:function(){var a=this._domNode=document.createElement("div"),c=this._canvasNode=document.createElement("canvas");this._ctx=c.getContext("2d");a.appendChild(c);var d={position:"absolute","pointer-events":"none",opacity:1};if(this._direction=="y"){d.top="0px";d.right="1px"}else{d.bottom="2px";d.left="0px"}b.fx.apply(a,d);b.fx.apply(c,{position:"absolute"});
c.translate(0,0)},_drawbar:function(){var a=this._direction=="y",c=this._ctx,d=a?this._view.width/2:this._view.width/2+1,e=a?this._view.width/2+1:this._view.width/2,g=a?this._view.width:this._view.size-1,f=a?this._view.size-1:this._view.width,h=a?g/2:f/2;c.fillStyle=this._backgroundColor;c.strokeStyle=this._borderColor;c.lineWidth=this._view.borderSize;c.beginPath();if(a){c.arc(d,e,h,Math.PI,0,false);c.lineTo(d+h,f-h);c.arc(d,f-h,h,0,Math.PI,false);c.lineTo(d-h,e)}else{c.arc(d,e,h,Math.PI/2,3*Math.PI/
2,false);c.lineTo(g-h,e-h);c.arc(g-h,e,h,3*Math.PI/2,Math.PI/2,false);c.lineTo(d,e+h)}c.closePath();c.fill();c.stroke()},_resize:function(a,c){this._view.size=this._direction=="y"?c:a;var d=this._canvasNode;this._ctx.clearRect(0,0,d.width,d.height);b.fx.apply(this._domNode,{width:a+1+"px",height:c+"px"});d.width=a;d.height=c;this._drawbar()},_translateTo:function(a,c){this._view.x=a;this._view.y=c;this._domNode.translate(a,c)}};return b.ui.layout.Scroller});
define(["../../../../_amd/core"],function(b){b.ui.layout.SlidingPanels=function(a){this.uId=b.getUId();this.pages=null;this.transitionType="default";this.duration=800;this.HIGHER_INDEX=100;this.LOWER_INDEX=99;this._domNode=null;this._queue=[];this._pagesList=[];this._currentPage=this._firstPage=null;this._isSliding=false;b.mixin(this,a);if(this._validateProperties()!==false){this._initDom();this._initProperties()}};b.ui.layout.SlidingPanels.prototype={_TRANSITION_DEFAULT:"default",_TRANSITION_REVEAL:"reveal",
_TRANSITION_COVER:"cover",getDomNode:function(){return this._domNode},slideTo:function(a){if(!this._isSliding){var c=this._getQueueIndex(a);if(c!==false)c==this._queue.length-1?this.slideBack():this._silentSlideBack(a);else{c=this._firstPage;a=this._getPageById(a);var d=this.transitionType,e=this.duration,g=d==this._TRANSITION_REVEAL;d=d==this._TRANSITION_COVER;if(a!=null)this._slideStart({firstPage:c,currentPage:a,firstPageDuration:d?"":e,currentPageDuration:g?"":e,pageToListen:g?c:a,slideEndHandler:b.bind(this._onSlideEnd,
this,-1),firstPageTranslation:d?0:"-100%",firstPageZIndex:d?this.LOWER_INDEX:undefined,currentPageZIndex:d?this.HIGHER_INDEX:undefined})}}},slideBack:function(){if(!this._isSliding){var a=this._firstPage,c=this._queue.pop(),d=this.transitionType,e=this.duration,g=d==this._TRANSITION_REVEAL;this._slideStart({firstPage:a,currentPage:c,firstPageDuration:g?"":e,currentPageDuration:d==this._TRANSITION_COVER?"":e,pageToListen:g?c:a,slideEndHandler:b.bind(this._onSlideEnd,this,1),firstPageTranslation:g?
0:"100%",firstPageZIndex:g?this.LOWER_INDEX:undefined,currentPageZIndex:g?this.HIGHER_INDEX:undefined})}},_silentSlideBack:function(a){var c=this._getQueueIndex(a);a=this._queue.slice(c+1,this._queue.length);this._queue.splice(c+1,a.length);var d=a.length;for(c=0;c<d;c++){var e=a[c];e.setTranslateDuration(0);e.translate("100%");e.setPosition(1);this.transitionType!=this._TRANSITION_DEFAULT&&e.setZIndex(this.LOWER_INDEX)}this._firstPage=this._currentPage;this.slideBack()},_slideStart:function(a){this._isSliding=
true;b.publish("/slidingpanels/events/slidestart",{id:a.currentPage.id});this._currentPage=a.currentPage;a.firstPageZIndex&&a.firstPage.setZIndex(this.LOWER_INDEX);a.currentPageZIndex&&a.currentPage.setZIndex(this.HIGHER_INDEX);a.currentPage.display();a.firstPage.setTranslateDuration(a.firstPageDuration);a.currentPage.setTranslateDuration(a.currentPageDuration);b.fx.onTransitionEnd(a.pageToListen.getDomNode(),a.slideEndHandler);a.firstPage.translate(a.firstPageTranslation,0);a.currentPage.translate(0)},
_onSlideEnd:function(a){var c=this._firstPage,d=this._currentPage;if(this.transitionType!=this._TRANSITION_DEFAULT){c.setZIndex(this.LOWER_INDEX);d.setZIndex(this.HIGHER_INDEX)}c.setPosition(a);d.setPosition(0);a==-1&&this._queue.push(c);this._firstPage=this._currentPage;this._isSliding=false;b.publish("/slidingpanels/events/slideend",{id:d.id})},_getPageById:function(a){var c,d=this._pagesList,e=d.length;for(c=0;c<e;c++){var g=d[c];if(g.id==a&&g.position==1)return g}return null},_getQueueIndex:function(a){var c,
d=this._queue,e=d.length;for(c=0;c<e;c++)if(d[c].id==a)return c;return false},_validateProperties:function(){return true},_initProperties:function(){var a=this.transitionType,c,d=this.pages,e=d.length;for(c=0;c<e;c++){var g=new b.ui.layout.SlidingPanels.Page({node:$(d[c])});if(c==0){g.translate(0);g.setPosition(0);this._firstPage=g}else{var f="100%";if(a==this._TRANSITION_REVEAL)f=0;g.translate(f);g.setPosition(1)}if(a!=this._TRANSITION_DEFAULT)c==0?g.setZIndex(this.HIGHER_INDEX):g.setZIndex(this.LOWER_INDEX);
f=g.getDomNode();f.parentNode.removeChild(f);this._domNode.appendChild(f);this._pagesList.push(g)}if(b.isInteger(this.duration))this.duration+="ms"},_initDom:function(){this._domNode=document.createElement("div");b.addClass(this._domNode,"sl_container")}};b.ui.layout.SlidingPanels.Page=function(a){this.uId=b.getUId();this.id=null;this.position=0;this._properties=a;this._domNode=null;this._toDefer=this._isDisplayed=false;this._initProperties();this._initDom()};b.ui.layout.SlidingPanels.Page.prototype=
{wkArOldIOS:b.ua.isIOS&&b.ua.osVersion<=2,getDomNode:function(){return this._domNode},setPosition:function(a){this.position=a;if(this.position!=0){if(!this.wkArOldIOS){this._domNode.style.display="none";this._isDisplayed=false}}else b.fx.apply(this._domNode,{transform:"none"})},display:function(){this._domNode.style.display="block";if(this._isDisplayed==false)this._toDefer=this._isDisplayed=true},translate:function(a){var c,d={defered:b.bind(function(){c&&clearTimeout(c);this._domNode.translate(a,
null)},this)};if(this._toDefer){c=b.setTimeout(d,"defered",0);this._toDefer=false}else d.defered()},setZIndex:function(a){this._domNode.style.zIndex=a},setTranslateDuration:function(a){b.fx.applyTransformTransition(this._domNode,a,"1ms","default")},_initDom:function(){b.addClass(this._domNode,"sl_page")},_initProperties:function(){this._domNode=this._properties.node;this.id=this._domNode.id}};return b.ui.layout.SlidingPanels});
define(["../../../../_amd/core"],function(b){b.ui.layout.TabContainer=function(a){this.uId=b.getUId();this.displayArrows=1;this.firstSelectedTab=0;this.tabs=undefined;this._NEAREST_DURATION=this._NEXT_DURATION=200;this._tabsIdsList=[];this._tabsList=[];this._rightArrowNode=this._leftArrowNode=this._itemsNode=this._moveableNode=this._tabsNode=this._domNode=null;this._moveableAreaSize=this._visibleAreaSize=0;this._timerResizer=null;this._startPosition=this._currentPosition=this._currentItem=0;this._selectedItem=
this._selectingItem=null;this._tracking=this._dragging=false;this._lastTouch=this._currentTouch=this._firstTouch=null;b.mixin(this,a);if(this._validateProperties()!==false){this._initDom();this._initControler();this._initProperties()}};b.ui.layout.TabContainer.prototype={addTab:function(a){if(a.contentNode.id=="")a.contentNode.id=b.getUId();var c=this._tabsList.length,d=new b.ui.layout.TabContainer.Tab({contentNode:a.contentNode,title:a.title});d.index=c;this._moveableNode.appendChild(d.getTabNode());
this._domNode.appendChild(d.getContentNode());this._tabsList.push(d);this._tabsIdsList.push(a.contentNode.id);d.getTabNode().onclick=b.bind(this._handleItemClick,this,a.contentNode.id);if(this._timerResizer==null)this._timerResizer=b.setTimeout(this,"_updateSizes",100);return a.contentNode.id},removeTab:function(a){var c=this._tabsList.length;if(c!=1)for(var d=0;d<c;d++)if(this._tabsList[d].id==a){this._moveableAreaSize-=this._tabsList[d].itemSize;this._moveableNode.removeChild(this._tabsList[d].getTabNode());
this._domNode.removeChild(this._tabsList[d].getContentNode());if(this._tabsList[d]==this._selectedItem)d==0?this._displayTab(this._tabsList[d+1]):this._displayTab(this._tabsList[d-1]);this._tabsList[d].getTabNode().onclick=null;delete this._tabsList[d].getTabNode();delete this._tabsList[d].getContentNode();this._tabsList.splice(d,1);this._tabsIdsList.splice(d,1);if(this._currentItem>this._tabsList.length-1)this._currentItem=this._tabsList.length-1;if(this._timerResizer==null)this._timerResizer=b.setTimeout(this,
"_updateSizes",100);this._goToLast();return}},selectTab:function(a){for(var c=this._tabsList.length,d=0;d<c;d++)if(this._tabsList[d].id==a){this._currentItem=d;this._translateTo(this._tabsList[d].position,this._NEXT_DURATION);this._goToLast();this._displayTab(this._tabsList[d]);return}},getDomNode:function(){return this._domNode},_displayTab:function(a){this._selectedItem!=null&&this._selectedItem.deactivate();this._selectedItem=a;this._selectedItem.activate()},_handleTouchStart:function(a){this._tracking=
true;this._dragging=false;this._firstTouch=a;this._startPosition=this._currentPosition},_handleTouchMove:function(a){if(this._tracking!=false){this._dragging=true;this._currentTouch=a;this._translateTo(this._startPosition-(this._currentTouch.x-this._firstTouch.x),0);this._isWhollyVisible(this._tabsList.length-1)}},_handleTouchEnd:function(a){if(this._tracking!=false){this._dragging=this._tracking=false;this._lastTouch=a;this._backToNearestItem();this._selectingItem=null}},_handleLeftArrowPressed:function(){b.addClass(this._leftArrowNode,
"tc_pressed")},_handleRightArrowPressed:function(){b.addClass(this._rightArrowNode,"tc_pressed")},_handleLeftArrowUnpressed:function(){b.removeClass(this._leftArrowNode,"tc_pressed")},_handleRightArrowUnpressed:function(){b.removeClass(this._rightArrowNode,"tc_pressed")},_handleLeftArrowClicked:function(){this._next()},_handleRightArrowClicked:function(){this._previous()},_translateTo:function(a,c){b.fx.applyTransformTransition(this._moveableNode,c+"ms","0ms","default");this._currentPosition=a;this._moveableNode.translate(-this._currentPosition)},
_handleItemClick:function(a){for(var c=this._tabsList.length,d=0;d<c;d++)if(this._tabsList[d].id==a){this._selectingItem=this._tabsList[d];this._displayTab(this._selectingItem);b.publish("/tabcontainer/events/tabselected",{id:this._selectingItem.id});break}},_isWhollyVisible:function(a){var c=this._tabsList[a].position;a=c+this._tabsList[a].size;if(c>=this._currentPosition&&a<=this._currentPosition+this._visibleAreaSize)return true;return false},_backToNearestItem:function(){var a=this._getNearestItem();
this._translateTo(a.position,this._NEAREST_DURATION);this._currentItem=a.index;this._goToLast()},_getNearestItem:function(){for(var a=null,c=Number.MAX_VALUE,d=0;d<this._tabsList.length;d++){var e=Math.abs(this._currentPosition-this._tabsList[d].position);if(e<=c){c=e;a=d}else break}return this._tabsList[a]},_goToLast:function(){if(this._tabsList[this._tabsList.length-1].position+this._tabsList[this._tabsList.length-1].size<this._visibleAreaSize)this._goToFirst();else{var a=this._isWhollyVisible(this._tabsList.length-
1);if(this._tabsList.length>1&&a){a=this._tabsList[this._tabsList.length-1];this._translateTo(a.position+a.size-this._visibleAreaSize,this._NEAREST_DURATION);this._currentItem=a.index;return true}}},_goToFirst:function(){this._translateTo(this._tabsList[0].position,this._NEAREST_DURATION)},_next:function(){if(!(this._currentItem>=this._tabsList.length-1)){this._currentItem++;this._translateTo(this._tabsList[this._currentItem].position,this._NEXT_DURATION);this._goToLast()}},_previous:function(){if(this._currentItem!=
0)if(this._currentItem==this._tabsList[this._tabsList.length-1].index)this._previousUntilNoLast();else{this._currentItem--;this._translateTo(this._tabsList[this._currentItem].position,this._NEXT_DURATION);this._goToLast()}},_previousUntilNoLast:function(){for(;this._isWhollyVisible(this._tabsList.length-1);){if(this._currentItem==0)return;this._currentItem--;this._translateTo(this._tabsList[this._currentItem].position,this._NEXT_DURATION);if(this._tabsList[this._tabsList.length-1].position+this._tabsList[this._tabsList.length-
1].size<this._visibleAreaSize)return}},_updateSizes:function(){if(this._timerResizer!=null){clearTimeout(this._timerResizer);this._timerResizer=null}this._moveableAreaSize=0;this._visibleAreaSize=this._tabsNode.offsetWidth-(this._leftArrowNode.offsetWidth+this._rightArrowNode.offsetWidth);for(var a=0;a<this._tabsList.length;a++){this._tabsList[a].updateMaxWidth(this._visibleAreaSize-60);this._tabsList[a].size=this._tabsList[a].getTabNode().offsetWidth;this._tabsList[a].position=this._moveableAreaSize;
this._moveableAreaSize+=this._tabsList[a].size}this._moveableNode.style.width=this._moveableAreaSize+"px"},_validateProperties:function(){return true},_initProperties:function(){for(var a=this.tabs.length,c=0;c<a;c++){var d=$(this.tabs[c]).getElementsByClassName("tc_title")[0];if(b.isUndefined(d))d="no title";else{$(this.tabs[c]).removeChild(d);d=d.innerHTML}this.addTab({contentNode:$(this.tabs[c]),title:d})}b.setTimeout(this,"selectTab",100,this.tabs[this.firstSelectedTab])},_initControler:function(){b.ux.touch.addListener(this._leftArrowNode,
"start",{context:this,method:"_handleLeftArrowPressed",arguments:null},{preventDefault:false});b.ux.touch.addListener(this._rightArrowNode,"start",{context:this,method:"_handleRightArrowPressed",arguments:null},{preventDefault:false});b.ux.touch.addListener(this._moveableNode,"start",{context:this,method:"_handleTouchStart",arguments:null},{preventDefault:false});b.ux.touch.addListener(this._moveableNode,"move",{context:this,method:"_handleTouchMove",arguments:null},{preventDefault:false});b.ux.touch.addListener(this._leftArrowNode,
"end",{context:this,method:"_handleLeftArrowUnpressed",arguments:null},{preventDefault:false});b.ux.touch.addListener(this._rightArrowNode,"end",{context:this,method:"_handleRightArrowUnpressed",arguments:null},{preventDefault:false});b.ux.touch.addListener(this._moveableNode,"end",{context:this,method:"_handleTouchEnd",arguments:null},{preventDefault:false});this._rightArrowNode.onclick=b.bind(this._handleRightArrowClicked,this);this._leftArrowNode.onclick=b.bind(this._handleLeftArrowClicked,this);
window.addEventListener("orientationchange",b.bind(function(){this._updateSizes();this._goToLast()},this),false)},_initDom:function(){this._domNode=document.createElement("div");this._domNode.className="w_box w_border_bottom";this._tabsNode=document.createElement("div");this._itemsNode=document.createElement("div");this._moveableNode=document.createElement("div");this._leftArrowNode=document.createElement("div");this._leftArrow=document.createElement("div");this._rightArrowNode=document.createElement("div");
this._rightArrow=document.createElement("div");if(this.displayArrows==0){this._leftArrowNode.style.display="none";this._rightArrowNode.style.display="none";this._itemsNode.style.left="0px"}this._leftArrowNode.appendChild(this._leftArrow);this._rightArrowNode.appendChild(this._rightArrow);this._itemsNode.appendChild(this._moveableNode);this._tabsNode.appendChild(this._leftArrowNode);this._tabsNode.appendChild(this._itemsNode);this._tabsNode.appendChild(this._rightArrowNode);this._domNode.appendChild(this._tabsNode);
b.addClass(this._tabsNode,"w_tabs w_border_bottom");b.addClass(this._itemsNode,"tc_tabs_items");b.addClass(this._moveableNode,"tc_tabs_moveable");b.addClass(this._leftArrowNode,"tc_arrow w_bg_dark");b.addClass(this._leftArrow,"w_icon w_button_previous");b.addClass(this._rightArrowNode,"tc_arrow tc_right w_bg_dark");b.addClass(this._rightArrow,"w_icon w_button_next");b.fx.applyTransformTransition(this._moveableNode,"0ms","0ms","ease-out")}};b.ui.layout.TabContainer.Tab=function(a){this.uId=b.getUId();
this.id=null;this.position=this.size=this.index=0;this._title=a.title;this._contentNode=a.contentNode;this._tabNode=null;this._initProperties();this._initDom()};b.ui.layout.TabContainer.Tab.prototype={getContentNode:function(){return this._contentNode},getTabNode:function(){return this._tabNode},activate:function(){b.removeClass(this._tabNode,"w_bg_light");b.addClass(this._tabNode,"w_bg_dark");b.addClass(this._tabNode,"tc_on");b.addClass(this._contentNode,"tc_on")},deactivate:function(){b.removeClass(this._contentNode,
"tc_on");b.removeClass(this._tabNode,"tc_on");b.removeClass(this._tabNode,"w_bg_dark");b.addClass(this._tabNode,"w_bg_light")},updateMaxWidth:function(a){this._tabNode.style.maxWidth=a+"px"},_initDom:function(){this._tabNode=document.createElement("div");this._tabNode.innerHTML=this._title;b.addClass(this._contentNode,"w_bloc tc_bloc");b.addClass(this._tabNode,"w_tab w_border w_radius_top_left w_radius_top_right w_bg_light")},_initProperties:function(){this.id=this._contentNode.id}};return b.ui.layout.TabContainer});
define(["../../../../_amd/core","../../../../ux/movementtracker/js/movementtracker"],function(b){b.ui.layout.ModalWindow=function(a){this.uId=b.getUId();this.iconView={x:0,y:0,refX:0,refY:0,sizeX:0,sizeY:0,image:null};this.modalView={x:0,y:0,sizeX:0,sizeY:0,content:null};this.displayDuration=0;this.canDrag=false;this._currentDuration=this._dragging=this._showed=this._movementtracker=this._scaleY=this._scaleX=this._modalCloseNode=this._modalContentNode=this._modalNode=this._iconImgNode=this._iconNode=
this._domNode=null;b.mixin(this,a);if(this._validateProperties()!==false){this._initProperties();this._initDom();this._initListeners()}};b.ui.layout.ModalWindow.prototype={_Z_INDEX_BACKGROUND:1,_TRANSITION_FUNC:"default",getDomNode:function(){return this._domNode},shiftCloseNode:function(a,c){this._modalCloseNode.translate(a,c,true)},_validateProperties:function(){return true},_raisePropertyError:function(a){b.log("[ModalWindow] Error: "+a+" missing or invalid")},_initProperties:function(){this._dragging=
this._showed=false},_initDom:function(){this._domNode=document.createElement("div");this._iconNode=document.createElement("div");this._iconImgNode=document.createElement("img");this._modalNode=document.createElement("div");this._modalCloseNode=document.createElement("div");this._modalContentNode=$(this.modalView.content);b.addClass(this._iconNode,"w_icon");b.addClass(this._modalNode,"w_box w_window w_bloc w_border w_radius w_bg_dark");b.addClass(this._modalCloseNode,"w_icon w_float w_button_close");
b.fx.apply(this._domNode,{"user-select":"none",position:"absolute",width:this.modalView.sizeX+"px",height:this.modalView.sizeY+"px"});b.fx.apply(this._iconNode,{position:"absolute",width:"100%",height:"100%"});b.fx.apply(this._iconImgNode,{width:"100%",height:"100%"});b.fx.apply(this._modalNode,{position:"absolute",width:this.modalView.sizeX+"px",height:this.modalView.sizeY+"px"});b.fx.apply(this._modalCloseNode,{top:"0px",left:"0px"});this._modalCloseNode.translate(-20,-20,true);this._modalNode.translate(0,
0,true);this._iconNode.appendChild(this._iconImgNode);this._modalNode.appendChild(this._modalContentNode);this._domNode.appendChild(this._modalCloseNode);this._domNode.appendChild(this._iconNode);this._domNode.appendChild(this._modalNode);this._iconImgNode.src=this.iconView.image;this._hide()},_initListeners:function(){this._movementtracker=new b.ux.MovementTracker({target:this._domNode});b.subscribe("/movementtracker/events/mvtBegin",{context:this,method:"_handleMovementBegin"});b.subscribe("/movementtracker/events/mvtChanged",
{context:this,method:"_handleMovementChanged"});b.subscribe("/movementtracker/events/mvtStored",{context:this,method:"_handleMovementStored"});b.ux.touch.addListener(this._modalCloseNode,"start",{context:this,method:"_handleClick"},{preventDefault:true})},_handleClick:function(){this._closing=true},_handleMovementBegin:function(a){if(a.publisher.uId==this._movementtracker.uId){this._dragging=false;this._applyTransitions(0)}},_handleMovementChanged:function(a){if(a.publisher.uId==this._movementtracker.uId)if(this._showed!=
true){this._dragging=true;if(this.canDrag==true){var c=a.movement;a=c.pointStatement[c.pointStatement.length-2];c=c.pointStatement[c.pointStatement.length-1];var d=c.y-a.y;this._moveIcon(this.iconView.x+b.math.round(c.x-a.x,0),this.iconView.y+b.math.round(d,0))}}},_handleMovementStored:function(a){if(a.publisher.uId==this._movementtracker.uId)if(this._closing==true){this._hide();this._closing=false}else this._showed==false&&this._dragging==false&&this._show()},_show:function(){this._showed=true;this._applyTransitions(this.displayDuration);
this._iconNode.style.opacity=0;this._modalCloseNode.style.opacity=1;this._modalNode.style.opacity=1;this._enlarge();this._orderAll()},_hide:function(){this._showed=false;this._applyTransitions(this.displayDuration);this._iconNode.style.opacity=1;this._modalCloseNode.style.opacity=0;this._modalNode.style.opacity=0;this._iconize();this._orderAll()},_enlarge:function(){this._domNode.scale(1,1);this._domNode.translate(this.modalView.x,this.modalView.y)},_iconize:function(){this._scaleX=b.math.round(this.iconView.sizeX/
this.modalView.sizeX,2);this._scaleY=b.math.round(this.iconView.sizeY/this.modalView.sizeY,2);this.iconView.refX=-(this.modalView.sizeX/2)+this.iconView.sizeX/2;this.iconView.refY=-(this.modalView.sizeX/2)+this.iconView.sizeX/2;this._domNode.scale(this._scaleX,this._scaleY);this._moveIcon(this.iconView.x,this.iconView.y)},_moveIcon:function(a,c){this.iconView.x=a;this.iconView.y=c;this._domNode.translate(this.iconView.x+this.iconView.refX,this.iconView.y+this.iconView.refY)},_orderAll:function(){var a=
this._Z_INDEX_BACKGROUND;if(this._showed==false){this._domNode.style.zIndex=a;this._iconNode.style.zIndex=a+1;this._modalNode.style.zIndex=a;this._modalCloseNode.style.zIndex=a}else{this._domNode.style.zIndex=a+1;this._iconNode.style.zIndex=a+1;this._modalNode.style.zIndex=a+2;this._modalCloseNode.style.zIndex=a+3}},_applyTransitions:function(a){if(a!=this._currentDuration){b.fx.applyTransformTransition(this._domNode,a+"ms","0ms",this._TRANSITION_FUNC);b.fx.applyTransition(this._iconNode,"opacity",
a+"ms","0ms",this._TRANSITION_FUNC);b.fx.applyTransition(this._modalNode,"opacity",a+"ms","0ms",this._TRANSITION_FUNC);this._currentDuration=a}}};return b.ui.layout.ModalWindow});
define(["../../../../_amd/core","../../../../math/_geometric/js/geometric","../../../../fx/_xyz/js/3dfx","../../../../fx/_animation/js/animation"],function(b){b.ui.layout.FlipPage=function(a){this.uId=b.getUId();this.Z_INDEX=999;this.pages=[];this.duration=1500;this.shadow=false;this._pagesList=[];this._currentPage=this._flipTimeout=null;this._endTime=this._startTime=this._endY=this._endX=this._startY=this._startX=this._currentPageIndex=0;this._rightShadowNode=this._leftShadowNode=this._domNode=null;
this._shadeState=false;b.mixin(this,a);if(this._validateProperties()!==false){this._initDom();this._initProperties();this._initListeners()}};b.ui.layout.FlipPage.prototype={wkArMove:b.ua.isIOS&&b.ua.osVersion==4||b.ua.isIPad,getDomNode:function(){return this._domNode},flipTo:function(a){clearTimeout(this._flipTimeout);for(var c=this.pages.length,d=0;d<c;d++)if(a==this.pages[d])if(this._currentPageIndex<d){this.flipForward();this._flipTimeout=b.setTimeout(this,"flipTo",300,a)}else if(this._currentPageIndex>
d){this.flipBack();this._flipTimeout=b.setTimeout(this,"flipTo",300,a)}else return},flipForward:function(){if(this._currentPageIndex<this._pagesList.length-2){this._currentPageIndex++;this._pagesList[this._currentPageIndex].setPosition(0);this._currentPage=this._pagesList[this._currentPageIndex];b.publish("/flippage/events/flipstart",{id:this.pages[this._currentPageIndex],direction:1});this.shadow&&this._shade(this._rightShadowNode,this._leftShadowNode)}},flipBack:function(){if(this._currentPageIndex!=
0){this._pagesList[this._currentPageIndex].setPosition(1);this._currentPageIndex--;this._currentPage=this._pagesList[this._currentPageIndex];b.publish("/flippage/events/flipstart",{id:this.pages[this._currentPageIndex],direction:-1});this.shadow&&this._shade(this._leftShadowNode,this._rightShadowNode)}},updateContent:function(a,c){for(var d=this.pages.length,e=0;e<d;e++)if(a==this.pages[e]){this._pagesList[e].setBackContent(c);this._pagesList[e+1].setFrontContent(c)}},_touchStart:function(a){this._startX=
a.x;this._startY=a.y;this._startTime=a.timestamp},_touchMove:function(a){Math.abs(a.y-this._startY)<30&&a.preventDefault()},_touchEnd:function(a){this._endX=a.x;this._endY=a.y;this._endTime=a.timestamp;this._endTime-this._startTime>400||Math.abs(this._endY-this._startY)>30||Math.abs(this._endX-this._startX)<30||(this._endX-this._startX>0?this.flipBack():this.flipForward())},_shade:function(a,c){if(this._shadeState!=true){var d=this.duration,e=b.math.round(0.43*d,0),g=b.math.round(0.6*d,0);d=b.math.round(0.2*
d,0);e=b.fx.animate(null,{property:"background-color",value:"rgba(0, 0, 0, 0.9)",duration:0,delay:0},{start:false}).chain(b.fx.animate(null,{property:"background-color",value:"rgba(0, 0, 0, 0.0)",duration:e,delay:1,func:"default"},{start:false}));g=b.fx.animate(null,{property:"background-color",value:"rgba(0, 0, 0, 0.01)",duration:0,delay:0},{start:false}).chain(b.fx.animate(null,{property:"background-color",value:"rgba(0, 0, 0, 0.8)",duration:g,delay:d,func:"ease-in-out"},{start:false})).chain(b.fx.animate(null,
{property:"background-color",value:"rgba(0, 0, 0, 0.0)",duration:0,delay:0,func:"ease-in-out"},{start:false}));this._shadeState=true;d=new b.fx.animation.AnimationGroup;d.addAnimation(a,e);d.addAnimation(c,g);d.start({onEnd:{context:this,method:"_onShadeEnd"}})}},_onShadeEnd:function(){this._shadeState=false},_validateProperties:function(){return true},_initProperties:function(){for(var a=this.pages.length,c=0;c<=a;c++){if(c==0){var d=new b.ui.layout.FlipPage.Page({frontNode:null,backNode:$(this.pages[c]),
index:c,zIndex:this.Z_INDEX-c,duration:this.duration});d.setPosition(0);this._currentPage=d}else{d=c==a?new b.ui.layout.FlipPage.Page({frontNode:$(this.pages[c-1]),backNode:null,index:c,zIndex:this.Z_INDEX-c,duration:this.duration}):new b.ui.layout.FlipPage.Page({frontNode:$(this.pages[c-1]),backNode:$(this.pages[c]),index:c,zIndex:this.Z_INDEX-c});d.setPosition(1)}this._domNode.appendChild(d.getDomNode());b.fx.applyTransformTransition(d.getDomNode(),this.duration+"ms","0ms","ease-in-out");this._pagesList.push(d)}for(c=
0;c<a;c++)$(this.pages[c]).parentNode.removeChild($(this.pages[c]));if(this.shadow){this._leftShadowNode=document.createElement("div");this._rightShadowNode=document.createElement("div");b.addClass(this._leftShadowNode,"fb_page");b.addClass(this._rightShadowNode,"fb_page");this._leftShadowNode.translate("-100%",0);this._rightShadowNode.translate(0,0);this._leftShadowNode.style.backgroundColor="rgba(0, 0, 0, 0.0)";this._rightShadowNode.style.backgroundColor="rgba(0, 0, 0, 0.0)";this._domNode.appendChild(this._leftShadowNode);
this._domNode.appendChild(this._rightShadowNode)}},_initListeners:function(){b.ux.touch.addListener(this._domNode,"start",{context:this,method:"_touchStart"});this.wkArMove||b.ux.touch.addListener(this._domNode,"move",{context:this,method:"_touchMove"});b.ux.touch.addListener(this._domNode,"end",{context:this,method:"_touchEnd"})},_initDom:function(){this._domNode=document.createElement("div");this._domNode.className="fb_container"}};b.ui.layout.FlipPage.Page=function(a){this.uId=b.getUId();this.index=
a.index;this.position=0;this.zIndex=a.zIndex;this._backId=this._frontId=null;this._frontContent=a.frontNode;this._backContent=a.backNode;this._domNode=this._backNode=this._frontNode=null;this._initDom()};b.ui.layout.FlipPage.Page.prototype={getDomNode:function(){return this._domNode},setFrontContent:function(a){this._frontNode.innerHTML='<div class="fb_content_right">'+a+"</div>"},setBackContent:function(a){this._backNode.innerHTML='<div class="fb_content_left">'+a+"</div>"},setPosition:function(a){this.position=
a;b.fx.initComposedTransform(this._domNode,false);if(this.position==0){b.fx.setTransformPart(this._domNode,1,{type:"rotate",x:0,y:1,z:0,angle:180});this._domNode.style.zIndex=1E3-this.zIndex}else{b.fx.setTransformPart(this._domNode,1,{type:"rotate",x:0,y:1,z:0,angle:0});this._domNode.style.zIndex=this.zIndex}b.fx.applyComposedTransform(this._domNode)},_initDom:function(){this._domNode=document.createElement("div");b.addClass(this._domNode,"fb_page");b.fx.apply(this._domNode,{"transform-origin":"0 0",
"transform-style":"preserve-3d"});this._domNode.style.zIndex=this.zIndex;this._frontNode=document.createElement("div");b.isNull(this._frontContent)?this._frontNode.innerHTML='<div class="fb_content_right"></div>':this._frontNode.innerHTML='<div class="fb_content_right">'+this._frontContent.innerHTML+"</div>";this._frontNode.className="fb_content_front";this._backNode=document.createElement("div");b.isNull(this._backContent)?this._backNode.innerHTML='<div class="fb_content_left"></div>':this._backNode.innerHTML=
'<div class="fb_content_left">'+this._backContent.innerHTML+"</div>";this._backNode.className="fb_content_back";this._domNode.appendChild(this._frontNode);this._domNode.appendChild(this._backNode);var a=b.bind(function(){this.position==0?b.publish("/flippage/events/flipend",{id:this._backId}):b.publish("/flippage/events/flipend",{id:this._frontId})},this);b.fx.onTransitionEnd(this._domNode,a,true);b.isNull(this._frontContent)?this._frontId="":this._frontId=this._frontContent.id;b.isNull(this._backContent)?
this._backId="":this._backId=this._backContent.id}};return b.ui.layout.FlipPage});
define(["../../../../_amd/core","../../../../math/_geometric/js/geometric","../../../../fx/_xyz/js/3dfx","../../../../fx/_animation/js/animation"],function(b){b.ui.layout.Windows=function(a){this.uId=b.getUId();this.pages=null;this.duration=800;this._domNode=null;this._pagesList=[];this._firstPage=null;b.mixin(this,a);if(this._validateProperties()!==false){this._initDom();this._initProperties()}};b.ui.layout.Windows.prototype={getDomNode:function(){return this._domNode},slideTo:function(a){var c=
this._firstPage;a=this._getPageById(a);if(!(a==null||a==c)){var d=new b.fx.animation.AnimationGroup,e=new b.fx.animation.Animation,g=new b.fx.animation.Animation,f=[{type:"translate",x:-40*c.position,y:40*c.position,z:-50+c.position},{type:"rotate",x:0,y:1,z:0,angle:-20}],h=[{type:"translate",x:-document.documentElement.offsetWidth-100,y:40*a.position,z:-50+a.position},{type:"rotate",x:0,y:1,z:0,angle:-20}];e.addStep({property:"transform",value:{context:this,method:"_transform",arguments:[[{type:"translate",
x:document.documentElement.offsetWidth+100,y:0,z:-50+c.position},{type:"rotate",x:0,y:1,z:0,angle:-20}]]},duration:this.duration,delay:0,func:"default"});e.addStep({property:"transform",value:{context:this,method:"_transform",arguments:[f]},duration:this.duration,delay:0,func:"default"});g.addStep({property:"transform",value:{context:this,method:"_transform",arguments:[h]},duration:this.duration,delay:0,func:"default"});g.addStep({property:"transform",value:{context:this,method:"_transform",arguments:[[{type:"translate",
x:0,y:0,z:0},{type:"rotate",x:0,y:1,z:0,angle:0}]]},duration:this.duration,delay:0,func:"default"});d.addAnimation(c.getDomNode(),e);d.addAnimation(a.getDomNode(),g);d.start({onEnd:{context:this,method:"_slideEnd"}});this._firstPage=a;b.publish("/windows/events/slidestart",{id:a.id})}},_transform:function(a,c){var d=a.node;b.fx.initComposedTransform(d);for(var e=0;e<c.length;e++)b.fx.setTransformPart(d,e+1,c[e]);b.fx.applyComposedTransform(d)},_slideEnd:function(){b.publish("/windows/events/slideend",
{id:this._firstPage.id})},_getPageById:function(a){var c,d=this._pagesList,e=d.length;for(c=0;c<e;c++){var g=d[c];if(g.id==a)return g}return null},_validateProperties:function(){return true},_initProperties:function(){var a,c=this.pages,d=c.length;for(a=0;a<d;a++){if(a==0){var e=new b.ui.layout.Windows.Page({node:$(c[a]),position:d-1-a,front:true});this._firstPage=e}else e=new b.ui.layout.Windows.Page({node:$(c[a]),position:d-1-a});var g=e.getDomNode();g.parentNode.removeChild(g);this._domNode.appendChild(g);
this._pagesList.push(e)}},_initDom:function(){this._domNode=document.createElement("div");b.addClass(this._domNode,"wi_container");b.fx.apply(this._domNode,{perspective:"1000","transform-style":"preserve-3d"})}};b.ui.layout.Windows.Page=function(a){this.uId=b.getUId();this.node=this.id=null;this.position=0;b.mixin(this,a);this._initProperties();this._initDom()};b.ui.layout.Windows.Page.prototype={getDomNode:function(){return this.node},_initDom:function(){b.addClass(this.node,"wi_page");b.fx.apply(this.node,
{"transform-origin":"300% 100%"});if(!this.front){b.fx.initComposedTransform(this.node);b.fx.setTransformPart(this.node,1,{type:"translate",x:-40*this.position,y:40*this.position,z:-50+this.position});b.fx.setTransformPart(this.node,2,{type:"rotate",x:0,y:1,z:0,angle:-20});b.fx.applyComposedTransform(this.node)}},_initProperties:function(){this.id=this.node.id}};return b.ui.layout.Windows});
define(["../../../../_amd/core"],function(b){b.ui.form.Input=function(a){this.uId=b.getUId();this.inputNode=null;this.type=this._TEXT;this.width=250;this.autoCapitalize=this.autoCorrect=this.eraseButton=1;this.pattern=this.placeholder=this.defaultValue="";this._eraseNode=this._domNode=null;this._focusHandler=b.bind(this._handleFocus,this);this._blurHandler=b.bind(this._handleBlur,this);this._keyHandler=b.bind(this._handleKey,this);b.mixin(this,a);if(this._validateProperties()!==false){this._initDom();
this._initListeners()}};b.ui.form.Input.prototype={_TEXT:"text",_PASSWORD:"password",_NUMBER:"number",_TEL:"tel",_EMAIL:"email",_URL:"url",getDomNode:function(){return this._domNode},_handleFocus:function(){if(this.inputNode.value!="")this._eraseNode.style.display="block"},_handleBlur:function(){this._eraseNode.style.display="none"},_handleKey:function(){this._eraseNode.style.display=this.inputNode.value!=""?"block":"none"},_handleTouchStart:function(){this.inputNode.value="";this.inputNode.focus();
this._eraseNode.style.display="none"},_validateProperties:function(){return true},_initListeners:function(){b.ux.touch.addListener(this._eraseNode,"start",{context:this,method:"_handleTouchStart",arguments:null},{preventDefault:true})},_initDom:function(){this._domNode=document.createElement("div");this._eraseNode=document.createElement("div");this._domNode.className="w_search w_border w_radius";this._eraseNode.className="in_erase";this._domNode.style.width=this.width+"px";this.inputNode=document.createElement("input");
this.inputNode.className="w_input";this.inputNode.type=this.type;this.inputNode.autocorrect=this.autoCorrect;this.inputNode.autocapitalize=this.autoCapitalize;this.inputNode.placeholder=this.placeholder;this.inputNode.value=this.defaultValue;this.inputNode.addEventListener("focus",this._focusHandler,false);this.inputNode.addEventListener("blur",this._blurHandler,false);this.inputNode.addEventListener("keyup",this._keyHandler,false);this.inputNode.style.width=this.width-30+"px";this._domNode.appendChild(this.inputNode);
this._domNode.appendChild(this._eraseNode)}};return b.ui.form.Input});
define(["../../../../_amd/core"],function(b){b.ui.xy.Carousel=function(a){this.uId=b.getUId();this.items=[];this.firstItemIndex=1;this.itemsWidth=250;this.itemsHeight=100;this.display=this._HORIZONTAL_POSITION;this.containerWidth=window.innerWidth;this.containerHeight=null;this.autoAdjust=this.displayDots=1;this.autoAdjustDuration=800;this.autoPlay=0;this.autoPlayDuration=3E3;this.itemsAlign=this._CENTER_POSITION;this.touchPropagation=true;this._maxXY=this._minXY=this._cD=this._iD=this._position=
this._currentXY=this._beginXY=this._containerWidthSet=this._currentItemIndex=0;this._autoPlayInterval=null;this._autoPlayDirection=1;this._endEvent=this._startEvent=null;this._itemsList=[];this._dotsList=[];this._footerNode=this._dotsNode=this._itemsNode=this._headerNode=this._domNode=null;b.mixin(this,a);if(this._validateProperties()!==false){if(b.isSet(a.containerWidth))this._containerWidthSet=1;this._initProperties();this._initDom();this._positionItems();this._initListeners()}};b.ui.xy.Carousel.prototype=
{_LEFT_POSITION:"left",_CENTER_POSITION:"center",_VERTICAL_POSITION:"vertical",_HORIZONTAL_POSITION:"horizontal",getDomNode:function(){return this._domNode},clean:function(){for(var a=0;a<this._itemsList.length;a++)this._itemsList[a].getDomNode().innerHTML="";this._domNode.innerHTML=""},goToItem:function(a){for(var c=this._itemsList.length,d=0;d<c;d++)this._itemsList[d].position=this.itemsAlign==this._CENTER_POSITION?(d-a)*this._iD+(this._cD-this._iD)/2:(d-a)*this._iD;this.position=(this.firstItemIndex-
a)*this._iD;b.fx.apply(this._itemsNode,{"transition-duration":this.autoAdjustDuration+"ms","transition-timing-function":"ease-out"});this._currentXY=(this.firstItemIndex-a)*this._iD;this.display==this._HORIZONTAL_POSITION?this._itemsNode.translate((this.firstItemIndex-a)*this._iD,0):this._itemsNode.translate(0,(this.firstItemIndex-a)*this._iD);this._currentItemIndex=a;this._selectItem(this._currentItemIndex);b.publish("/carousel/events/switch",{carouselId:this.uId,currentItemIndex:this._currentItemIndex})},
refreshContainerWidth:function(a){this._setContainerWidth(a);this._setMinMaxValues()},_addItem:function(a,c,d){if(a=="node")a=c;else{a=document.createElement("div");a.innerHTML=c}this._itemsList.push(new b.ui.xy.Carousel.Item({width:this.itemsWidth,height:this.itemsHeight,node:a,index:d-this.firstItemIndex}))},_touchStart:function(a){this._startEvent=a;a=this.display==this._HORIZONTAL_POSITION?a.x:a.y;this.touchPropagation==false&&this._startEvent.stopPropagation();if(this._autoPlayInterval!=null){clearInterval(this._autoPlayInterval);
this._autoPlayInterval=null}this._beginXY=a;b.fx.apply(this._itemsNode,{"transition-duration":"","transition-timing-function":""})},_touchMove:function(a){a=this.display==this._HORIZONTAL_POSITION?a.x:a.y;if(!(this.autoAdjust==0&&(this._currentXY+a-this._beginXY>this._minXY||this._currentXY+a-this._beginXY<this._maxXY))){for(var c=this._itemsList.length,d=0;d<c;d++)this._itemsList[d].position=this._itemsList[d].beginXY+a-this._beginXY;this.position=this._currentXY+a-this._beginXY;this.display==this._HORIZONTAL_POSITION?
this._itemsNode.translate(this.position,0):this._itemsNode.translate(0,this.position)}},_touchEnd:function(a){this._endEvent=a;if(this.display==this._HORIZONTAL_POSITION){a=this._startEvent.x;var c=this._endEvent.x}else{a=this._startEvent.y;c=this._endEvent.y}if(this._endEvent.timestamp-this._startEvent.timestamp<250&&Math.abs(c-a)<20)this._endEvent.dispatch(this._endEvent.target,"click");else{for(var d=this._itemsList.length,e=0;e<d;e++)this._itemsList[e].beginXY=this._itemsList[e].position;var g=
this.itemsAlign==this._CENTER_POSITION?Math.abs(this._itemsList[0].beginXY-(this._cD-this._iD)/2):Math.abs(this._itemsList[0].beginXY),f=0;for(e=0;e<d;e++){if(this._currentItemIndex==0)if(c-a<0){f=this._itemsList.length==1?0:1;break}if((this.itemsAlign==this._CENTER_POSITION?Math.abs(this._itemsList[e].beginXY-(this._cD-this._iD)/2):Math.abs(this._itemsList[e].beginXY))<g)if(e!=this._currentItemIndex){g=this.itemsAlign==this._CENTER_POSITION?Math.abs(this._itemsList[e].beginXY-(this._cD-this._iD)/
2):Math.abs(this._itemsList[e].beginXY);f=e}else if(this._currentItemIndex==d-1)if(c-a<0){f=e;break}}this._currentItemIndex=f;this._selectItem(this._currentItemIndex);b.publish("/carousel/events/switch",{carouselId:this.uId,currentItemIndex:this._currentItemIndex});if(this.autoAdjust==1){b.fx.apply(this._itemsNode,{"transition-duration":this.autoAdjustDuration+"ms","transition-timing-function":"ease-out"});this._currentXY=(this.firstItemIndex-f)*this._iD;this.display==this._HORIZONTAL_POSITION?this._itemsNode.translate((this.firstItemIndex-
f)*this._iD,0):this._itemsNode.translate(0,(this.firstItemIndex-f)*this._iD)}else if(!b.isUndefined(this.position))this._currentXY=this.position}},_selectItem:function(a){for(var c=this._itemsList.length,d=0;d<c;d++){this._itemsList[d].beginXY=this.itemsAlign==this._CENTER_POSITION?(d-a)*this._iD+(this._cD-this._iD)/2:(d-a)*this._iD;d==a?b.addClass(this._dotsList[d],"ca_selected"):b.removeClass(this._dotsList[d],"ca_selected")}},_positionItems:function(){for(var a=this._itemsList.length,c=0;c<a;c++){this._itemsList[c].position=
this.itemsAlign==this._CENTER_POSITION?this._itemsList[c].index*this._iD+(this._cD-this._iD)/2:this._itemsList[c].index*this._iD;this._itemsList[c].beginXY=this._itemsList[c].position;this.display==this._HORIZONTAL_POSITION?this._itemsList[c].getDomNode().translate(this._itemsList[c].position,0):this._itemsList[c].getDomNode().translate(this.itemsAlign==this._CENTER_POSITION?(this.containerWidth-this.itemsWidth)/2:0,this._itemsList[c].position)}},_updateItemsPosition:function(){if(this._containerWidthSet==
0){this.containerWidth=window.innerWidth;if(this.display==this._HORIZONTAL_POSITION)this._cD=window.innerWidth;for(var a=this._itemsList.length,c=0;c<a;c++)if(this.itemsAlign==this._CENTER_POSITION)this.display==this._HORIZONTAL_POSITION?this._itemsList[c].getDomNode().translate(this._itemsList[c].index*this._iD+(this._cD-this._iD)/2,0):this._itemsList[c].getDomNode().translate((this.containerWidth-this.itemsWidth)/2,this._itemsList[c].index*this._iD+(this._cD-this._iD)/2);else this.display==this._HORIZONTAL_POSITION?
this._itemsList[c].getDomNode().translate(this._itemsList[c].index*this._iD,0):this._itemsList[c].getDomNode().translate(0,this._itemsList[c].index*this._iD)}},_startAutoPlay:function(){if(this._currentItemIndex>=this._itemsList.length-1)this._autoPlayDirection=-1;if(this._currentItemIndex<=0)this._autoPlayDirection=1;this._autoPlayDirection==1?this.goToItem(this._currentItemIndex+1):this.goToItem(this._currentItemIndex-1)},_initListeners:function(){b.ux.touch.addListener(this._itemsNode,"start",
{context:this,method:"_touchStart",arguments:null},{preventDefault:true});b.ux.touch.addListener(this._itemsNode,"move",{context:this,method:"_touchMove",arguments:null},{preventDefault:true});b.ux.touch.addListener(this._itemsNode,"end",{context:this,method:"_touchEnd",arguments:null},{preventDefault:true});window.addEventListener("orientationchange",b.bind(function(){this._updateItemsPosition()},this),false)},_initDom:function(){this._domNode=document.createElement("div");this._domNode.className=
this.display==this._HORIZONTAL_POSITION?"ca_container":"ca_container ca_vertical";this._headerNode=document.createElement("div");this._headerNode.className="ca_header";this._itemsNode=document.createElement("div");this._itemsNode.className="ca_items";this._itemsNode.style.height=this.itemsHeight+"px";this._dotsNode=document.createElement("div");this._dotsNode.className="ca_dots";this._footerNode=document.createElement("div");this._footerNode.className="ca_footer";for(var a=this._itemsList.length,
c=0;c<a;c++){var d=document.createElement("img");d.src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==";d.className=c==this.firstItemIndex?"ca_dot ca_selected":"ca_dot";if(c==a-1)d.style.clear="both";this._dotsList.push(d);this._dotsNode.appendChild(d);this._itemsNode.appendChild(this._itemsList[c].getDomNode())}if(this.displayDots==0)this._dotsNode.style.display="none";this._setMinMaxValues();this._domNode.appendChild(this._headerNode);this._domNode.appendChild(this._itemsNode);
this._domNode.appendChild(this._dotsNode);this._domNode.appendChild(this._footerNode);if(this.autoPlay==1)this._autoPlayInterval=b.setInterval(this,"_startAutoPlay",this.autoPlayDuration)},_setContainerWidth:function(a){if(!b.isUndefined(a)){if(!b.isInteger(a)||a<0)return false;this.containerWidth=a;if(this.display==this._HORIZONTAL_POSITION)this._cD=a}},_setMinMaxValues:function(){if(this.autoAdjust==0){this._minXY=this.itemsAlign==this._CENTER_POSITION?this.firstItemIndex*this._iD-(this._cD-this._iD)/
2:this.firstItemIndex*this._iD;this._maxXY=this.itemsAlign==this._CENTER_POSITION?(this.firstItemIndex-this._itemsList.length)*this._iD+(this._cD+this._iD)/2:(this.firstItemIndex-this._itemsList.length)*this._iD+this._cD}},_validateProperties:function(){return true},_initProperties:function(){for(var a=this.items.length,c=0;c<a;c++)this._addItem(this.items[c].type,this.items[c].content,c);this._currentItemIndex=this.firstItemIndex;this.containerHeight=this.itemsHeight;if(this.display==this._HORIZONTAL_POSITION){this._iD=
this.itemsWidth;this._cD=this.containerWidth}else{this._iD=this.itemsHeight;this._cD=this.containerHeight}}};b.ui.xy.Carousel.Item=function(a){this.uId=b.getUId();this.index=a.index;this.width=a.width;this.height=a.height;this.position=this.beginXY=0;this._domNode=a.node;this._initDom()};b.ui.xy.Carousel.Item.prototype={getDomNode:function(){return this._domNode},_initDom:function(){b.addClass(this._domNode,"ca_item");b.fx.apply(this._domNode,{width:this.width+"px",height:this.height+"px"})}};return b.ui.xy.Carousel});
define(["../../../../_amd/core"],function(b){b.ui.xy.ColorPicker=function(){if(b.isUndefined(b.ui.xy.ColorPicker.singleton)){this.uId=1;this._HEIGHT=276;this._WIDTH=230;this._template="";this._domNode=null;this._colors=["#000","#9F3F0F","#0F3F0F","#0F3F6F","#0E0E85","#3F4F3F","#870F0F","#87870F","#0F870F","#0F8787","#0F0FFF","#6F6F9F","#FF0000","#FF9F0F","#9FC000","#3FCFCF","#3F6FFF","#9F9F9F","#FF0FFF","#FFCF0F","#FFFF00","#0FFF0F","#0FFFFF","#0FCFFF","#9F3F6F","#FF9FCF","#FFCF9F","#FFFF9F","#CF9FFF",
"#FFF"];this._createTemplate();this._initDom();b.ui.xy.ColorPicker.singleton=this}else return b.ui.xy.ColorPicker.singleton};b.ui.xy.ColorPicker.prototype={show:function(){b.layer.show();b.fx.apply(this._domNode,{display:"block"});this.updatePosition()},hide:function(){b.layer.hide();this._domNode.style.display="none"},updatePosition:function(){b.fx.apply(this._domNode,{top:window.innerHeight>this._HEIGHT?(window.innerHeight-this._HEIGHT)/2+window.scrollY+"px":window.scrollY+"px",left:document.documentElement.offsetWidth>
this._WIDTH?(document.documentElement.offsetWidth-this._WIDTH)/2+window.scrollX+"px":window.scrollX+"px"})},_createTemplate:function(){var a=0,c=this._colors.length;this._template+='<div><div class="w_icon w_float w_button_close" onClick="(new wink.ui.xy.ColorPicker()).hide()"></div>';for(var d=0;d<c;d++){if(a==0)this._template+='<div class="cp_separator">';this._template+='<div class="cp_color" style="background-color: '+this._colors[d]+'" onClick="(new wink.ui.xy.ColorPicker())._selectColor(\''+
this._colors[d]+"')\"></div>";if(a==4){this._template+="</div>";a=0}else a++}this._template+="</div>"},_selectColor:function(a){b.publish("/colorpicker/events/pickcolor",{color:a});this.hide()},_initDom:function(){this._domNode=document.createElement("div");this._domNode.className="w_bloc w_window cp_colorpicker w_border w_radius w_bg_dark";this._domNode.style.display="none";this._domNode.innerHTML=this._template;document.body.appendChild(this._domNode)}};return b.ui.xy.ColorPicker});
define(["../../../../_amd/core"],function(b){b.ui.xy.DatePicker=function(){if(b.isUndefined(b.ui.xy.DatePicker.singleton)){this.uId=1;this._HEIGHT=310;this._WIDTH=280;this._template="";this._domNode=null;this._firstDayOfMonth=new Date;this._firstDayOfWeek=_("firstDayOfWeek",this);this._week=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"];this._initDom();this._updateTemplate();b.ui.xy.DatePicker.singleton=this}else return b.ui.xy.DatePicker.singleton};b.ui.xy.DatePicker.prototype=
{i18n:{},show:function(){b.layer.show();b.fx.apply(this._domNode,{display:"block"});this.updatePosition()},hide:function(){b.layer.hide();this._domNode.style.display="none"},updatePosition:function(){b.fx.apply(this._domNode,{top:window.innerHeight>this._HEIGHT?(window.innerHeight-this._HEIGHT)/2+window.scrollY+"px":window.scrollY+"px",left:document.documentElement.offsetWidth>this._WIDTH?(document.documentElement.offsetWidth-this._WIDTH)/2+window.scrollX+"px":window.scrollX+"px"})},_updateTemplate:function(){this._template=
"";var a=new Date,c=new Date;c.setDate(1);this._firstDayOfMonth.setDate(1);this._template+="<div>";this._template+='<div class="dp_navigation"><div class="w_icon w_button_previous dp_previous" onclick="(new wink.ui.xy.DatePicker())._goToPreviousMonth()"></div><div class="dp_month">'+this._getMonthName(this._firstDayOfMonth.getMonth())+" "+this._firstDayOfMonth.getFullYear()+'</div><div class="w_icon w_button_next dp_next" onclick="(new wink.ui.xy.DatePicker())._goToNextMonth()"></div><div class="w_icon w_float w_button_close" onClick="(new wink.ui.xy.DatePicker()).hide()"></div></div>';
this._template+='<div class="dp_days_container"><div class="dp_days">'+_(this._week[this._firstDayOfWeek],this)+'</div><div class="dp_days">'+_(this._week[(this._firstDayOfWeek+1)%7],this)+'</div><div class="dp_days">'+_(this._week[(this._firstDayOfWeek+2)%7],this)+'</div><div class="dp_days">'+_(this._week[(this._firstDayOfWeek+3)%7],this)+'</div><div class="dp_days">'+_(this._week[(this._firstDayOfWeek+4)%7],this)+'</div><div class="dp_days">'+_(this._week[(this._firstDayOfWeek+5)%7],this)+'</div><div class="dp_days">'+
_(this._week[(this._firstDayOfWeek+6)%7],this)+"</div></div>";this._template+='<div class="dp_dates_container w_border_bottom">';if(this._firstDayOfMonth.getDay()==this._firstDayOfWeek)for(var d=0;d<7;d++){c.setTime(this._firstDayOfMonth.getTime()-(7-d)*864E5);this._template+='<a href="#" class="dp_date dp_finished w_border_bottom w_border_right" onClick="(new wink.ui.xy.DatePicker())._selectDate('+c.getTime()+')">'+c.getDate()+"</a>"}else if(this._firstDayOfMonth.getDay()==(this._firstDayOfWeek+
6)%7){for(d=0;d<6;d++){c.setTime(this._firstDayOfMonth.getTime()-(6-d)*864E5);this._template+='<a href="#" class="dp_date dp_finished w_border_bottom w_border_right" onClick="(new wink.ui.xy.DatePicker())._selectDate('+c.getTime()+')">'+c.getDate()+"</a>"}c.setTime(this._firstDayOfMonth.getTime());this._template+=c.getMonth()==a.getMonth()&&c.getYear()==a.getYear()?c.getDate()==a.getDate()?'<a href="#" class="dp_date dp_today w_border_bottom w_border_right" onClick="(new wink.ui.xy.DatePicker())._selectDate('+
this._firstDayOfMonth.getTime()+')">'+this._firstDayOfMonth.getDate()+"</a>":'<a href="#" class="dp_date w_border_bottom w_border_right" onClick="(new wink.ui.xy.DatePicker())._selectDate('+this._firstDayOfMonth.getTime()+')">'+this._firstDayOfMonth.getDate()+"</a>":c.getMonth()==this._firstDayOfMonth.getMonth()&&c.getYear()==this._firstDayOfMonth.getYear()?'<a href="#" class="dp_date w_border_bottom w_border_right" onClick="(new wink.ui.xy.DatePicker())._selectDate('+c.getTime()+')">'+c.getDate()+
"</a>":'<a href="#" class="dp_date dp_finished w_border_bottom w_border_right" onClick="(new wink.ui.xy.DatePicker())._selectDate('+c.getTime()+')">'+c.getDate()+"</a>"}else{for(d=this._firstDayOfWeek;d<this._firstDayOfMonth.getDay();d++){c.setTime(this._firstDayOfMonth.getTime()-(this._firstDayOfMonth.getDay()-d)*864E5);this._template+='<a href="#" class="dp_date dp_finished w_border_bottom w_border_right" onClick="(new wink.ui.xy.DatePicker())._selectDate('+c.getTime()+')">'+c.getDate()+"</a>"}c.setTime(this._firstDayOfMonth.getTime());
this._template+=c.getMonth()==a.getMonth()&&c.getYear()==a.getYear()?c.getDate()==a.getDate()?'<a href="#" class="dp_date dp_today w_border_bottom w_border_right" onClick="(new wink.ui.xy.DatePicker())._selectDate('+this._firstDayOfMonth.getTime()+')">'+this._firstDayOfMonth.getDate()+"</a>":'<a href="#" class="dp_date w_border_bottom w_border_right" onClick="(new wink.ui.xy.DatePicker())._selectDate('+this._firstDayOfMonth.getTime()+')">'+this._firstDayOfMonth.getDate()+"</a>":c.getMonth()==this._firstDayOfMonth.getMonth()&&
c.getYear()==this._firstDayOfMonth.getYear()?'<a href="#" class="dp_date w_border_bottom w_border_right" onClick="(new wink.ui.xy.DatePicker())._selectDate('+c.getTime()+')">'+c.getDate()+"</a>":'<a href="#" class="dp_date dp_finished w_border_bottom w_border_right" onClick="(new wink.ui.xy.DatePicker())._selectDate('+c.getTime()+')">'+c.getDate()+"</a>";for(d=1;d<7+this._firstDayOfWeek-this._firstDayOfMonth.getDay();d++){c.setTime(this._firstDayOfMonth.getTime()+d*864E5);this._template+=c.getMonth()==
a.getMonth()&&c.getYear()==a.getYear()?c.getDate()==a.getDate()?'<a href="#" class="dp_date dp_today w_border_bottom w_border_right" onClick="(new wink.ui.xy.DatePicker())._selectDate('+c.getTime()+')">'+c.getDate()+"</a>":'<a href="#" class="dp_date w_border_bottom w_border_right" onClick="(new wink.ui.xy.DatePicker())._selectDate('+c.getTime()+')">'+c.getDate()+"</a>":c.getMonth()==this._firstDayOfMonth.getMonth()&&c.getYear()==this._firstDayOfMonth.getYear()?'<a href="#" class="dp_date w_border_bottom w_border_right" onClick="(new wink.ui.xy.DatePicker())._selectDate('+
c.getTime()+')">'+c.getDate()+"</a>":'<a href="#" class="dp_date dp_finished w_border_bottom w_border_right" onClick="(new wink.ui.xy.DatePicker())._selectDate('+c.getTime()+')">'+c.getDate()+"</a>"}}this._template+="</div>";for(var e=0;e<5;e++){this._template+='<div class="dp_dates_container">';for(d=1;d<8;d++){c.setTime(c.getTime()+864E5);this._template+=c.getMonth()!=a.getMonth()||c.getYear()!=a.getYear()?c.getMonth()==this._firstDayOfMonth.getMonth()&&c.getYear()==this._firstDayOfMonth.getYear()?
'<a href="#" class="dp_date w_border_bottom w_border_right" onClick="(new wink.ui.xy.DatePicker())._selectDate('+c.getTime()+')">'+c.getDate()+"</a>":'<a href="#" class="dp_date dp_finished w_border_bottom w_border_right" onClick="(new wink.ui.xy.DatePicker())._selectDate('+c.getTime()+')">'+c.getDate()+"</a>":c.getDate()==a.getDate()?'<a href="#" class="dp_date dp_today w_border_bottom w_border_right" onClick="(new wink.ui.xy.DatePicker())._selectDate('+c.getTime()+')">'+c.getDate()+"</a>":'<a href="#" class="dp_date w_border_bottom w_border_right" onClick="(new wink.ui.xy.DatePicker())._selectDate('+
c.getTime()+')">'+c.getDate()+"</a>"}this._template+="</div>"}this._template+="</div>";this._domNode.innerHTML=this._template},_selectDate:function(a){var c=new Date;c.setTime(a);b.publish("/datepicker/events/pickdate",{date:c});this.hide()},_goToNextMonth:function(){this._firstDayOfMonth.setMonth(this._firstDayOfMonth.getMonth()+1);this._updateTemplate()},_goToPreviousMonth:function(){this._firstDayOfMonth.setMonth(this._firstDayOfMonth.getMonth()-1);this._updateTemplate()},_getMonthName:function(a){switch(a){case 0:return _("january",
this);case 1:return _("february",this);case 2:return _("march",this);case 3:return _("april",this);case 4:return _("may",this);case 5:return _("june",this);case 6:return _("july",this);case 7:return _("august",this);case 8:return _("september",this);case 9:return _("october",this);case 10:return _("november",this);case 11:return _("december",this);default:return""}},_initDom:function(){this._domNode=document.createElement("div");this._domNode.className="w_bloc w_window dp_datepicker w_border w_radius w_bg_dark";
this._domNode.style.display="none";this._domNode.innerHTML=this._template;document.body.appendChild(this._domNode)}};return b.ui.xy.DatePicker});
define(["../../../../../_amd/core","../../js/datepicker"],function(b){b=b.ui.xy.DatePicker;b.prototype.i18n.en_EN={firstDayOfWeek:0,sunday:"S",monday:"M",tuesday:"T",wednesday:"W",thursday:"T",friday:"F",saturday:"S",january:"january",february:"february",march:"march",april:"april",may:"may",june:"june",july:"july",august:"august",september:"september",october:"october",november:"november",december:"december"};return b});
define(["../../../../_amd/core"],function(b){b.ui.xy.Menu=function(a){if(b.isUndefined(b.ui.xy.Menu.singleton)){this._properties=a;this.uId=b.getUId();this._closeNode=this._domNode=null;this._items=[];this._displayed=false;this._view={x:0,y:0};b.mixin(this._view,a);if(this._validateProperties()!==false){this._initDom();this._initListeners();b.ui.xy.Menu.singleton=this}}else return b.ui.xy.Menu.singleton};b.ui.xy.Menu.prototype={_DISPLAY_DURATION:400,getDomNode:function(){return this._domNode},toggle:function(){this._displayed==
false?this._show():this._hide()},addItem:function(a){this._items.push(a);var c=a.itemClass,d=a.title,e=a.callback;a=document.createElement("div");var g=document.createElement("div"),f=document.createElement("div"),h=document.createElement("span");a.appendChild(g);a.appendChild(f);f.appendChild(h);this._domNode.appendChild(a);b.addClass(a,"mn_menu_item w_border_right w_border_bottom");b.addClass(g,"mn_image");b.addClass(f,"mn_title");b.addClass(h,"mn_title_text");b.isSet(c)&&b.addClass(a,c);if(b.isSet(d))h.innerHTML=
d;if(b.isSet(e)&&b.isCallback(e))a.onclick=function(){b.call(e)}},_initDom:function(){this._domNode=document.createElement("div");this._closeNode=document.createElement("div");this._closeNode.className="w_icon w_float w_button_close";this._domNode.appendChild(this._closeNode);b.addClass(this._domNode,"w_box w_window mn_menu w_border w_radius w_bg_dark");b.fx.apply(this._domNode,{visibility:"hidden",opacity:0});this._domNode.translate(this._view.x,this._view.y)},_initListeners:function(){b.ux.touch.addListener(this._closeNode,
"end",{context:this,method:"_hide"},{preventDefault:true})},_validateProperties:function(){return true},_show:function(){b.layer.show();b.fx.applyTransition(this._domNode,"opacity",this._DISPLAY_DURATION+"ms","0ms","ease-in");b.fx.apply(this._domNode,{visibility:"visible",opacity:1});b.fx.onTransitionEnd(this._domNode,b.bind(this._postShow,this));b.publish("/menu/events/open",null)},_postShow:function(){this._displayed=true},_hide:function(){b.fx.applyTransition(this._domNode,"opacity",this._DISPLAY_DURATION+
"ms","0ms","ease-out");this._domNode.style.opacity=0;b.fx.onTransitionEnd(this._domNode,b.bind(this._postHide,this))},_postHide:function(){this._domNode.style.visibility="hidden";this._displayed=false;b.layer.hide();b.publish("/menu/events/close",null)}};return b.ui.xy.Menu});
define(["../../../../_amd/core"],function(b){b.ui.xy.NewsTicker=function(a){this.uId=b.getUId();this.news=[];this._currentNewsId=this._currentNews=0;this._breakingNewsList=[];this._titleNode=this._domNode=null;b.mixin(this,a);if(this._validateProperties()!==false){this._initDomNode();this._subscribeToEvents();this._initProperties();this._initisteners();this._timer=b.setTimeout(this,"_animate",1)}};b.ui.xy.NewsTicker.prototype={addNews:function(a,c){var d=new b.ui.xy.NewsTicker.BreakingNews({type:a,
content:c});this._domNode.appendChild(d.getDomNode());this._breakingNewsList.push(d)},removeNews:function(a){if(this._breakingNewsList[a]&&this._breakingNewsList.length>1){this._breakingNewsList.splice(a,1);this._currentNews>=a&&this._currentNews--}},getNewsList:function(){return this._breakingNewsList},getDomNode:function(){return this._domNode},_animate:function(){var a=this._breakingNewsList[this._currentNews];this._currentNewsId=a.uId;this._titleNode.className="nt_title nt_title_"+a.type;a._animate()},
_handleAnimationEnd:function(a){if(a.breakingNewsId==this._currentNewsId){if(this._currentNews==this._breakingNewsList.length-1)this._currentNews=0;else this._currentNews++;this._timer=b.setTimeout(this,"_animate",1)}},_updateNewsPosition:function(){for(var a=this._breakingNewsList.length,c=0;c<a;c++)this._breakingNewsList[c].uId!=this._currentNewsId&&this._breakingNewsList[c]._position()},_subscribeToEvents:function(){b.subscribe("/breakingnews/events/animationend",{context:this,method:"_handleAnimationEnd"})},
_validateProperties:function(){return true},_initisteners:function(){window.addEventListener("orientationchange",b.bind(function(){this._updateNewsPosition()},this),false)},_initProperties:function(){for(var a=this.news.length,c=0;c<a;c++)this.addNews(this.news[c].type,this.news[c].content)},_initDomNode:function(){this._domNode=document.createElement("div");this._domNode.className="w_bg_light w_panel nt_container";this._titleNode=document.createElement("div");this._titleNode.className="nt_title";
this._domNode.appendChild(this._titleNode)}};b.ui.xy.NewsTicker.BreakingNews=function(a){this.uId=b.getUId();this.type=a.type;this.content=a.content;this._animationHandler=b.bind(this._handleAnimationEnd,this);this._domNode=null;this._initDomNode()};b.ui.xy.NewsTicker.BreakingNews.prototype={getDomNode:function(){return this._domNode},_initDomNode:function(){this._domNode=document.createElement("div");this._domNode.className="nt_news";this._domNode.innerHTML=this.content;b.fx.apply(this._domNode,
{"transition-timing-function":"linear"});this._position()},_animate:function(){b.fx.apply(this._domNode,{"transition-duration":(document.documentElement.offsetWidth+this._domNode.clientWidth)*10+"ms"});this._domNode.translate(-this._domNode.clientWidth,0);b.fx.onTransitionEnd(this._domNode,this._animationHandler)},_handleAnimationEnd:function(){b.setTimeout(this,"_position",1);b.publish("/breakingnews/events/animationend",{breakingNewsId:this.uId})},_position:function(){b.fx.apply(this._domNode,{"transition-duration":""});
this._domNode.translate(document.documentElement.offsetWidth,0)}};return b.ui.xy.NewsTicker});
define(["../../../../_amd/core"],function(b){b.ui.xy.Popup=function(a){if(b.isUndefined(b.ui.xy.Popup.singleton)){this._properties=a;this.uId=1;this.displayed=false;this._arrowNode=this._btnsNode=this._contentNode=this._domNode=null;this._followScrollY=this._absolutePos=false;this._scrollHandler=null;this._popupClasses="";this._inTransition=false;this._transitions={};this._initDom();this._initListeners();b.ui.xy.Popup.singleton=this}else return b.ui.xy.Popup.singleton};b.ui.xy.Popup.prototype={i18n:{},
_DEFAULT_ARROW:"none",getDomNode:function(){return this._domNode},hide:function(){this._hide()},preloadContent:function(){},alert:function(a){if(this.displayed!=true){var c=a||{};this._initTemplate(this._DEFAULT_ARROW,c.msg);a=document.createElement("div");b.addClass(a,"w_button w_radius pp_popup_btn pp_popup_alert w_bg_light");var d=_("alertOk",this);if(b.isSet(c.btn))d=c.btn;a.innerHTML=d;if(b.isSet(c.callback))a.onclick=b.bind(function(){this._invokeCallback(c.callback)},this);this._btnsNode.appendChild(a);
this._setPopupStyle("pp_type_alert",c);this._show()}},confirm:function(a){if(this.displayed!=true){var c=a||{};this._initTemplate(this._DEFAULT_ARROW,c.msg);a=document.createElement("div");var d=document.createElement("div");b.addClass(a,"w_button w_radius pp_popup_btn pp_popup_confirm w_bg_light");b.addClass(d,"w_button w_radius pp_popup_btn pp_popup_confirm w_bg_light");var e=_("confirmCancel",this);if(b.isSet(c.btnCancel))e=c.btnCancel;var g=_("confirmOk",this);if(b.isSet(c.btnOk))g=c.btnOk;a.innerHTML=
e;d.innerHTML=g;if(b.isSet(c.callbackCancel))a.onclick=b.bind(function(){this._invokeCallback(c.callbackCancel)},this);if(b.isSet(c.callbackOk))d.onclick=b.bind(function(){this._invokeCallback(c.callbackOk)},this);this._btnsNode.appendChild(a);this._btnsNode.appendChild(d);this._setPopupStyle("pp_type_confirm",c);this._show()}},popup:function(a){if(this.displayed!=true){var c=a||{};a=this._DEFAULT_ARROW;var d="50px";if(b.isSet(c.arrowLeftPos))d=b.isInteger(c.arrowLeftPos)?c.arrowLeftPos+"px":c.arrowLeftPos;
if(b.isSet(c.arrow))a=c.arrow;if(a!="top"&&a!="bottom"&&a!=this._DEFAULT_ARROW)b.log('[Popup] popup() : bad arrow value (expected "top", "bottom" or "none")');else{this._initTemplate(a,c.content,d);d="0px";if(b.isSet(c.targetNode)){this._absolutePos=true;if(a=="bottom")d=c.targetNode.getTopPosition()-this._domNode.offsetHeight-10+"px";else if(a=="top")d=c.targetNode.getTopPosition()+c.targetNode.offsetHeight+10+"px"}else if(b.isSet(c.top)){this._absolutePos=true;d=b.isInteger(c.top)?c.top+"px":c.top}this._domNode.style.top=
d;this._setPopupStyle("pp_type_popup",c);this._show();b.layer.onclick=b.isSet(c.layerCallback)?function(){this._inTransition||b.call(c.layerCallback)}:this._layerHandler}}},_initTemplate:function(a,c,d){this._followScrollY=this._absolutePos=false;this._popupClasses="w_box w_window pp_popup pp_hidden w_bg_dark";this._contentNode.innerHTML=c;this._btnsNode.innerHTML="";this._arrowNode.className="pp_popup_arrow pp_"+a;this._arrowNode.style.left=d;this._domNode.style.top="0px"},_setPopupStyle:function(a,
c){this._popupClasses+=" "+a;if(c.borderRadius!==false)this._popupClasses+=" w_radius";this._domNode.className=this._popupClasses;if(b.isSet(c.followScrollY)&&c.followScrollY===true)this._followScrollY=true;this._updatePosition();this._updateTransition(c.duration>=0?c.duration:400,0)},_updateTransition:function(a,c){var d=false;if(b.isInteger(a)&&this._transitions.opacity!=a){this._transitions.opacity=a;d=true}if(b.isInteger(c)&&this._transitions.top!=c){this._transitions.top=c;d=true}d&&b.fx.applyTransition(this._domNode,
"opacity, transform",this._transitions.opacity+"ms,"+this._transitions.top+"ms","1ms,1ms","default,default")},_updatePosition:function(){var a=0;if(this._absolutePos==false)a+=(window.innerHeight-this._domNode.offsetHeight)/2+window.pageYOffset;else if(this._followScrollY)a+=window.pageYOffset;this._domNode.translate(0,a)},_initDom:function(){this._domNode=document.createElement("div");this._contentNode=document.createElement("div");this._btnsNode=document.createElement("div");this._arrowNode=document.createElement("div");
b.addClass(this._domNode,"pp_popup pp_hidden");b.addClass(this._contentNode,"w_bloc");b.addClass(this._arrowNode,"pp_popup_arrow none");this._domNode.appendChild(this._contentNode);this._domNode.appendChild(this._btnsNode);this._domNode.appendChild(this._arrowNode);this._domNode.style.opacity=0;this._transitions.opacity=0;this._transitions.top=0},_initListeners:function(){this._scrollHandler=b.bind(this._updatePosition,this);this._postShowHandler=b.bind(this._postShow,this);this._postHideHandler=
b.bind(this._postHide,this);this._layerHandler=b.bind(this._hide,this)},_show:function(){if(!(this.displayed==true||this._inTransition==true)){this._inTransition=true;this._followScrollY==true&&window.addEventListener("scroll",this._scrollHandler,false);b.removeClass(this._domNode,"pp_hidden");b.layer.update();b.layer.show();b.fx.onTransitionEnd(this._domNode,this._postShowHandler);this._domNode.style.opacity=1}},_postShow:function(){this._followScrollY==true&&this._updateTransition(this._transitions.opacity,
200);this.displayed=true;this._inTransition=false},_hide:function(){if(!(this.displayed==false||this._inTransition==true)){this._inTransition=true;this._followScrollY==true&&window.removeEventListener("scroll",this._scrollHandler,false);b.layer.hide();b.layer.onclick=null;b.fx.onTransitionEnd(this._domNode,this._postHideHandler);this._domNode.style.opacity=0}},_postHide:function(){b.addClass(this._domNode,"pp_hidden");this._contentNode.innerHTML="";this._inTransition=this.displayed=false},_invokeCallback:function(a){if(!(this._inTransition==
true||!b.isSet(a))){this._hide();b.call(a)}}};return b.ui.xy.Popup});define(["../../../../../_amd/core","../../js/popup"],function(b){b=b.ui.xy.Popup;b.prototype.i18n.en_EN={alertOk:"ok",confirmOk:"ok",confirmCancel:"cancel"};return b});
define(["../../../../_amd/core"],function(b){b.ui.xy.ProgressBar=function(a){this.uId=b.getUId();this.value=0;this.progressBarColor=this.borderColor=null;this.progressBarImage={type:undefined,image:undefined};this.height=15;this.width=200;this._pBContentNode=this._pBNode=null;b.mixin(this,a);this._validateProperties()!==false&&this._initDom()};b.ui.xy.ProgressBar.prototype={setValue:function(a){if(a>=0&&a<=100){this.value=a;this._updateProgressView()}},setBorderColor:function(a){this.borderColor=
a;this._pBNode.style.borderColor=this.borderColor},setProgressBarColor:function(a){this.progressBarColor=a;this._pBContentNode.style.backgroundColor=this.progressBarColor},setProgressBarImage:function(a){this.progressBarImage=a;b.fx.apply(this._pBContentNode,{backgroundImage:"url(data:image/"+this.progressBarImage.type+";base64,"+this.progressBarImage.image+")",backgroundRepeat:"repeat-x"})},getDomNode:function(){return this._pBNode},_updateProgressView:function(){this._pBContentNode.style.width=
this.value+"%"},_validateProperties:function(){return true},_handleTransitionEnd:function(){this._pBContentNode.style.width=="100%"&&b.publish("/progressbar/events/end",null)},_initDom:function(){var a=this._pBNode=document.createElement("div"),c=this._pBContentNode=document.createElement("div"),d={height:this.height+"px",width:this.width+"px"},e={height:this.height+"px",width:"0%","transition-property":"width","transition-duration":"800ms","transition-timing-function":"linear"};if(b.isSet(this.borderColor))d.borderColor=
this.borderColor;if(b.isSet(this.progressBarColor))e.background=this.progressBarColor;if(b.isSet(this.progressBarImage.type)&&b.isSet(this.progressBarImage.image)){e.backgroundImage="url(data:image/"+this.progressBarImage.type+";base64,"+this.progressBarImage.image+")";e.backgroundRepeat="repeat-x"}b.addClass(a,"w_bar w_radius w_border");b.addClass(c,"w_bar_progress w_radius");b.fx.apply(a,d);b.fx.apply(c,e);a.appendChild(c);b.fx.onTransitionEnd(c,b.bind(this._handleTransitionEnd,this))}};return b.ui.xy.ProgressBar});
define(["../../../../_amd/core","../../../../ux/movementtracker/js/movementtracker"],function(b){b.ui.xy.Slideshow=function(a){this.uId=b.getUId();this._properties=a;this._items=null;this._params={scopeSize:4,displayHeader:true,displayFooter:true,headerHeight:26,footerHeight:26,listeningTouch:true,touchTranslation:false,withSliding:false,withAnim:false,autoplay:false,animRandom:false,anims:null,autoplayDuration:5E3,inactivityDuration:1E4,slideDuration:200,animDuration:800,refreshRate:40,fpms:0.025};
this._view={h:0,w:0,scopeBegin:0,scopeEnd:0,position:0,x:0,tx:0,sx:0,stepDistance:0,targetSlide:0,nearestItem:0,currentAnim:0,animPos:-1};this._anims={oneSquare:0,nSquare:1,fade:2,horizontalOut:3,horizontalIn:4,circleOut:5,circleIn:6,circlesOut:7,circlesIn:8,rowDown:9,rowUp:10,colLeft:11,colRight:12,rotate:13,spin:14,spinQuarter:15,light:16,wrap:17,scaleIn:18,scaleOut:19};this._renderingTiming=this._autoplayTiming=this._transitionContext=this._transitions=this._timer=this._movementtracker=this._ctx=
this._footerNode=this._headerNode=this._canvasNode=this._domNode=null;this._animated=this._sliding=this._rendering=this._loading=false;if(this._validateProperties()!==false){this._initProperties();this._initDom();this._initListeners();this._goToItem(this._view.position);this._startRendering()}};b.ui.xy.Slideshow.prototype={getDomNode:function(){return this._domNode},getCurrentItem:function(){return this._items[this._view.position]},updateParameters:function(a){this._stopRendering();this._mixParams(a);
if(this._params.displayHeader)this._headerNode==null&&this._createHeader();else if(this._headerNode!=null)this._headerNode.style.display="none";if(this._params.displayFooter)this._footerNode==null&&this._createFooter();else if(this._footerNode!=null)this._footerNode.style.display="none";this._initListeners();this._goToItem(this._view.position);this._startRendering()},next:function(){this._computeNearestPosition(-1);this._goToNearestPosition()},previous:function(){this._computeNearestPosition(1);this._goToNearestPosition()},
_startRendering:function(){if(this._rendering!=true){this._rendering=true;this._timer=b.setInterval(this,"_render",this._params.refreshRate);var a=(new Date).getTime();if(this._params.autoplay==true)this._autoplayTiming=a;this._renderingTiming=a}},_stopRendering:function(){clearInterval(this._timer);this._rendering=false},_notifyActivity:function(){var a=(new Date).getTime();if(this._params.autoplay==true)this._autoplayTiming=a;this._renderingTiming=a;this._rendering==false&&this._startRendering()},
_render:function(){if(this._rendering!=false){if(this._loading==false){var a=(new Date).getTime();if(this._params.autoplay==true){var c=a-this._autoplayTiming;if(c>this._params.autoplayDuration){this._computeNearestPosition(-1);if(this._view.position==this._items.length-1)this._view.nearestItem=0;this._goToNearestPosition();this._autoplayTiming=a}}else{c=a-this._renderingTiming;c>this._params.inactivityDuration&&this._stopRendering()}}if(this._sliding==true)this._onSlideMotion();else this._animated==
true&&this._onAnimMotion();this._drawBackground();this._ctx.save();this._translate();this._drawItems();this._ctx.restore()}},_drawBackground:function(){this._ctx.fillStyle="rgba(0, 0, 0, 1.0)";this._ctx.fillRect(0,0,this._view.w,this._view.h)},_drawItems:function(){if(this._animated==true){var a=this._transitionContext.fgImage,c=this._transitionContext.bgImage;if(!(a.imgLoaded==false||c.imgLoaded==false)){this._ctx.globalCompositeOperation="source-over";this._ctx.drawImage(c.imageObj,0,0,this._view.w,
this._view.h);c=b.math.round(a.w/this._view.w,10);for(var d=b.math.round(a.h/this._view.h,10),e=0;e<this._transitions.length;e++){var g=this._transitions[e];if(!(g.isOnDelay()||g.isFinished())){var f=b.math.round(g.x*c,5),h=b.math.round(g.y*d,5),i=b.math.round(g.w*c,5),j=b.math.round(g.h*d,5),l=g.x,k=g.y;if(b.isSet(g.originX)&&b.isSet(g.originY)){this._ctx.translate(-g.originX,-g.originY);l+=g.originX;k+=g.originY}this._ctx.save();if(b.isSet(g.circle)){this._ctx.beginPath();var m=0,n=Math.PI*2,o=
g.x+g.w/2,p=g.y+g.h/2;if(b.isSet(g.angleBegin)&&b.isSet(g.angleEnd)){m=g.angleBegin;n=g.angleEnd}if(b.isSet(g.centerX)&&b.isSet(g.centerY)){o=g.centerX;p=g.centerY}this._ctx.moveTo(o,p);this._ctx.arc(o,p,g.circle,m,n,true);this._ctx.clip();this._ctx.closePath()}b.isSet(g.rotate)&&this._ctx.rotate(g.rotate);if(b.isSet(g.scale)){m=this._view.w*g.scale;n=this._view.h*g.scale;l=(this._view.w-m)/2;k=(this._view.h-n)/2;g.w=m;g.h=n}this._ctx.save();if(b.isSet(g.opacity))this._ctx.globalAlpha=g.opacity;if(b.isSet(g.wrapPos)){k=
g.getProperties();m=g.wrapPos;h=g.w;c=b.math.round(a.w/this._view.w,10);d=b.math.round(a.h/this._view.h,10);l=this._view.w-m-h;f=b.math.round(l*c,4);i=b.math.round(h*c,4);k=-(k.stepCount*0.005);f=Math.max(f-g.currentStep*k,0);i=i-k;this._ctx.save();this._ctx.translate(this._view.w,0);this._ctx.scale(-1,1);this._ctx.drawImage(a.imageObj,f,0,i,j,m,0,h,this._view.h);this._ctx.restore();i=this._ctx.createLinearGradient(l,0,l+h,0);f=0.6;i.addColorStop(0,"rgba(0, 0, 0,"+f+")");i.addColorStop(0.2,"rgba(0, 0, 0, 0)");
i.addColorStop(0.3,"rgba(254, 254, 254, 0)");i.addColorStop(0.45,"rgba(254, 254, 254,"+f+")");i.addColorStop(0.6,"rgba(254, 254, 254, 0)");i.addColorStop(0.66,"rgba(0, 0, 0, 0)");i.addColorStop(1,"rgba(0, 0, 0,"+f+")");this._ctx.fillStyle=i;this._ctx.fillRect(l,0,h,this._view.h);i=b.math.round(l*c,2);i>0&&this._ctx.drawImage(a.imageObj,0,0,i,j,0,0,l,this._view.h);j=l+h;i=this._ctx.createLinearGradient(j,0,j+30,0);f=0.8;i.addColorStop(0,"rgba(0, 0, 0,"+f+")");i.addColorStop(1,"rgba(0, 0, 0, 0)");this._ctx.fillStyle=
i;this._ctx.fillRect(j,0,this._view.w-j,this._view.h)}else this._ctx.drawImage(a.imageObj,f,h,i,j,l,k,g.w,g.h);this._ctx.restore();if(b.isSet(g.radialGradientR1)&&b.isSet(g.radialGradientR2)){j=g.radialGradientR1;i=g.radialGradientR2;k=g.getProperties();f=k.radialGradientR1;h=k.radialGradientR2;j=this._ctx.createRadialGradient(f.x,f.y,j,h.x,h.y,i);i=1;if(b.isSet(g.gradientOpacity))i=g.gradientOpacity;j.addColorStop(0,"rgba(255, 255, 255, "+i+")");j.addColorStop(1,"rgba(255, 255, 255, 0.0)");this._ctx.fillStyle=
j;this._ctx.fillRect(0,0,this._view.w,this._view.h)}this._ctx.restore()}}}}else for(e=this._view.scopeBegin;e<=this._view.scopeEnd;e++){this._ctx.save();this._drawItem(this._items[e]);if(e==this._view.position){this._drawHeader(this._items[e]);this._drawFooter(this._items[e])}this._ctx.restore()}},_drawItem:function(a){if(a.imgLoaded==true)if(a.index==this._view.position||a.index==this._view.nearestItem){this._ctx.translate(this._getXPosition(a),0);this._ctx.drawImage(a.imageObj,0,0,this._view.w,
this._view.h)}},_drawHeader:function(a){if(this._params.displayHeader)this._headerNode.innerHTML=a.title},_drawFooter:function(a){if(this._params.displayFooter)this._footerNode.innerHTML=a.info},_handleMovementChanged:function(a){if(a.publisher.uId==this._movementtracker.uId)if(!(this._sliding==true||this._animated==true)){a=a.movement;this._computeNearestPosition(a.pointStatement[a.pointStatement.length-1].x-a.pointStatement[a.pointStatement.length-2].x);this._notifyActivity()}},_handleMovementStored:function(a){if(a.publisher.uId==
this._movementtracker.uId)if(!(this._sliding==true||this._animated==true))if(this._items[this._view.nearestItem].imgLoaded!=false){this._goToNearestPosition();this._notifyActivity()}},_computeNearestPosition:function(a){this._computePosition(a,null);this._view.nearestItem=this._getNearest()},_goToNearestPosition:function(){if(this._params.withSliding)this._slideToNearest();else this._params.withAnim?this._animToNearest():this._goToItem(this._view.nearestItem)},_goToItem:function(a){this._view.tx=
0;this._view.sx=0;this._view.x=0;this._view.position=a;this._loadImagesInScope();b.publish("/slideshow/events/itemChanged",{currentItem:this._items[this._view.position]})},_getXPosition:function(a){return(a.index-this._view.position)*this._view.w},_computePosition:function(a,c){if(a)this._view.tx+=a;if(c)this._view.sx+=c;this._view.x=0;if(this._params.touchTranslation)this._view.x+=this._view.tx;if(this._params.withSliding)this._view.x+=this._view.sx},_translate:function(){this._ctx.translate(this._view.x,
0)},_getNearest:function(){var a=this._view.position;if(this._view.tx!=0)if(this._view.tx>0){a--;a=Math.max(a,0)}else{a++;a=Math.min(a,this._items.length-1)}return a},_slideToNearest:function(){this._view.targetSlide=this._getXPosition(this._items[this._view.nearestItem]);this._view.stepDistance=b.math.round(Math.abs(this._view.targetSlide+this._view.x)/(this._params.fpms*this._params.slideDuration),0);this._sliding=true},_onSlideMotion:function(){var a=this._view.stepDistance;if(this._view.targetSlide>
0)a=-a;this._computePosition(null,a);a=this._view.stepDistance;if(Math.abs(this._view.x)+a>=Math.abs(this._view.targetSlide)){this._sliding=false;this._goToItem(this._view.nearestItem)}},_getNextAnim:function(){var a=this._view.currentAnim;if(this._params.anims.length>0){this._view.animPos=this._params.animRandom?Math.floor(this._params.anims.length*Math.random()):(this._view.animPos+1)%this._params.anims.length;a=this._anims[this._params.anims[this._view.animPos]]}b.isSet(a)||(a=0);return a},_animToNearest:function(){if(this._view.nearestItem==
this._view.position)this._goToItem(this._view.nearestItem);else{var a=this._view.w,c=this._view.h;this._transitions=[];this._transitionContext={fgImage:this._items[this._view.position],bgImage:this._items[this._view.nearestItem]};var d=Math.floor(this._params.fpms*this._params.animDuration);this._view.currentAnim=this._getNextAnim();if(this._view.currentAnim==this._anims.oneSquare)this._transitions.push(new b.ui.xy.Slideshow.Transition({stepCount:d,x:{from:0,to:a/2},y:{from:0,to:c/2},h:{from:c,to:0},
w:{from:a,to:0}}));else if(this._view.currentAnim==this._anims.nSquare)for(var e=6,g=4,f=this._view.w/e,h=this._view.h/g,i=this._params.animDuration/e/1.2,j=0;j<e;j++){a=j*f;var l=a+f/2;d=(e-j)*i;if(this._view.nearestItem>this._view.position)d=j*i;d=this._params.fpms*(this._params.animDuration-d);for(c=0;c<g;c++){var k=c*h,m=k+h/2;m=new b.ui.xy.Slideshow.Transition({stepCount:d,x:{from:a,to:l},y:{from:k,to:m},h:{from:h,to:0},w:{from:f,to:0}});this._transitions.push(m)}}else if(this._view.currentAnim==
this._anims.fade)this._transitions.push(new b.ui.xy.Slideshow.Transition({stepCount:d,x:{from:0,to:0},y:{from:0,to:0},h:{from:c,to:c},w:{from:a,to:a},opacity:{from:1,to:0}}));else if(this._view.currentAnim==this._anims.horizontalIn||this._view.currentAnim==this._anims.horizontalOut){j=c/2;e=0;g=c/2;k=c;m=c/2;f=0;if(l=this._view.currentAnim==this._anims.horizontalIn){j=this._transitionContext.bgImage;this._transitionContext.bgImage=this._transitionContext.fgImage;this._transitionContext.fgImage=j;
j=0;e=c/2;g=c;k=c/2;m=0;f=c/2}this._transitions.push(new b.ui.xy.Slideshow.Transition({stepCount:d,x:{from:0,to:0},y:{from:0,to:0},h:{from:j,to:e},w:{from:a,to:a}}));this._transitions.push(new b.ui.xy.Slideshow.Transition({stepCount:d,x:{from:0,to:0},y:{from:g,to:k},h:{from:m,to:f},w:{from:a,to:a}}))}else if(this._view.currentAnim==this._anims.circleIn||this._view.currentAnim==this._anims.circleOut){k=a>c?a/2:c/2;j=k=Math.sqrt(k*k*2);e=0;if(l=this._view.currentAnim==this._anims.circleIn){j=this._transitionContext.bgImage;
this._transitionContext.bgImage=this._transitionContext.fgImage;this._transitionContext.fgImage=j;j=0;e=k}this._transitions.push(new b.ui.xy.Slideshow.Transition({stepCount:d,x:{from:0,to:0},y:{from:0,to:0},h:{from:c,to:c},w:{from:a,to:a},circle:{from:j,to:e}}))}else if(this._view.currentAnim==this._anims.circlesIn||this._view.currentAnim==this._anims.circlesOut){if(l=this._view.currentAnim==this._anims.circlesIn){j=this._transitionContext.bgImage;this._transitionContext.bgImage=this._transitionContext.fgImage;
this._transitionContext.fgImage=j}g=e=5;a=a/e;f=c/g;k=a>f?a/2:f/2;k=Math.sqrt(k*k*2);for(j=0;j<e;j++)for(c=0;c<g;c++){m=a*j;h=f*c;i=k;var n=0;if(l){i=0;n=k}m=new b.ui.xy.Slideshow.Transition({stepCount:d,x:{from:m,to:m},y:{from:h,to:h},h:{from:f,to:f},w:{from:a,to:a},circle:{from:i,to:n}});this._transitions.push(m)}}else if(this._view.currentAnim==this._anims.rowDown||this._view.currentAnim==this._anims.rowUp){if(e=this._view.currentAnim==this._anims.rowUp){j=this._transitionContext.bgImage;this._transitionContext.bgImage=
this._transitionContext.fgImage;this._transitionContext.fgImage=j}g=8;c=c/g;for(j=0;j<g;j++){k=j*c;m=k+c;l=c;f=0;if(e){k+=c;m=j*c;l=0;f=c}m=new b.ui.xy.Slideshow.Transition({stepCount:d,x:{from:0,to:0},y:{from:k,to:m},h:{from:l,to:f},w:{from:a,to:a}});this._transitions.push(m)}}else if(this._view.currentAnim==this._anims.colLeft||this._view.currentAnim==this._anims.colRight){if(g=this._view.currentAnim==this._anims.colLeft){j=this._transitionContext.bgImage;this._transitionContext.bgImage=this._transitionContext.fgImage;
this._transitionContext.fgImage=j}e=8;k=a/e;for(j=0;j<e;j++){a=j*k;l=a+k;m=k;f=0;if(g){a+=k;l=j*k;m=0;f=k}m=new b.ui.xy.Slideshow.Transition({stepCount:d,x:{from:a,to:l},y:{from:0,to:0},h:{from:c,to:c},w:{from:m,to:f}});this._transitions.push(m)}}else if(this._view.currentAnim==this._anims.rotate){j=90;e=-a;g=-c;if(this._view.nearestItem>this._view.position){j=-90;e=0}this._transitions.push(new b.ui.xy.Slideshow.Transition({stepCount:d,x:{from:0,to:0},y:{from:0,to:0},h:{from:c,to:c},w:{from:a,to:a},
translateX:{from:a,to:a},translateY:{from:c,to:c},rotate:{from:0,to:j*Math.PI/180},originX:{from:e,to:e},originY:{from:g,to:g}}))}else if(this._view.currentAnim==this._anims.spin||this._view.currentAnim==this._anims.spinQuarter){k=a>c?a/2:c/2;k=Math.sqrt(k*k*2);e=[{x:0,y:0,h:c,w:a,from:0,to:Math.PI*2}];if(this._view.currentAnim==this._anims.spinQuarter)e=[{x:a/2,y:c/2,h:c/2,w:a/2,from:0,to:Math.PI/2},{x:a/2,y:0,h:c/2,w:a/2,from:-Math.PI/2,to:0},{x:0,y:0,h:c/2,w:a/2,from:-Math.PI,to:-Math.PI/2},{x:0,
y:c/2,h:c/2,w:a/2,from:-1.5*Math.PI,to:-Math.PI}];for(j=0;j<e.length;j++){g=e[j];this._transitions.push(new b.ui.xy.Slideshow.Transition({stepCount:d,x:{from:g.x,to:g.x},y:{from:g.y,to:g.y},h:{from:g.h,to:g.h},w:{from:g.w,to:g.w},circle:{from:k,to:k},centerX:{from:a/2,to:a/2},centerY:{from:c/2,to:c/2},angleBegin:{from:g.from,to:g.from},angleEnd:{from:g.from,to:g.to}}))}}else if(this._view.currentAnim==this._anims.light){k=a>c?a/2:c/2;k=Math.sqrt(k*k*2);d=Math.floor(d/2);this._transitions.push(new b.ui.xy.Slideshow.Transition({stepCount:d,
x:{from:0,to:0},y:{from:0,to:0},h:{from:c,to:c},w:{from:a,to:a},radialGradientR1:{from:0,to:k,x:a/2,y:c/2},radialGradientR2:{from:k/2,to:k*1.5,x:a/2,y:c/2}}));this._transitions.push(new b.ui.xy.Slideshow.Transition({stepCount:d,stepCountDelay:d,x:{from:0,to:0},y:{from:0,to:0},h:{from:c,to:c},w:{from:a,to:a},radialGradientR1:{from:k,to:k-1,x:a/2,y:c/2},radialGradientR2:{from:k,to:k,x:a/2,y:c/2},gradientOpacity:{from:1,to:0},opacity:{from:0,to:0}}))}else if(this._view.currentAnim==this._anims.wrap){j=
a/8;this._transitions.push(new b.ui.xy.Slideshow.Transition({stepCount:d,x:{from:0,to:0},y:{from:0,to:0},h:{from:c,to:c},w:{from:j,to:j},wrapPos:{from:0,to:a}}))}else if(this._view.currentAnim==this._anims.scaleIn||this._view.currentAnim==this._anims.scaleOut){l=this._view.currentAnim==this._anims.scaleIn;j=1;e=0;if(l){j=this._transitionContext.bgImage;this._transitionContext.bgImage=this._transitionContext.fgImage;this._transitionContext.fgImage=j;j=0;e=1}this._transitions.push(new b.ui.xy.Slideshow.Transition({stepCount:d,
x:{from:0,to:0},y:{from:0,to:0},h:{from:c,to:c},w:{from:a,to:a},scale:{from:j,to:e}}))}this._animated=true;b.publish("/slideshow/events/animstart",{currentItem:this._items[this._view.position],nextItem:this._items[this._view.nearestItem],animation:this._params.anims[this._view.animPos]})}},_onAnimMotion:function(){for(var a=true,c=0;c<this._transitions.length;c++){this._transitions[c].nextStep();a=a&&this._transitions[c].isFinished()}if(a){this._animated=false;b.publish("/slideshow/events/animend",
{previousItem:this._items[this._view.position],currentItem:this._items[this._view.nearestItem],animation:this._params.anims[this._view.animPos]});this._goToItem(this._view.nearestItem)}},_loadImagesInScope:function(){this._loading=true;var a,c;c=Math.floor(this._params.scopeSize/2);a=this._view.position-c;c=this._view.position+c;if(a<0){a=0;c=this._params.scopeSize-1}if(c>this._items.length-1)c=this._items.length-1;this._loadItemImages(a,c);a>0&&this._unloadItemImages(0,a-1);c<this._items.length-
1&&this._unloadItemImages(c+1,this._items.length-1)},_loadItemImages:function(a,c){this._view.scopeBegin=a;this._view.scopeEnd=c;for(var d=a;d<=c;d++)this._loadItemImage(this._items[d]);this._checkImagesLoaded()},_unloadItemImages:function(a,c){for(var d=a;d<=c;d++)this._unloadItemImage(this._items[d])},_loadItemImage:function(a){if(!(a.loading==true||a.imgLoaded==true)){a.imageObj=new Image;a.imageObj.src=a.image;a.loading=true;a.imageObj.onload=b.bind(function(){if(a.imageObj.complete===true){a.imgLoaded=
true;a.loading=false;a.w=a.imageObj.width;a.h=a.imageObj.height;this._checkImagesLoaded()}},this);a.imageObj.onunload=function(){a.imgLoaded=false;a.loading=false};a.imageObj.onerror=function(){a.loading=false};a.imageObj.abort=function(){}}},_unloadItemImage:function(a){if(a.imgLoaded!=false){a.imageObj.onload=a.imageObj.onunload;a.imageObj.src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==";a.w=a.imageObj.width;a.h=a.imageObj.height}},_clearItemsStatus:function(){for(var a=
0;a<this._items.length;a++){this._items[a].imgLoaded=false;this._items[a].loading=false}},_checkImagesLoaded:function(){for(var a=true,c=this._view.scopeBegin;c<=this._view.scopeEnd;c++)a=a&&this._items[c].imgLoaded==true;if(a)this._loading=false},_validateProperties:function(){return true},_raisePropertyError:function(a){b.log("[Slideshow] Error: "+a+" missing or invalid")},_initProperties:function(){this._mixParams(this._properties);delete this._properties},_mixParams:function(a){if(b.isSet(a.height)){this._view.h=
a.height;if(this._domNode!=null)this._domNode.style.height=this._view.h+"px";if(this._canvasNode!=null)this._canvasNode.height=this._view.h;if(this._footerNode!=null)this._footerNode.style.top=this._view.h-this._params.footerHeight+"px"}if(b.isSet(a.width)){this._view.w=a.width;if(this._domNode!=null)this._domNode.style.width=this._view.w+"px";if(this._canvasNode!=null)this._canvasNode.width=this._view.w;if(this._headerNode!=null)this._headerNode.style.width=this._view.w+"px";if(this._footerNode!=
null)this._footerNode.style.width=this._view.w+"px"}if(b.isSet(a.headerHeight)&&this._headerNode!=null)this._headerNode.style.height=a.headerHeight+"px";if(b.isSet(a.footerHeight)&&this._footerNode!=null)this._footerNode.style.height=a.footerHeight+"px";if(b.isSet(a.position))this._view.position=a.position;if(!b.isSet(this._view.position))this._view.position=0;if(b.isSet(a.items)){this._items=[].concat(a.items);for(var c=0;c<this._items.length;c++)this._items[c].index=c;this._clearItemsStatus()}for(var d in this._params)if(b.isSet(a[d]))this._params[d]=
a[d];if(!b.isSet(this._params.anims))this._params.anims=[]},_initDom:function(){this._domNode=document.createElement("div");b.fx.apply(this._domNode,{height:this._view.h+"px",width:this._view.w+"px"});this._canvasNode=document.createElement("canvas");this._canvasNode.height=this._view.h;this._canvasNode.width=this._view.w;this._ctx=this._canvasNode.getContext("2d");this._domNode.appendChild(this._canvasNode);this._canvasNode.translate(0,0);b.addClass(this._domNode,"ss_container");b.addClass(this._canvasNode,
"ss_canvas");this._params.displayHeader&&this._createHeader();this._params.displayFooter&&this._createFooter()},_createHeader:function(){this._headerNode=document.createElement("div");this._domNode.appendChild(this._headerNode);b.addClass(this._headerNode,"ss_header");b.fx.apply(this._headerNode,{top:"0px",left:"0px",width:this._view.w+"px",height:this._params.headerHeight+"px"})},_createFooter:function(){this._footerNode=document.createElement("div");this._domNode.appendChild(this._footerNode);b.addClass(this._footerNode,
"ss_footer");b.fx.apply(this._footerNode,{top:this._view.h-this._params.footerHeight+"px",left:"0px",width:this._view.w+"px",height:this._params.footerHeight+"px"})},_initListeners:function(){if(this._params.listeningTouch==true){if(this._movementtracker==null)this._movementtracker=new b.ux.MovementTracker({target:this._domNode});b.subscribe("/movementtracker/events/mvtchanged",{context:this,method:"_handleMovementChanged"});b.subscribe("/movementtracker/events/mvtstored",{context:this,method:"_handleMovementStored"})}else{b.unsubscribe("/movementtracker/events/mvtchanged",
{context:this,method:"_handleMovementChanged"});b.unsubscribe("/movementtracker/events/mvtstored",{context:this,method:"_handleMovementStored"})}}};b.ui.xy.Slideshow.Transition=function(a){this.uId=b.getUId();this._properties=a;this._props=[];this._stepCountDelay=this._stepCount=this.currentStepDelay=this.currentStep=0;this._init()};b.ui.xy.Slideshow.Transition.prototype={nextStep:function(){if(this.isOnDelay())this.currentStepDelay++;else{for(var a in this._props){var c=this._props[a];if(c.toCheck)c.to>
c.from?c.current+=c.step:c.current-=c.step;c.current=b.math.round(c.current,3)}this._updatePublicProps();this.currentStep++}},isFinished:function(){var a=false,c=false;for(var d in this._props){var e=this._props[d];if(e.toCheck){a=a||(e.to>e.from?e.current>=e.to?true:false:e.current<=e.to?true:false);c=true}}c||(a=true);return a},isOnDelay:function(){return this.currentStepDelay!=this._stepCountDelay},getProperties:function(){return this._properties},_init:function(){for(var a in this._properties){var c=
this._properties[a];if(a=="stepCount")this._stepCount=c;if(a=="stepCountDelay")this._stepCountDelay=c}for(a in this._properties){c=this._properties[a];if(a!="stepCount"&&a!="stepCountDelay")this._props[a]={from:c.from,to:c.to,step:Math.max(b.math.round(Math.abs(c.to-c.from)/this._stepCount,3),0.01),current:c.from,toCheck:c.from!=c.to}}this._updatePublicProps()},_updatePublicProps:function(){for(var a in this._props)this[a]=this._props[a].current}};return b.ui.xy.Slideshow});
define(["../../../../_amd/core"],function(b){b.ui.xy.Spinner=function(a){this.uId=b.getUId();this._domNode=this.backgroundImage=this.background=this.size=null;b.mixin(this,a);this._validateProperties()!==false&&this._initDom()};b.ui.xy.Spinner.prototype={_DARK_BG:"dark",_LIGHT_BG:"light",_PERSONAL_BG:"personal",_DARK_BG_IMAGE:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAAAXNSR0IArs4c6QAABRZJREFUaN7dmU1sVUUYhp+3lD9pSoGCJbSEnxsBYUFkY0ATiL8LF5q4wYQoG7eGlSvjgp0bdUFiwqIadwZNjCwwsiCICCZIiVghQrmBmlap/NSKhbZ5XTA3np7OuX+co8iX3OSemTNn5p33e7+Z+QYKNNu9/sd6+T+a7e2eaS8W1V9LgVi2R8o23xdAbHfbPmp7wHaf7cdzZHCB7fW2N9pea3t2kYy8AXSH/+3AB7bbcwAxC+gBZoWiecCyIoF0p57bgd05ELIkAaJihTJyIsaS7e57YGM2sDRSdatIIL3AYKT8rXtgY0WkbAL4vTAgkkaBvZGqZyLCL9cjcGBBpGpI0lSh4VfSV8DJSNU7jQLJYONPSX/8W+tIjJVu27sb0MaSDEEP3/M6YrvL9pu237X9mu22DFb6gU8zhF8tHJcT4TYm8BuSxrNCdBhfyfZK23OmjSn18n6glJqdfZKORT7cDhwNIXgaW5J6ba8CLqXqVksqBza6UnVTwM8xbdheGNwwOfi/JJ3Pcq1S6rkL2BsYKkWE/35k8tpDfRl4CTgSfjtCGZE1A+BqGoTt+aHf1SkQAPOrMfIF0FbFNQ4FhsYSbQ4CjybeeUXSiTqi1apE0biki6mVfgWwuMpnpiT9kAVkcxByNTBjwEeSDiRcrCLyk7VARELvVNDGVChfGjxhVjUQwGVJN6NAwofagJeBV2uM5QKwJ8lODvutUtplMqLaDDdsiUSkMUkfAjuBviofLAXAednSGiDGgH5Jw7GA0FJl4RuWtAfY02xsz8nuABckXZB0p+kFUVKfpJ3AvjArSevLccBjER38Iqm/HvdVg37cBjwfgkGfpDyBVL7fFkBca3S/9UCYwkxsAFZm7ESnbeiAU5JGCk5czA0L69w6Xh+VNCrbrwNPNtjXe5JOFQRiMfBIg82utjQBAuC5AgnpaiZ0tzwoGmkBvm6i3ZcFjmmwiTZXk2LfUEeD+1HstyRde7DCbwMzNQ/YEvZEA5IGcmaiA+gAJoFhSZO5A7G9DXiau1nAiu3PC0wAkcwNTwJlSXVpprWODtaEXe6iSPUaIC9WOiJjK4Xk3zlJN5oCYnsR8ELq9Pdf2Dxgs+2RsAserwtI0METwFM1OhgCjuUcdjurnE47gU7bZWAwrR9F3GhXSgdpGwcOS/omESq3hLorkq7UqYnOMDiAi5ImQnl3OM9Xc/tJ4GzS3dJA3q4B4hRwMEmv7V1MvwL4pBaYAGJbouimpCOJ+tZwAq22XZlMpqlaI/4Ys4EAYCg1oK3MvMfoAa6E+p6ExvoTADtTbRbaXlvJpAS3OWd7MADqqCWL1ojfL088Xw8A+jNW38cyXK9ySNqRKH/Y9mfhtDcRabfO9uWKi1XyB0BfYLCUmuixakA+DiJfBFySdLgKtTsiW4jbwI+VgUfa9AA/AZeBdUzP/c4GNgGnI8ftEWAkZC87wmSVM4FIug4cqEOoy4CNkarjkm6H/7HoMyf0M2H7fBh40lbaHkjmq1LjKzedfMiw7Rknte/r3lLc1UPsVmpTs9v4RrcSpeAiaTvURP+nY+uF7eWFA0kJmEbXj4jvD+XBSqP37FuZeY3QLBsVOxspe8j2+iIZid3efhuuGNJ2p05WbgHnI1VLigQyGgm3WdmU6w1892JkbSn0evo48FsCxOeJcNv86e7uIvhdAszNDJbyOSE2qKcu4NlU8RlJZ4rKovyb9muR6aBikgHScPB9Elv1wq4n/gZGzjH4jnexGwAAAABJRU5ErkJggg==",
_LIGHT_BG_IMAGE:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAABSxJREFUeNrcWUtoVFcYnplofUTiaBJjMbFpM5gqglI39VHI0JcLKYhFaEGqm+JOXLnqypVubAVByEJB6KpCS10oFRT6sgU1oWlUMDaaQKxJNUljmEwM7ffrd+F4/M+de+/ck5b88HNmzus/3/86j5vNeKS2V1pPodjLv6f77vbv8yUr6xFEB4pLVvVOgPnah7ycR4N0KHUbfQmbF1PLzSi+BEs5Dt4PDV9JyYK1KFrANeAS+B7mnvZlkQMEIVQHPokF1KUAosYAIbQQvMKnazVb/wVEGgFcb4AIaL5PIJobHaDLJbWGLLhRaZr0CUTS6aBS/1kV1lil1Els/OUNCIJPAvyw0vQuNPumVdcfMcBrlaYhyJrxmn4h4DsUvyhNR+MCcVjjMWT8PVv7iGaVZmh4X4zYqHcE9P2q9xFMvhLFJ2Apu8FfQTsTilV60fcsfu5SAv8sXVCjfiPdagE+irGlkBQtY5aAywIYfcsui4imt3MHFkCdmGBbiFXGlXS8K8S1LrPMK+l2xmUNrGEpinYqWIAsB78a5loF678MPIyJjoELSuB/ocitY7sA2cnFCxdZl1FACA3bAQ6ZiyhXFv2S1X+R89CIQd8SsYvOg0+Y7oYx51CsM/p8XOnYwmzValSVMKbPcqNV1LyLZjDmt4ymmeX5/A0U2xT0psU+QL/pR2OjvRwjQKaYyY5HOXth7DTGTXK/kAx1H3X/EEQjLVAbBkLOYhgz5TzGYyKxyIeMkTC6DT6oJYMqzlsF22UcWe0FN6xRtFUGd0FjFzjxSseEYnaxTFcaQCCvCcWykC6isNsAMBZYL9IxHgME+UFoSjLYoRBAvqnMI/1EVfcRTCAa/wiAAnczk0FXigue0NIx5A+nftVl/GwnmC6CTPN6vIRzC4iHcc9bc4Ky1MRaFKsrpLynBzrwVWhqxPPrywJurAsidB+XzTmLQZ/iz1sxZX2OwVc9gZBsuCbmsOFcAhBC73s0SJLs2JibKzEiQL5PMO6CxzUNJhgzbAb72ggD/o/BPon1PJxb6TeGpuThbBMPdnegiTspWyLPS9cT7upPUgcCIVtRvJN59goYUGdaYAjCfBsWEP2YP1LMzIsg4DUe67WTqbSlZZW8srYCH/9uAtBoIiCYQBa+w7r9/RckHrAR6xnhMb4UCQjjQG6Jb1cQMAT+IeW02xBy1Za2BqxP7v2DdvxkFTfaY8WBTaKRi5joRyNVbmLbAOoHIsZEAxf39LYQfEKgK7VWcHsB0WO6m72zVwIh56sjAQjSbvBm8m4spCUiiK184mnn7+D+I5a5UuGhTkCuD3MtFwgJ6HMQMmQtaEvmxe8YAmSA7S1GjPUa1mqwxixF37bgJYVucxN1g7xu5yuFRU7x++eu8OAzmLhTASEu9YbD9YJLUhHcRC6yLsPXE5va+YnBvJ1O8PLWE8zrulHaFjnDIJeM9QcmuRhi3qJyhJDnmd/5u0kZIxaSJ6d7dClz4fPpLteV67ZkrBEAbaV1SvZLZqKvuphwBePJpksQeo19NqDYYLV3o72b7W22n5Muy0tJktNvEupw3NSuRZ2A8aB9lVqf9Bgf1xoFuohN5xPIv67tF5Dx8mxYpKjURd4/FN8fSsMquZjW2MJ7QhrWCKhHqVsMWa/7tIj29fZnx4edckSrSJzcUprqfQIZV9Kt6zXlURwvU/YWr5+nfwI/MEB8A41OVXta5DnrVwPMmMNK6dwQY8aTPOu859pHfLyizCb96fM5yAvxs0SfWcU6L/SvAAMAnAHvLIvCmF4AAAAASUVORK5CYII=",
getDomNode:function(){return this._domNode},_validateProperties:function(){return true},_initDom:function(){this._domNode=document.createElement("img");this._domNode.className="sp_spinner";b.isSet(this.size)&&b.fx.apply(this._domNode,{width:this.size+"px",height:this.size+"px"});if(this.background==this._DARK_BG)this._domNode.src=this._DARK_BG_IMAGE;else if(this.background==this._LIGHT_BG)this._domNode.src=this._LIGHT_BG_IMAGE;else if(this.background==this._PERSONAL_BG)this._domNode.src=this.backgroundImage}};
return b.ui.xy.Spinner});
define(["../../../../_amd/core","../../../../math/_geometric/js/geometric"],function(b){b.ui.xy.CSpinner=function(f){this.uId=b.getUId();this._domNode=null;b.mixin(this,f);if(this._validateProperties()!==false){this._initProperties();this._initDom()}};b.ui.xy.CSpinner.prototype={getDomNode:function(){return this._domNode},toggle:function(){this._timer?this._stopRendering():this._startRendering()},_startRendering:function(){if(!this._timer)this._timer=b.setInterval(this,"_render",this.refreshRate)},
_stopRendering:function(){clearInterval(this._timer);this._timer=null},_render:function(){this._ctx.clearRect(0,0,this.size,this.size);var f=this._ctx,h=this._cx,i=this._cy,j=this._r1,l=this._r2,k=this.count,m=this.space,n=this.linewidth,o=this._grdcolors,p=this.linecolor,q,s,t=(360-m*k)/k,u=0;q=0;for(s=k-this._position-1;q<k;q++){s=(s+1)%k;var r=f,v=h,x=i,B=j,F=l,w=u,y=u+t,E=n,z=o[s],I=p;r.beginPath();var G=d(v,x,B,w);r.moveTo(G.x,G.y);G=y;var J=void 0;J=G>w?false:true;r.arc(v,x,B,c(w-90),c(G-90),
J);G=d(v,x,F,y);r.lineTo(G.x,G.y);G=w;J=void 0;J=G>y?false:true;r.arc(v,x,F,c(y-90),c(G-90),J);G=d(v,x,B,w);r.lineTo(G.x,G.y);r.closePath();d(v,x,B,w+Math.abs(y-w)/2);d(v,x,F,w+Math.abs(y-w)/2);r.fillStyle=z;r.fill();if(E>0){r.lineWidth=E;r.strokeStyle=I||"transparent";r.stroke()}u+=t+m}this._position=(this._position+1)%this.count},_validateProperties:function(){return true},_initDom:function(){var f=this._domNode=document.createElement("canvas");f.translate(0,0);this._ctx=f.getContext("2d");f.width=
this.size;f.height=this.size;this._render();this._startRendering()},_initProperties:function(){var f=this,h=function(i,j){if(f[i]!==0)f[i]=f[i]||j};h("size",25);h("fromcolor","#ccc");h("tocolor","#000");h("stopcolor",0.4);h("linecolor",null);h("radius",7);h("thickness",5);h("count",Math.floor(f.radius*1.5));h("space",10);h("linewidth",1);h("refreshRate",40);f._cx=f.size/2;f._cy=f.size/2;f._r1=f.radius;f._r2=f._r1+f.thickness;f._timer=null;f._grdcolors=e(f.fromcolor,f.tocolor,f.stopcolor,f.count);
f._position=0}};var a=b.math.round,c=b.math.degToRad,d=function(f,h,i,j){return{x:f+i*Math.cos(c(j-90)),y:h+i*Math.sin(c(j-90))}},e=function(f,h,i,j){f=g(f)||{r:0,g:0,b:0,a:1};h=g(h)||{r:255,g:255,b:255,a:1};var l=[],k,m,n=1,o=1/j,p=0;for(m=k=0;k<j;k++,m+=o){var q={r:f.r*n+(1-n)*h.r,g:f.g*n+(1-n)*h.g,b:f.b*n+(1-n)*h.b,a:f.a*n+(1-n)*h.a};l.push("rgba("+a(q.r,0)+","+a(q.g,0)+","+a(q.b,0)+","+a(q.a,2)+")");if(p==0&&m>=i)p=1/(j-k);n-=p;if(k==j-2)n=0}return l},g=function(f){var h=null,i=null;if(!h)if(h=
/^#?([a-fA-F0-9]{1,2})([a-fA-F0-9]{1,2})([a-fA-F0-9]{1,2})$/.exec(f)){for(i=1;i<4;i++)h[i]=h[i].length==1?h[i]+h[i]:h[i];i={r:parseInt(h[1],16),g:parseInt(h[2],16),b:parseInt(h[3],16),a:1}}if(!h)if(h=/[^0-9]*([0-9\.]+)[^0-9]*([0-9\.]+)[^0-9]*([0-9\.]+)[^0-9]*([0-9\.]+)?/.exec(f))i={r:h[1],g:h[2],b:h[3],a:h[4]||1};return i};return b.ui.xy.CSpinner});
define(["../../../../_amd/core"],function(b){b.ui.xy.Trace=function(d){this.uId=b.getUId();b.mixin(this,d);if(this._validateProperties()!==false){this._initProperties();this._initDom();this._initListeners()}};b.ui.xy.Trace.prototype={getDomNode:function(){return this._domNode},toggle:function(){this._timer?this._stopRendering():this._startRendering()},_startRendering:function(){var d=this;if(!d._timer){d=this;var e=d._movements,g=e.length;if(g!=0){var f=g-1;if(e[f].length==0)f=g-2;if((f=e[f])&&f.length>
0){f=(new Date).getTime()-f[f.length-1].t;var h;for(h=0;h<g;h++){var i=e[h];if(!(i.length<=1)){var j,l=i.length;for(j=0;j<l;j++)i[j].t+=f}}}}d._timer=b.setInterval(d,"_render",d.refreshrate)}},_stopRendering:function(){clearInterval(this._timer);this._timer=null},_render:function(){if(!(this.fadeonend&&this._drag)){var d=(new Date).getTime(),e=this.duration,g=[].concat(this._movements);this._clear();var f,h=g.length;for(f=0;f<h;f++){var i=g[f];if(!(i.length<=1))for(var j=1;j<i.length;j++){var l=i[j-
1],k=i[j],m=d-k.t;if(this.fadeonend&&!i.canFade)m=0;if(m>e){i.splice(j-1,1);j=0;a(this._ctx,l,k,this._getColor(0),this.linewidth)}else a(this._ctx,l,k,this._getColor(1-m/e),this.linewidth)}}}},_start:function(d){this._drag=true;this._addPoint(d)},_move:function(d){this._addPoint(d);d=this._movements[this._movements.length-1];var e=d.length;a(this._ctx,d[e-2],d[e-1],this._getColor(1),this.linewidth)},_end:function(d){var e=this._movements,g=e.length;this._addPoint(d);this.onMovement&&this.onMovement(e[g-
1]);this._clearOldMovements();if(this.fadeonend){d=(new Date).getTime();var f;e=this._movements;g=e.length;for(f=0;f<g;f++){var h=e[f];if(!h.canFade){h.canFade=true;var i,j=h.length;for(i=0;i<j;i++)h[i].t=d}}}this._movements.push([]);this._mvtIndex=this._movements.length-1;this._drag=false},_clear:function(){this._ctx.fillStyle="transparent";this._ctx.fillRect(0,0,this.width,this.height);this._domNode.width=this.width},_addPoint:function(d){if(this._movements.length==0){this._movements.push([]);this._mvtIndex=
this._movements.length-1}var e=this._movements[this._mvtIndex],g;g=this._domNode;for(var f={x:0,y:0},h=g;h&&h!=document.body;){var i=b.fx.getTransformPosition(h);f.x+=i.x;f.y+=i.y;h=h.parentNode}g={x:g.getLeftPosition()+f.x,y:g.getTopPosition()+f.y};e.push({x:d.x-g.x,y:d.y-g.y,t:d.timestamp,absx:d.x,absy:d.y})},_getColor:function(d){if(this._linepattern)return this._linepattern;var e=this._linestyle;return"rgba("+e.r+", "+e.g+", "+e.b+", "+d+")"},_clearOldMovements:function(){var d,e=this._movements;
for(d=0;d<e.length;d++)e[d].length<=1&&e.splice(d,1)},_validateProperties:function(){return true},_initDom:function(){var d=this._domNode=document.createElement("canvas");d.translate(0,0);this._ctx=d.getContext("2d");d.width=this.width;d.height=this.height;b.addClass(d,"tr_container");if(!this._linestyle)if(/^data:image.*/.exec(this.linestyle)){d=new Image;d.src=this.linestyle;this._linepattern=this._ctx.createPattern(d,"repeat")}else this._linestyle=c("#000");this._render();this._startRendering()},
_initProperties:function(){var d=this,e=function(g,f){if(d[g]!==0)d[g]=d[g]||f};e("height",200);e("width",200);e("duration",1E3);e("linewidth",1);e("refreshrate",100);e("linestyle","#000");e("fadeonend",false);e("onMovement",null);d._linestyle=c(d.linestyle);d._movements=[];d._mvtIndex=0},_initListeners:function(){var d=this._domNode;b.ux.touch.addListener(d,"start",{context:this,method:"_start"},{preventDefault:true});b.ux.touch.addListener(d,"move",{context:this,method:"_move"});b.ux.touch.addListener(d,
"end",{context:this,method:"_end"})}};var a=function(d,e,g,f,h){d.beginPath();d.moveTo(e.x,e.y);d.lineTo(g.x,g.y);d.closePath();d.strokeStyle=f;d.lineWidth=h;d.stroke()},c=function(d){var e=null,g=null;if(e=/^data:image.*/.exec(d))return null;if(!e)if(e=/^#?([a-fA-F0-9]{1,2})([a-fA-F0-9]{1,2})([a-fA-F0-9]{1,2})$/.exec(d)){for(g=1;g<4;g++)e[g]=e[g].length==1?e[g]+e[g]:e[g];g={r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16),a:1}}if(!e)if(e=/[^0-9]*([0-9\.]+)[^0-9]*([0-9\.]+)[^0-9]*([0-9\.]+)[^0-9]*([0-9\.]+)?/.exec(d))g=
{r:e[1],g:e[2],b:e[3],a:e[4]||1};return g};return b.ui.xy.Trace});
define(["../../../../_amd/core"],function(b){b.ui.xy.ToggleButton=function(a){this.uId=b.getUId();this._switchBtnNode=this._domNode=this.position=this.cssClass=null;this._coordinates={beginX:0,pozX:0,dist:0,hasMoved:false};b.mixin(this,a);if(this._validateProperties()!==false){this._initProperties();this._initDom();this._initListeners()}};b.ui.xy.ToggleButton.prototype={_POSITION_LEFT:"left",_POSITION_RIGHT:"right",_LEFT:1,_RIGHT:0,getDomNode:function(){return this._domNode},_validateProperties:function(){return true},
_initProperties:function(){this.position=b.isSet(this.position)?this.position==this._POSITION_LEFT?this._LEFT:this._RIGHT:this._LEFT},_initDom:function(){this._domNode=document.createElement("div");this._domNode.className="to_toggle";b.isSet(this.cssClass)&&b.addClass(this._domNode,this.cssClass);this._switchBtnNode=document.createElement("div");this._switchBtnNode.className="to_toggle_btn";this._domNode.appendChild(this._switchBtnNode);this._translateButton((0-this.position)*44)},_initListeners:function(){b.ux.touch.addListener(this._switchBtnNode,
"start",{context:this,method:"_startdrag"},{preventDefault:true});b.ux.touch.addListener(this._switchBtnNode,"move",{context:this,method:"_drag"},{preventDefault:true});b.ux.touch.addListener(this._switchBtnNode,"end",{context:this,method:"_enddrag"},{preventDefault:true})},_translateButton:function(a){this._switchBtnNode.translate(a,0)},_onSwitch:function(){this.position=1-this.position;b.fx.applyTransformTransition(this._switchBtnNode,"500ms","0ms","default");this._translateButton((0-this.position)*
44);this.position==this._LEFT?b.publish("/togglebutton/events/switch",{uId:this.uId,position:this._POSITION_LEFT}):b.publish("/togglebutton/events/switch",{uId:this.uId,position:this._POSITION_RIGHT})},_startdrag:function(a){this._coordinates.beginX=a.x;this._coordinates.pozX=a.x;this._coordinates.dist=0;this._coordinates.hasMoved=false;b.fx.applyTransformTransition(this._switchBtnNode,"0s","0s","default")},_drag:function(a){this._coordinates.hasMoved=true;this._coordinates.pozX=a.x;a=this._coordinates.pozX-
this._coordinates.beginX;if(this.position==this._RIGHT&&a>0||this.position==this._LEFT&&a<0)a=0;if(this.position==this._RIGHT&&a<=0&&a>=-44||this.position==this._LEFT&&a>=0&&a<=44){if(this.position==this._LEFT)a-=44;this._coordinates.dist=a;this._translateButton(this._coordinates.dist)}},_enddrag:function(){if(this._coordinates.hasMoved==false||this.position==this._RIGHT&&this._coordinates.dist!=0||this.position==this._LEFT&&this._coordinates.dist!=-44)this._onSwitch();this._coordinates.dist=0;this._coordinates.beginX=
0;this._coordinates.pozX=0;this._coordinates.hasMoved=false}};return b.ui.xy.ToggleButton});
define(["../../../../_amd/core","../../../../fx/_xyz/js/3dfx"],function(b){b.ui.xyz.Wall=function(a){this.uId=b.getUId();this.thumbHeight=75;this.thumbWidth=125;this.thumbMargins=0;this.speed=1.2;this.wallDatas=null;this._slidingDist=350;this._rollerWidth=0;this._stopped=true;this._padRightNode=this._padLeftNode=this._rollerNode=this._wallNode=this._row3Node=this._row2Node=this._row1Node=this._domNode=this._motionTimer=null;b.mixin(this,a);if(this._validateProperties()!==false){this._initProperties();
this._initDom();this._positionTransformOrigin();this._initListeners()}};b.ui.xyz.Wall.prototype={getDomNodes:function(){return{wall:this._domNode,leftPad:this._padLeftNode,rightPad:this._padRightNode}},_addBricks:function(a,c){for(var d=a.length,e=0;e<d;e++){var g=document.createElement("img");g.src=a[e].img;b.fx.apply(g,{height:this.thumbHeight+"px",width:this.thumbWidth+"px"});g.onclick=function(){b.publish("/wall/events/click",{item:this})};c.appendChild(g);g.translate(e*(this.thumbWidth+this.thumbMargins),
0)}},_padLeftStart:function(){var a=b.fx.getTransformPosition(this._wallNode).x,c=this._rollerWidth-document.documentElement.offsetWidth-this._slidingDist+a;if(!(Math.abs(a)>=this._rollerWidth-document.documentElement.offsetWidth-this._slidingDist)){this._stopped=false;b.fx.applyTransformTransition(this._rollerNode,"1s",0,"ease-in");b.fx.applyTransformTransition(this._wallNode,c/this.speed+"ms",0,"ease-in");b.fx.set3dTransform(this._rollerNode,{type:"rotate",x:0,y:1,z:0,angle:30},false);this._wallNode.translate(-(this._rollerWidth-
document.documentElement.offsetWidth-this._slidingDist),0,0);this._motionTimer=b.setTimeout(this,"_padLeftEnd",c/this.speed)}},_padLeftEnd:function(){if(this._stopped==false){clearTimeout(this._motionTimer);var a=b.fx.getTransformPosition(this._wallNode).x;b.fx.applyTransformTransition(this._rollerNode,3*(this._slidingDist/this.speed)-100+"ms",100,"ease-out");b.fx.applyTransformTransition(this._wallNode,3*(this._slidingDist/this.speed)+"ms",0,"ease-out");b.fx.set3dTransform(this._rollerNode,{type:"rotate",
x:0,y:1,z:0,angle:0},false);this._wallNode.translate(a-this._slidingDist,0,0);this._stopped=true}},_padRightStart:function(){var a=b.fx.getTransformPosition(this._wallNode).x,c=Math.abs(a);if(!(Math.abs(a)<=this._slidingDist)){this._stopped=false;b.fx.applyTransformTransition(this._rollerNode,"1s",0,"ease-in");b.fx.applyTransformTransition(this._wallNode,c/this.speed+"ms",0,"ease-in");b.fx.set3dTransform(this._rollerNode,{type:"rotate",x:0,y:1,z:0,angle:-30},false);this._wallNode.translate(-this._slidingDist,
0,0);this._motionTimer=b.setTimeout(this,"_padRightEnd",c/this.speed)}},_padRightEnd:function(){if(this._stopped==false){clearTimeout(this._motionTimer);var a=b.fx.getTransformPosition(this._wallNode).x;b.fx.applyTransformTransition(this._rollerNode,3*(this._slidingDist/this.speed)-100+"ms",100,"ease-out");b.fx.applyTransformTransition(this._wallNode,3*(this._slidingDist/this.speed)+"ms",0,"ease-out");b.fx.set3dTransform(this._rollerNode,{type:"rotate",x:0,y:1,z:0,angle:0},false);this._wallNode.translate(a+
this._slidingDist+this.thumbMargins,0,0);this._stopped=true}},_positionTransformOrigin:function(){b.fx.apply(this._rollerNode,{"transform-origin":document.documentElement.offsetWidth/2+"px"})},_validateProperties:function(){return true},_initProperties:function(){this._rollerWidth=this.wallDatas.row1.length*(this.thumbWidth+this.thumbMargins)},_initListeners:function(){b.ux.touch.addListener(this._padLeftNode,"start",{context:this,method:"_padLeftStart",arguments:null},{preventDefault:true});b.ux.touch.addListener(this._padLeftNode,
"end",{context:this,method:"_padLeftEnd",arguments:null},{preventDefault:true});b.ux.touch.addListener(this._padRightNode,"start",{context:this,method:"_padRightStart",arguments:null},{preventDefault:true});b.ux.touch.addListener(this._padRightNode,"end",{context:this,method:"_padRightEnd",arguments:null},{preventDefault:true});window.addEventListener("orientationchange",b.bind(function(){this._positionTransformOrigin()},this),false)},_initDom:function(){this._domNode=document.createElement("div");
this._row1Node=document.createElement("div");this._row2Node=document.createElement("div");this._row3Node=document.createElement("div");this._wallNode=document.createElement("div");this._rollerNode=document.createElement("div");this._padLeftNode=document.createElement("div");this._padRightNode=document.createElement("div");this._row1Node.id="row1";this._row1Node.className="wa_row";this._row1Node.style.height=this.thumbHeight+4+"px";this._row2Node.id="row2";this._row2Node.className="wa_row";this._row2Node.style.height=
this.thumbHeight+4+"px";this._row3Node.id="row3";this._row3Node.className="wa_row";this._row3Node.style.height=this.thumbHeight+4+"px";this._rollerNode.className="wa_roller";this._rollerNode.style.width=this._rollerWidth+"px";this._padLeftNode.className="wa_padLeft";this._padRightNode.className="wa_padRight";this._addBricks(this.wallDatas.row1,this._row1Node);this._addBricks(this.wallDatas.row2,this._row2Node);this._addBricks(this.wallDatas.row3,this._row3Node);this._wallNode.appendChild(this._row1Node);
this._wallNode.appendChild(this._row2Node);this._wallNode.appendChild(this._row3Node);this._rollerNode.appendChild(this._wallNode);this._domNode.className="wa_container";this._domNode.appendChild(this._rollerNode);document.body.appendChild(this._padLeftNode);document.body.appendChild(this._padRightNode)}};return b.ui.xyz.Wall});
define(["../../../../_amd/core","../../../../math/_geometric/js/geometric","../../../../fx/_xyz/js/3dfx","../../../../ux/movementtracker/js/movementtracker","../../../../ux/gesture/js/gesture","../../../../ux/window/js/window"],function(b){b.ui.xyz.CoverFlow=function(a){this.uId=b.getUId();this.backgroundColor=this.covers=null;this.fadeEdges=this.displayTitle=this.reflected=false;this.size=0;this.viewportWidth=null;this.handleOrientationChange=this.handleGesture=false;this.coverSpacing=null;this.displayTitleDuration=
0;this._timerTitle=this._lastRenderedIndex=this._middleViewIndex=this._renderer=this._transformsQueue=this._transformations=this._positions=this._movementtracker=this._faderRight=this._faderLeft=this._gestureNode=this._trayNode=this._domNode=this.borderSize=null;this._flipping=this._displayMode=this._dragging=false;this._view={x:0,sizeX:0,shiftX:25,shiftFromMiddle:200,coverRotation:55,coverScale:0.28,zMiddleCover:175,zAroundCover:0,numberOfCoverToRender:5,distanceToCenter:0,distanceFromTop:0,zGestureNode:1E3,
observerRotation:0,currentObserverRotation:0};b.mixin(this,a);if(this._validateProperties()!==false){this._initProperties();this._initDom();this._initListeners()}};b.ui.xyz.CoverFlow.prototype={_Z_INDEX_BACKGROUND:5,_DURATION_BACKTO_BOUND:200,_DURATION_MIDDLE:600,_DURATION_AROUND:300,_DURATION_FLIP:1E3,_TRANSITION_FUNC:"default",_OUTOFBOUND_FRICTIONAL_FORCES:4,_RENDERER_INTERVAL:15,_DELAY_BEFORE_IMAGE_LOADING:50,_PERSPECTIVE:500,_REFLECTION_ATTENUATION:0.6,_DELAY_FOR_TITLE_DISPLAY:400,getDomNode:function(){return this._domNode},
updateSize:function(a,c){this.size=a;this.viewportWidth=c;var d=this._view,e=0.07;if(b.isSet(this.coverSpacing))e=this.coverSpacing*0.003;d.shiftX=e*a;this._positions=[];var g;e=this.covers;var f=e.length;for(g=0;g<f;g++)this._positions[g]=d.shiftX*g;d.sizeX=this._positions[f-1];d.shiftFromMiddle=0.7*a;g=Math.max(c/a-1,0);d.distanceToCenter=g*(a/2);d.distanceFromTop=a*(d.coverScale/1.5);d=a*(1+g);g=d+"px";var h=a+"px";b.fx.apply(this._domNode,{width:g,height:h});b.fx.apply(this._trayNode,{width:g,
height:h});b.fx.apply(this._gestureNode,{width:g,height:h});for(g=0;g<f;g++){var i=e[g];b.fx.apply(i.coverNode,{width:h,height:h});b.fx.apply(i.coverInnerNode,{width:h,height:h});b.fx.apply(i.imageNode,{width:h,height:h});b.fx.apply(i.coverReflection,{width:h});this.reflected&&b.fx.apply(i.coverReflectionBack,{width:h,height:this._REFLECTION_ATTENUATION*a+"px"});this.displayTitle&&b.fx.apply(i.titleNode,{width:h})}if(this.fadeEdges){e=this._faderLeft;f=this._faderRight;g=c/15;e.width=g;e.height=a;
f.width=g;f.height=a;f.style.left=d-g+1+"px";this._updateEdgeFaders()}this._createTransformations();this._initTransformations();this._slideTo(this._positions[this._currentPosition],true)},setBackgroundColor:function(a){var c=this.backgroundColor=a;a=this.borderSize;var d={r:255-c.r,g:255-c.g,b:255-c.b};c="rgba("+c.r+", "+c.g+", "+c.b+", 1.0)";this._domNode.style.backgroundColor=c;d=a+"px -"+a+"px 6px rgba("+d.r+", "+d.g+", "+d.b+", 0.5)";var e,g=this.covers,f=g.length;for(e=0;e<f;e++){var h=g[e];
if(this.reflected)h.coverReflectionBack.style.backgroundColor=c;b.isSet(a)&&a>0&&b.fx.apply(h.imageNode,{"box-shadow":d})}this.fadeEdges&&this._updateEdgeFaders()},getPosition:function(){return this._currentPosition},setPosition:function(a){this._slideTo(this._positions[a],true)},_validateProperties:function(){return true},_isValidCover:function(a){var c=true;return c=(c=(c=c&&b.isSet(a))&&b.isSet(a.image))&&b.isSet(a.title)},_initProperties:function(){this._currentPosition=this.position||Math.floor(this.covers.length/
2);this._view.x=0;this._middleViewIndex=Math.floor(this._view.numberOfCoverToRender/2);this._lastRenderedIndex=this._currentPosition;this._transformsQueue=[];this.handleOrientationChange===true&&b.subscribe("/window/events/orientationchange",{context:this,method:"_onOrientationChange"})},_initDom:function(){var a=this._domNode=document.createElement("div");b.fx.apply(a,{"user-select":"none"});var c=this._trayNode=document.createElement("div");c.style.position="absolute";a.appendChild(c);var d=this._gestureNode=
document.createElement("div");d.style.position="absolute";a.appendChild(d);var e=this.covers,g=e.length;for(d=0;d<g;d++){var f=e[d],h=document.createElement("div"),i=document.createElement("div"),j=document.createElement("div"),l=document.createElement("img"),k=document.createElement("div");j.appendChild(l);j.appendChild(k);i.appendChild(j);h.appendChild(i);c.appendChild(h);h.style.position="absolute";j.style.position="absolute";f.coverNode=h;f.coverOutlineNode=i;f.coverInnerNode=j;f.imageNode=l;
f.coverReflection=k;f.transformation=null;f.diffTransform=true;f.displayed=false;if(this.reflected){h=document.createElement("canvas");i=document.createElement("div");k.appendChild(h);k.appendChild(i);h.style.position="absolute";i.style.position="absolute";f.coverReflectionFront=h;f.coverReflectionBack=i}if(this.displayTitle){h=document.createElement("div");k.appendChild(h);h.style.position="absolute";k=$(f.title);h.appendChild(k);f.titleNode=h;f.titleInnerNode=k}b.fx.apply(f.coverNode,{perspective:this._PERSPECTIVE,
"transform-style":"preserve-3d"});b.fx.apply(f.coverOutlineNode,{"transform-style":"preserve-3d"})}if(this.fadeEdges){c=this._faderLeft=document.createElement("canvas");d=this._faderRight=document.createElement("canvas");a.appendChild(c);a.appendChild(d);c.style.position="absolute";d.style.position="absolute"}this._hideBackFaces();this._organizeDepth();this.updateSize(this.size,this.viewportWidth);this.setBackgroundColor(this.backgroundColor);b.setTimeout(this,"_setImages",this._DELAY_BEFORE_IMAGE_LOADING)},
_initListeners:function(){this._movementtracker=new b.ux.MovementTracker({target:this._gestureNode});b.subscribe("/movementtracker/events/mvtbegin",{context:this,method:"_handleMovementBegin"});b.subscribe("/movementtracker/events/mvtchanged",{context:this,method:"_handleMovementChanged"});b.subscribe("/movementtracker/events/mvtstored",{context:this,method:"_handleMovementStored"});if(this.handleGesture){this._gestureNode.listenToGesture("instant_rotation",{context:this,method:"_handleRotation",
arguments:null},{preventDefault:true});this._gestureNode.listenToGesture("gesture_end",{context:this,method:"_handleGestureEnd",arguments:null},{preventDefault:true})}},_handleRotation:function(a){if(this._displayMode==false){var c=this._view;a=c.observerRotation+a.rotation;if(!(a>17||a<-70)){c.currentObserverRotation=a;var d=this.covers,e=d.length;for(a=0;a<e;a++){var g=d[a];b.fx.setTransformPart(g.coverOutlineNode,3,{type:"rotate",x:1,y:0,z:0,angle:c.currentObserverRotation});b.fx.applyComposedTransform(g.coverOutlineNode)}}}},
_handleGestureEnd:function(){if(this._displayMode==false)this._view.observerRotation=this._view.currentObserverRotation},_handleMovementBegin:function(a){if(a.publisher.uId==this._movementtracker.uId)this._dragging=false},_handleMovementChanged:function(a){if(a.publisher.uId==this._movementtracker.uId)if(!this._displayMode){var c=a.movement;a=c.pointStatement[c.pointStatement.length-1];c=a.x-c.pointStatement[c.pointStatement.length-2].x;c/=2;var d=this._getBoundsInfos(this._view.x);if(d.outsideOfBounds)if(d.direction>
0&&a.directionX>0||d.direction<0&&a.directionX<0)c/=this._OUTOFBOUND_FRICTIONAL_FORCES;this._dragging=true;this._slideTo(this._view.x-c)}},_handleMovementStored:function(a){if(a.publisher.uId==this._movementtracker.uId)if(this._dragging==false){if(!this._flipping){var c=this._currentPosition,d=a.movement.pointStatement[a.movement.pointStatement.length-1],e=this._getAbsolutePosition(this._domNode);if(this._displayMode)if(this._onMiddleCover(d.x-e.x,d.y-e.y)){c=a.uxEvent;c.dispatch(c.target,"click")}else{this._flipping=
true;this._unflipCover(c)}else if(this._onMiddleCover(d.x-e.x,d.y-e.y)){a=this.covers[c];if(b.isSet(a.action))b.isCallback(a.action)?b.call(a.action,a):b.log("[CoverFlow] Invalid action for cover : "+c);else if(b.isSet(a.backFaceId)){this._flipping=true;this._prepareCoverBackFace(c);b.setTimeout(this,"_flipCover",1,c)}}}}else this._backToBounds()},_prepareCoverBackFace:function(a){a=this.covers[a];var c=$(a.backFaceId);b.fx.apply(c,{display:"block",position:"absolute",width:this.size+"px",height:this.size+
"px","backface-visibility":"hidden"});b.fx.apply(a.coverInnerNode,{"transform-origin-z":this._view.zMiddleCover+"px","backface-visibility":"hidden"});b.fx.set3dTransform(c,{type:"rotate",x:0,y:1,z:0,angle:180});b.fx.applyTransformTransition(a.coverOutlineNode,"0ms","0ms",this._TRANSITION_FUNC);b.fx.setTransformPart(a.coverOutlineNode,2,{type:"translate",x:0,y:0,z:this._view.zMiddleCover});b.fx.applyComposedTransform(a.coverOutlineNode);a.coverOutlineNode.appendChild(c)},_flipCover:function(a){var c=
this.covers[a];b.fx.onTransitionEnd(c.coverOutlineNode,b.bind(this._postFlipCover,this,a));b.fx.applyTransformTransition(c.coverOutlineNode,this._DURATION_FLIP+"ms","0ms",this._TRANSITION_FUNC);b.fx.setTransformPart(c.coverOutlineNode,1,{type:"rotate",x:0,y:1,z:0,angle:180});b.fx.setTransformPart(c.coverOutlineNode,2,{type:"translate",x:0,y:this._view.distanceFromTop,z:this._view.zMiddleCover*1.5});b.fx.setTransformPart(c.coverOutlineNode,3,{type:"rotate",x:1,y:0,z:0,angle:0});b.fx.applyComposedTransform(c.coverOutlineNode);
this._displayMode=true},_postFlipCover:function(){this._flipping=false;this._gestureNode.style.zIndex=this._Z_INDEX_BACKGROUND;b.fx.set3dTransform(this._gestureNode,{type:"translate",x:0,y:0,z:this._view.zMiddleCover/2})},_unflipCover:function(a){var c=this.covers[a];b.fx.setTransformPart(c.coverOutlineNode,1,{type:"rotate",x:0,y:1,z:0,angle:0});b.fx.setTransformPart(c.coverOutlineNode,2,{type:"translate",x:0,y:0,z:0});b.fx.setTransformPart(c.coverOutlineNode,3,{type:"rotate",x:1,y:0,z:0,angle:this._view.currentObserverRotation});
b.fx.applyComposedTransform(c.coverOutlineNode);b.fx.apply(c.coverInnerNode,{"transform-origin-z":"0px"});b.fx.onTransitionEnd(c.coverOutlineNode,b.bind(this._postUnflipCover,this,a))},_postUnflipCover:function(a){a=this.covers[a];b.fx.applyTransformTransition(a.coverOutlineNode,"0ms","0ms",this._TRANSITION_FUNC);$(a.backFaceId).style.display="none";this._flipping=this._displayMode=false;this._gestureNode.style.zIndex=this._Z_INDEX_BACKGROUND+4;b.fx.set3dTransform(this._gestureNode,{type:"translate",
x:0,y:0,z:this._view.zGestureNode})},_onOrientationChange:function(a){this.updateSize(this.size,a.width)},_getPosition:function(a){var c=null,d,e=this._positions,g=e.length;for(d=0;d<g;d++){c=d;if(a<e[d]+this._view.shiftX/2)break}return c},_slideTo:function(a,c){var d=this._view,e=b.math.round(a,2);if(e!=d.x||c===true){d.x=e;b.fx.set3dTransform(this._trayNode,{type:"translate",x:-d.x+d.distanceToCenter,y:-d.distanceFromTop,z:0});this._updateView()}},_updateView:function(){var a=this._getPosition(this._view.x);
if(a!=this._currentPosition){this._currentPosition=a;this._addToQueue(this._currentPosition)}},_startRenderer:function(){if(this._renderer==null)this._renderer=b.setTimeout(this,"_rendererProcess",1)},_stopRenderer:function(){if(this._renderer!=null){clearTimeout(this._renderer);this._renderer=null}},_rendererProcess:function(){var a=this._transformsQueue,c=a.length,d=a[0];if(d.rendering==false){d.rendering=true;a=d.position;b.fx.onTransitionEnd(this.covers[a].coverInnerNode,b.bind(this._handleCoverRendered,
this,a));this._updateTransformations(a);d=b.math.round(this._DURATION_MIDDLE/(c*2),0);c=b.math.round(this._DURATION_AROUND/(c*2),0);this._updateTransitions(a,d,c);this._applyTransformations()}else if(d.rendered==true){a.shift();c=a.length;if(c==0){this._stopRenderer();return}}else c>1&&this._handleCoverRendered(d.position);this._renderer=b.setTimeout(this,"_rendererProcess",this._RENDERER_INTERVAL)},_handleCoverRendered:function(a){this._lastRenderedIndex=a;a=this._transformsQueue;if(a.length!=0)a[0].rendered=
true},_addToQueue:function(a){this._transformsQueue.push({timestamp:(new Date).getTime(),position:a,rendered:false,rendering:false});this._startRenderer()},_updateTransformations:function(a){var c=this._middleViewIndex+(Math.abs(this._lastRenderedIndex-a)-1),d=a-c,e=a+(c+1),g=this.covers,f=g.length;if(a<c)d=0;if(e>f)e=f;for(c=0;c<f;c++)g[c].diffTransform=false;for(c=d;c<e;c++){d=g[c];d.oldTransformation=d.transformation;d.transformation=this._getTargetedTransformation(c,a);d.diffTransform=this._transformationsDifferent(d.oldTransformation,
d.transformation)}},_updateTransitions:function(a,c,d){var e,g=this.covers,f=g.length;for(e=0;e<f;e++){var h=g[e];if(h.diffTransform){var i=this._TRANSITION_FUNC;e==a?b.fx.applyTransformTransition(h.coverInnerNode,c+"ms","0ms",i):b.fx.applyTransformTransition(h.coverInnerNode,d+"ms","0ms",i)}}},_applyTransformations:function(){var a,c=this.covers,d=c.length;for(a=0;a<d;a++){var e=c[a];if(e.diffTransform){b.fx.setTransformPart(e.coverInnerNode,1,e.transformation.rotation);b.fx.setTransformPart(e.coverInnerNode,
2,e.transformation.translation);b.fx.applyComposedTransform(e.coverInnerNode);if(this.displayTitle){var g=this.displayTitleDuration;if(a==this._currentPosition)if(g>0){if(b.isSet(this._timerTitle)){clearTimeout(this._timerTitle);this._timerTitle=null}this._timerTitle=b.setTimeout(this,"_showTitle",this._DELAY_FOR_TITLE_DISPLAY,a)}else this._showTitle(a);else{g>0&&b.fx.applyTransition(e.titleNode,"opacity","0ms","0ms",this._TRANSITION_FUNC);this._setTitleOpacity(a,0)}}}}},_transformationsDifferent:function(a,
c){return a.rotation.angle!=c.rotation.angle},_initTransformations:function(){var a,c=this.covers,d=c.length;for(a=0;a<d;a++){var e=c[a];b.fx.initComposedTransform(e.coverNode);b.fx.setTransformPart(e.coverNode,1,{type:"scale",x:this._view.coverScale,y:this._view.coverScale,z:1});b.fx.setTransformPart(e.coverNode,2,{type:"translate",x:this._positions[a],y:0,z:0});b.fx.storeComposedTransform(e.coverNode);b.fx.removeComposedTransform(e.coverNode);b.fx.initComposedTransform(e.coverOutlineNode);b.fx.initComposedTransform(e.coverInnerNode);
e.transformation=this._getTargetedTransformation(a,this._currentPosition)}this._applyTransformations();b.fx.set3dTransform(this._gestureNode,{type:"translate",x:0,y:0,z:this._view.zGestureNode})},_createTransformations:function(){var a=this._view,c=a.coverRotation,d=a.zAroundCover,e=a.shiftFromMiddle;this._transformations={left:{rotation:{type:"rotate",x:0,y:1,z:0,angle:c},translation:{type:"translate",x:-e,y:0,z:d}},middle:{rotation:{type:"rotate",x:0,y:1,z:0,angle:0},translation:{type:"translate",
x:0,y:0,z:a.zMiddleCover}},right:{rotation:{type:"rotate",x:0,y:1,z:0,angle:-c},translation:{type:"translate",x:e,y:0,z:d}}}},_getTargetedTransformation:function(a,c){var d=this._transformations;return a<c?d.left:a>c?d.right:d.middle},_showTitle:function(a){if(b.isSet(this._timerTitle)){clearTimeout(this._timerTitle);this._timerTitle=null}if(a==this._currentPosition){var c=this.displayTitleDuration;c>0&&b.fx.applyTransition(this.covers[a].titleNode,"opacity",c+"ms","0ms",this._TRANSITION_FUNC);this._setTitleOpacity(a,
1)}},_setTitleOpacity:function(a,c){this.covers[a].titleNode.style.opacity=c},_hideBackFaces:function(){var a,c=this.covers,d=c.length;for(a=0;a<d;a++){var e=c[a];if(b.isSet(e.backFaceId))$(e.backFaceId).style.display="none"}},_setImages:function(){var a,c=this.covers,d=c.length;for(a=0;a<d;a++){var e=c[a];this.reflected&&this._applyReflection(a);e.imageNode.src=e.image}},_organizeDepth:function(){var a=this._Z_INDEX_BACKGROUND;this._domNode.style.zIndex=a;this._trayNode.style.zIndex=a+1;this._gestureNode.style.zIndex=
a+4;if(this.reflected){var c,d=this.covers,e=d.length;for(c=0;c<e;c++){var g=d[c];if(this.displayTitle)g.titleNode.style.zIndex=a+4;g.coverReflectionFront.style.zIndex=a+3;g.coverReflectionBack.style.zIndex=a+2}}if(this.fadeEdges){this._faderLeft.style.zIndex=a+4;this._faderRight.style.zIndex=a+4}},_applyReflection:function(a){var c=this.covers[a],d=c.imageNode,e=c.coverReflectionFront;c.imageLoadingHandler=b.bind(function(){this._reflect(a,d,e,d.width,d.height)},this);d.addEventListener("load",c.imageLoadingHandler)},
_reflect:function(a,c,d,e,g){d.width=e;d.height=g;d=d.getContext("2d");d.save();d.translate(0,g/1.5);d.scale(1,-1);d.drawImage(c,0,0,e,g/1.5);d.restore();d.globalCompositeOperation="destination-out";var f=d.createLinearGradient(0,0,0,g);f.addColorStop(0,"rgba(255, 255, 255, "+this._REFLECTION_ATTENUATION+")");f.addColorStop(0.6,"rgba(255, 255, 255, 1.0)");d.fillStyle=f;d.fillRect(0,0,e,g);c.removeEventListener("load",this.covers[a].imageLoadingHandler)},_updateEdgeFaders:function(){var a=this.backgroundColor,
c=this._faderLeft,d=this._faderRight,e=c.getContext("2d"),g=e.createLinearGradient(0,0,c.width,0);g.addColorStop(0,"rgba("+a.r+", "+a.g+", "+a.b+", 1.0)");g.addColorStop(1,"rgba("+a.r+", "+a.g+", "+a.b+", 0.0)");e.fillStyle=g;e.fillRect(0,0,c.width,c.height);e=d.getContext("2d");g=e.createLinearGradient(0,0,d.width,0);g.addColorStop(0,"rgba("+a.r+", "+a.g+", "+a.b+", 0.0)");g.addColorStop(1,"rgba("+a.r+", "+a.g+", "+a.b+", 1.0)");e.fillStyle=g;e.fillRect(0,0,d.width,d.height)},_backToBounds:function(){var a=
this._getBoundsInfos(this._view.x);if(a.outsideOfBounds){this._slideTo(a.positionOfBound,this._DURATION_BACKTO_BOUND);return true}return false},_getBoundsInfos:function(a){var c=this._view,d={};d.outsideOfBounds=false;if(a<0||a>c.sizeX){d.outsideOfBounds=true;if(a<0){d.distanceToBound=Math.abs(a);d.direction=1;d.positionOfBound=0}else{d.distanceToBound=Math.abs(a-c.sizeX);d.direction=-1;d.positionOfBound=c.sizeX}}return d},_onMiddleCover:function(a,c){var d=this._view,e=this.size,g=b.math.round,f=
g(e*d.coverScale*1.5,0),h=g(e/2-f/2-d.distanceFromTop,0),i=g(e/2-f/2+d.distanceToCenter,0),j=h+f;f=i+f;if(this._displayMode){f=g(e*d.coverScale*2.1,0);h=g(e/2-f/2-d.distanceFromTop/2.1,0);i=g(e/2-f/2+d.distanceToCenter,0);j=h+f;f=i+f}if(a>=i&&a<=f&&c>=h&&c<=j)return true;return false},_getAbsolutePosition:function(a){for(var c={x:0,y:0},d=a;d&&d!=document.body;){var e=b.fx.getTransformPosition(d);c.x+=e.x;c.y+=e.y;d=d.parentNode}return{x:a.getLeftPosition()+c.x,y:a.getTopPosition()+c.y}}};return b.ui.xyz.CoverFlow});
define(["../../../../_amd/core","../../../../math/_geometric/js/geometric","../../../../fx/_xyz/js/3dfx","../../../../ux/movementtracker/js/movementtracker"],function(b){b.ui.xyz.Cube=function(a){this.uId=b.getUId();this._properties=a;this._axis=this._faces=null;this._view={size:0,shiftX:0,shiftY:0,shiftZ:0,observerX:0,observerY:0,rotationX:0,rotationY:0,externalRotationX:0,externalRotationY:0};this._selectionEvent=this._radius=this._movementtracker=this._domNode=this._rotationEndCallback=this._rotationCallback=
this._dispatch=this._focusDuration=this._focus=null;this._dragging=false;this._nearestFace=this._rotations=null;if(this._validateProperties()!==false){this._initProperties();this._initDom();this._initListeners()}};b.ui.xyz.Cube.prototype={getDomNode:function(){return this._domNode},rotate:function(a,c,d){this._view.externalRotationX=b.math.round((this._view.externalRotationX+a)%360,3);this._view.externalRotationY=b.math.round((this._view.externalRotationY+c)%360,3);this._rotateWithDuration(a,c,d)},
faceFocus:function(a){this._faceFocus(a)},setFace:function(a){var c=a.id-1;this._faces[c].faceNode.removeChild(this._faces[c].innerNode);for(var d in a)this._faces[c][d]=a[d];this._faces[c].innerNode=$(this._faces[c].faceId);this._faces[c].faceNode.appendChild(this._faces[c].innerNode)},_validateProperties:function(){return true},_raisePropertyError:function(a){b.log("[Cube] Error: "+a+" missing or invalid")},_isValidFace:function(a){var c=true;return c=(c=(c=(c=c&&b.isSet(a))&&b.isSet(a.id))&&b.isSet(a.faceId))&&
a.id>0&&a.id<7},_initProperties:function(){this._faces=[].concat(this._properties.faces);this._view.size=this._properties.size;this._radius=this._view.size/2;this._axis=null;if(b.isSet(this._properties.axis)&&(this._properties.axis=="x"||this._properties.axis=="y"||this._properties.axis=="xy"))this._axis=this._properties.axis;if(b.isSet(this._view.shiftX))this._view.shiftX=this._properties.shiftX;if(b.isSet(this._view.shiftY))this._view.shiftY=this._properties.shiftY;if(b.isSet(this._properties.shiftZ))this._view.shiftZ=
this._properties.shiftZ;this._view.observerX=this._radius;if(b.isSet(this._properties.observerX))this._view.observerX=this._properties.observerX;this._view.observerY=this._radius;if(b.isSet(this._properties.observerY))this._view.observerY=this._properties.observerY;this._focus=false;if(this._properties.focus===true)this._focus=true;this._focusDuration=0;if(b.isSet(this._properties.focusDuration)&&this._properties.focusDuration>0)this._focusDuration=this._properties.focusDuration;this._dispatch=false;
if(this._properties.dispatch===true)this._dispatch=true;this._rotationCallback=null;if(b.isSet(this._properties.rotationCallback))this._rotationCallback=this._properties.rotationCallback;this._rotationEndCallback=null;if(b.isSet(this._properties.rotationEndCallback))this._rotationEndCallback=this._properties.rotationEndCallback},_initDom:function(){this._domNode=document.createElement("div");b.fx.apply(this._domNode,{position:"absolute","user-select":"none",perspective:800,"perspective-origin":this._view.observerX+
"px "+this._view.observerY+"px",width:this._view.size+"px",height:this._view.size+"px",left:this._view.shiftX+"px",top:this._view.shiftY+"px"});this._cubeNode=document.createElement("div");b.fx.apply(this._cubeNode,{"transform-style":"preserve-3d",width:this._view.size+"px",height:this._view.size+"px"});this._domNode.appendChild(this._cubeNode);for(var a=0;a<this._faces.length;a++){var c=this._faces[this._faces[a].id-1];c.faceNode=document.createElement("div");b.fx.apply(c.faceNode,{position:"absolute",
width:this._view.size+"px",height:this._view.size+"px"});c.innerNode=$(c.faceId);this._cubeNode.appendChild(c.faceNode);c.faceNode.appendChild(c.innerNode)}this._initTransformations()},_initListeners:function(){if(this._axis!=null||this._rotationCallback!=null||this._rotationEndCallback!=null){this._movementtracker=new b.ux.MovementTracker({target:this._domNode});b.subscribe("/movementtracker/events/mvtbegin",{context:this,method:"_handleMovementBegin"});b.subscribe("/movementtracker/events/mvtchanged",
{context:this,method:"_handleMovementChanged"});b.subscribe("/movementtracker/events/mvtstored",{context:this,method:"_handleMovementStored"})}},_handleMovementBegin:function(a){if(a.publisher.uId==this._movementtracker.uId){this._dragging=false;this._selectionEvent=a.uxEvent;b.fx.applyTransformTransition(this._cubeNode,"0ms","0ms","linear")}},_handleMovementChanged:function(a){if(a.publisher.uId==this._movementtracker.uId)if(this._axis!=null||this._rotationCallback!=null||this._rotationEndCallback!=
null){a=a.movement;var c=a.pointStatement[a.pointStatement.length-2],d=a.pointStatement[a.pointStatement.length-1];a=d.x-c.x;c=d.y-c.y;d=b.math.getAngle(this._view.size,a);if(a<0)d=-d;a=b.math.getAngle(this._view.size,c);if(c<0)a=-a;this._dragging=true;c=b.math.round(b.math.radToDeg(d),3);a=b.math.round(b.math.radToDeg(a),3);this._rotate(c,a);this._view.externalRotationX=b.math.round((this._view.externalRotationX+c)%360,3);this._view.externalRotationY=b.math.round((this._view.externalRotationY+a)%
360,3);this._notifyRotation({x:c,y:a})}},_handleMovementStored:function(a){if(a.publisher.uId==this._movementtracker.uId)if(this._dragging==false){if(this._dispatch&&b.isSet(this._selectionEvent)){this._selectionEvent.dispatch(this._selectionEvent.target,"click");this._selectionEvent=null}}else{this._storeRotation();this._notifyRotationEnd({x:this._view.externalRotationX,y:this._view.externalRotationY});this._view.externalRotationX=0;this._view.externalRotationY=0;this._focus==true&&this._faceFocus(this._focusDuration)}},
_notifyRotation:function(a){this._rotationCallback!=null&&b.call(this._rotationCallback,a)},_notifyRotationEnd:function(a){this._rotationEndCallback!=null&&b.call(this._rotationEndCallback,a)},_rotateWithDuration:function(a,c,d){b.fx.applyTransformTransition(this._cubeNode,d+"ms","0ms","linear");this._rotate(a,c,true);this._storeRotation()},_faceFocus:function(a){this._updateNearestFace();b.fx.removeComposedTransform(this._cubeNode);b.fx.initComposedTransform(this._cubeNode);this._view.rotationX=
0;this._view.rotationY=0;this._storeRotation();this._initNormalVectors();var c=this._rotations[this._nearestFace.index];this.rotate(c.y*-c.angle,c.x*c.angle,a)},_updateNearestFace:function(){this._nearestFace={index:0,angle:0};for(var a=0;a<6;a++)if(this._faces[a].angle>this._nearestFace.angle){this._nearestFace.index=a;this._nearestFace.angle=this._faces[a].angle}},_initTransformations:function(){this._rotations=[];this._rotations[0]={type:"rotate",x:1,y:0,z:0,angle:0};this._rotations[1]={type:"rotate",
x:0,y:1,z:0,angle:90};this._rotations[2]={type:"rotate",x:0,y:1,z:0,angle:180};this._rotations[3]={type:"rotate",x:0,y:1,z:0,angle:-90};this._rotations[4]={type:"rotate",x:1,y:0,z:0,angle:90};this._rotations[5]={type:"rotate",x:1,y:0,z:0,angle:-90};this._initNormalVectors();for(var a=0;a<this._faces.length;a++){b.fx.initComposedTransform(this._faces[a].faceNode);b.fx.setTransformPart(this._faces[a].faceNode,1,{type:"translate",x:0,y:0,z:this._radius});b.fx.setTransformPart(this._faces[a].faceNode,
2,this._rotations[a]);b.fx.applyComposedTransform(this._faces[a].faceNode)}b.fx.initComposedTransform(this._cubeNode);b.fx.setTransformPart(this._cubeNode,3,{type:"translate",x:0,y:0,z:this._view.shiftZ});b.fx.applyComposedTransform(this._cubeNode)},_rotate:function(a,c,d){if(this._axis=="y"||this._axis=="xy"||d){this._view.rotationX=b.math.round((this._view.rotationX+a)%360,3);b.fx.setTransformPart(this._cubeNode,1,{type:"rotate",x:0,y:1,z:0,angle:this._view.rotationX})}if(this._axis=="x"||this._axis==
"xy"||d){this._view.rotationY=b.math.round((this._view.rotationY-c)%360,3);b.fx.setTransformPart(this._cubeNode,2,{type:"rotate",x:1,y:0,z:0,angle:this._view.rotationY})}b.fx.applyComposedTransform(this._cubeNode)},_storeRotation:function(){b.fx.setTransformPart(this._cubeNode,1,{type:"rotate",x:0,y:1,z:0,angle:this._view.rotationX});b.fx.setTransformPart(this._cubeNode,2,{type:"rotate",x:1,y:0,z:0,angle:this._view.rotationY});b.fx.setTransformPart(this._cubeNode,3,null);b.fx.storeComposedTransform(this._cubeNode);
b.fx.setTransformPart(this._cubeNode,3,{type:"translate",x:0,y:0,z:this._view.shiftZ});b.fx.applyComposedTransform(this._cubeNode);this._updateNormalVectors();this._view.rotationX=0;this._view.rotationY=0},_initNormalVectors:function(){for(var a=[0,0,1],c=0;c<6;c++){var d=b.math.createTransformMatrix();d.rotateAxisAngle(this._rotations[c].x,this._rotations[c].y,this._rotations[c].z,-this._rotations[c].angle);this._faces[c].normalVector=b.math.multiplyMatrixVector(d.getValues(),a)}},_updateNormalVectors:function(){for(var a=
[0,0,-1],c=0;c<6;c++){var d=b.math.createTransformMatrix();d.rotateAxisAngle(0,1,0,-this._view.rotationX);d.rotateAxisAngle(1,0,0,-this._view.rotationY);this._faces[c].normalVector=b.math.multiplyMatrixVector(d.getValues(),this._faces[c].normalVector);d=b.math.getAngleBetweenVectors(a,this._faces[c].normalVector);this._faces[c].angle=b.math.radToDeg(d)}}};return b.ui.xyz.Cube});
define(["../../../../_amd/core","../../../../fx/_xyz/js/3dfx","../../../../fx/_animation/js/animation","../../../../ux/gesture/js/gesture"],function(b){b.ui.xyz.FlipDisc=function(a){this.uId=b.getUId();this.images=null;this.shiftY=this.offsetY=0;this._domNode=null;this._elements=[];this._transformations=[];this._initialized=false;this._currentPosition=0;this._doubleClick=this._runningStep=false;this._oldRotation=this._currentRotation=0;b.mixin(this,a);if(this._validateProperties()!==false){this._initDom();
this._initListeners()}};b.ui.xyz.FlipDisc.prototype={_Z_INDEX_BACKGROUND:5,getDomNode:function(){return this._domNode},next:function(){if(this._runningStep!=true){this._runningStep=true;var a={transform:function(c,d){b.fx.set3dTransform(c.node,d)},_nextStep1:function(c){b.fx.animate(c,{property:"transform",value:{context:this,method:"transform",arguments:[{type:"rotate",x:1,y:0,z:0,angle:-120}]},duration:800,delay:1,func:"cubic-bezier(0.6, 0, 0.9, 0)"},{onEnd:{context:a,method:"_nextStep2",arguments:[c]}})},
_nextStep2:b.bind(function(c,d){this._currentPosition=(this._currentPosition+1)%this.images.length;this._organizeDepth();this._applyTransformations({context:a,method:"_nextStep3",arguments:[d]});b.fx.animate(d,{property:"transform",value:{context:a,method:"transform",arguments:[{type:"rotate",x:1,y:0,z:0,angle:-0.1}]},duration:200,delay:200,func:"default"})},this),_nextStep3:b.bind(function(){this._runningStep=false},this)};a._nextStep1(this._elements[this._currentPosition].imgNode)}},previous:function(){if(this._runningStep!=
true){this._runningStep=true;var a={transform:function(c,d){b.fx.set3dTransform(c.node,d)},_previousStep1:function(c){b.fx.animate(c,{property:"transform",value:{context:a,method:"transform",arguments:[{type:"rotate",x:1,y:0,z:0,angle:-120}]},duration:10,delay:1,func:"cubic-bezier(0.6, 0, 0.9, 0)"},{onEnd:{context:a,method:"_previousStep2",arguments:[c]}})},_previousStep2:b.bind(function(c,d){this._currentPosition=(this._currentPosition+this.images.length-1)%this.images.length;this._organizeDepth();
this._applyTransformations();b.fx.animate(d,{property:"transform",value:{context:a,method:"transform",arguments:[{type:"rotate",x:1,y:0,z:0,angle:-0.1}]},duration:600,delay:200,func:"default"},{onEnd:{context:a,method:"_previousStep3",arguments:[d]}})},this),_previousStep3:b.bind(function(){this._runningStep=false},this)};a._previousStep1(this._elements[(this._currentPosition-1+this.images.length)%this.images.length].imgNode)}},_handleOneDigitClick:function(){this._runningStep!=true&&this._doubleClick!=
true&&b.publish("/flipdisc/events/click",{image:this.images[this._currentPosition],index:this._currentPosition})},_handleRotation:function(a){if(this._runningStep!=true){this._doubleClick=true;this._currentRotation=b.math.round(a.rotation-this._oldRotation,0);this._oldRotation=a.rotation;this._currentRotation>=0?this.next():this.previous()}},_handleOneDigitStart:function(){this._doubleClick=false},_handleGestureEnd:function(){this._oldRotation=0;this._doubleClick=true},_validateProperties:function(){return true},
_initDom:function(){this._domNode=document.createElement("div");b.fx.apply(this._domNode,{width:"100%",height:"100%","user-select":"none"});for(var a=0;a<this.images.length;a++){var c=document.createElement("div"),d=document.createElement("img");b.fx.apply(c,{perspective:"1000",position:"absolute",width:"100%",height:"100%"});b.fx.apply(d,{"box-shadow":"2px -2px 6px rgba(0, 0, 0, 0.5)",display:"none",width:"100%",height:"99%"});d.src=this.images[a];c.appendChild(d);this._domNode.appendChild(c);this._elements[a]=
{containerNode:c,imgNode:d}}this._organizeDepth();this._createTransformations();this._applyTransformations({context:this,method:"_initDomEnd"})},_initDomEnd:function(){for(var a=0;a<this.images.length;a++){var c=this._elements[a].imgNode;b.fx.apply(c,{display:"","transform-origin":"0px 100%"});b.fx.set3dTransform(c,{type:"rotate",x:1,y:0,z:0,angle:-0.1})}this._initialized=true},_initListeners:function(){b.ux.touch.addListener(this._domNode,"start",{context:this,method:"_handleOneDigitStart"},{preventDefault:true});
b.ux.touch.addListener(this._domNode,"end",{context:this,method:"_handleOneDigitClick"});this._domNode.listenToGesture("rotation",{context:this,method:"_handleRotation"},{preventDefault:true});this._domNode.listenToGesture("gesture_end",{context:this,method:"_handleGestureEnd"},{preventDefault:true})},_organizeDepth:function(){if(!b.has("css-perspective"))for(var a=this._Z_INDEX_BACKGROUND+this.images.length,c=0;c<this.images.length;c++){this._elements[(this._currentPosition+c)%this.images.length].containerNode.style.zIndex=
a;a--}},_createTransformations:function(){for(var a=0.8,c=this.offsetY,d=0,e=1,g=0;g<this.images.length;g++){this._transformations[g]={scale:{type:"scale",x:a,y:a,z:1},translate:{type:"translate",x:0,y:c-d,z:-g}};a-=a*0.2;e-=e*0.2;d+=this.shiftY*e;b.fx.initComposedTransform(this._elements[g].containerNode);b.fx.initComposedTransform(this._elements[g].imgNode)}},transform:function(a,c){for(var d=a.node,e=0;e<c.length;e++)b.fx.setTransformPart(d,e+1,c[e]);b.fx.applyComposedTransform(d)},_applyTransformations:function(a){for(var c=
new b.fx.animation.AnimationGroup,d=0;d<this.images.length;d++){var e=(this._currentPosition+d)%this.images.length,g=(d+1)%this.images.length,f=[this._transformations[d].scale,this._transformations[d].translate],h=new b.fx.animation.Animation;h.addStep({property:"transform",value:{context:this,method:"transform",arguments:[f]},duration:this._initialized?600:0,delay:this._initialized?g*50:0,func:"default"});c.addAnimation(this._elements[e].containerNode,h)}c.start({onEnd:a})}};return b.ui.xyz.FlipDisc});
define(["../../../../_amd/core","../../../../math/_geometric/js/geometric","../../../../fx/_xyz/js/3dfx"],function(b){b.ui.xyz.Opener=function(a){this.uId=b.getUId();this.opened=false;this.image=null;this.width=this.height=0;this.panelHeight=20;this.panelsAngle=140;this.openerXAngle=10;this.openerYAngle=15;this.duration=500;this._panelAngle=this._nbPanels=0;this._panelsList=[];this._contentNode=this._panelsNode=this._domNode=null;b.mixin(this,a);if(this._validateProperties()!==false){this._initProperties();
this._initDom();this._initListeners()}};b.ui.xyz.Opener.prototype={getDomNode:function(){return this._domNode},open:function(){b.fx.initComposedTransform(this._panelsNode,false);b.fx.setTransformPart(this._panelsNode,1,{type:"rotate",x:0,y:1,z:0,angle:this.openerYAngle});b.fx.setTransformPart(this._panelsNode,2,{type:"rotate",x:1,y:0,z:0,angle:this.openerXAngle});b.fx.applyComposedTransform(this._panelsNode);this._domNode.style.height="0px";for(var a=this._panelsList.length-1;a>0;a--)this._panelsList[a].open();
this.opened=true},close:function(){b.fx.setTransformPart(this._panelsNode,1,{type:"rotate",x:0,y:1,z:0,angle:0});b.fx.setTransformPart(this._panelsNode,2,{type:"rotate",x:1,y:0,z:0,angle:0});b.fx.applyComposedTransform(this._panelsNode);this._domNode.style.height="auto";for(var a=this._panelsList.length-1;a>0;a--)this._panelsList[a].close();this.opened=false},toggle:function(){this.opened?this.close():this.open()},_handleClick:function(){this.toggle();b.publish("/opener/events/click",{openerId:this.uId})},
_validateProperties:function(){return true},_initListeners:function(){b.subscribe("/opener.panel/events/click",{context:this,method:"_handleClick"})},_initProperties:function(){this._nbPanels=Math.ceil(this.height/this.panelHeight);this._panelAngle=this.panelsAngle/this._nbPanels},_initDom:function(){this._domNode=document.createElement("div");this._domNode.className="op_container";b.fx.apply(this._domNode,{height:this.height+"px",width:this.width+"px"});this._panelsNode=document.createElement("div");
this._panelsNode.className="op_panels";b.fx.apply(this._panelsNode,{"transform-origin":"100% 0","transform-style":"preserve-3d"});for(var a=0;a<this._nbPanels;a++){var c=new b.ui.xyz.Opener.Panel({index:a,image:this.image,height:this.panelHeight,angle:this._panelAngle});this._panelsList.push(c);this._panelsNode.appendChild(c.getDomNode());b.fx.applyTransformTransition(c.getDomNode(),this.duration+"ms","0ms","linear")}this._domNode.appendChild(this._panelsNode);b.fx.applyTransformTransition(this._panelsNode,
this.duration+"ms","0ms","linear")}};b.ui.xyz.Opener.Panel=function(a){this.uId=b.getUId();this.image=this.index=null;this._z=this._y=this.angle=this.height=0;this._domNode=null;b.mixin(this,a);this._initProperties();this._initDom()};b.ui.xyz.Opener.Panel.prototype={getDomNode:function(){return this._domNode},open:function(){b.fx.initComposedTransform(this._domNode,false);b.fx.setTransformPart(this._domNode,1,{type:"rotate",x:1,y:0,z:0,angle:this.angle*this.index});b.fx.setTransformPart(this._domNode,
2,{type:"translate",x:0,y:this._y,z:this._z});b.fx.applyComposedTransform(this._domNode)},close:function(){b.fx.setTransformPart(this._domNode,1,{type:"rotate",x:1,y:0,z:0,angle:0});b.fx.setTransformPart(this._domNode,2,{type:"translate",x:0,y:this.index*this.height,z:0});b.fx.applyComposedTransform(this._domNode)},_initProperties:function(){for(var a=0;a<this.index;a++){this._y+=Math.cos(b.math.degToRad(this.angle*a))*this.height;this._z+=Math.sin(b.math.degToRad(this.angle*a))*this.height}},_initDom:function(){this._domNode=
document.createElement("div");this._domNode.className="op_panel";b.fx.apply(this._domNode,{height:this.height+2+"px","transform-origin":"0 0",backgroundImage:"url("+this.image+")",backgroundRepeat:"no-repeat",backgroundPositionX:"0",backgroundPositionY:-this.index*this.height+"px"});this._domNode.onclick=function(){b.publish("/opener.panel/events/click",{panelId:this.uId})};this._domNode.winkTranslate(0,this.index*this.height)}};return b.ui.xyz.Opener});
define(["../../../../_amd/core","../../../../math/_geometric/js/geometric","../../../../fx/_xyz/js/3dfx","../../../../ux/movementtracker/js/movementtracker"],function(b){b.ui.xyz.TagCloud=function(a){this.uId=b.getUId();this.selectedTextColor=this.textColor=this.size=null;this.scaleFactors={ratioDepth:0.6,ratioRating:0.8};this.canSelect=this.canMove=false;this.axis=null;this.shiftY=this.shiftX=0;this._isCircle=this._opacities=this._selection=this._selectCoords=this._overNode=this._domNode=this.tags=
this.asCircle=null;b.mixin(this,a);if(this._validateProperties()!==false){this._initProperties();this._initDom();this._initListeners()}};b.ui.xyz.TagCloud.prototype={_MAX_RATING:100,_Z_INDEX_BACKGROUND:5,_OPACITY_NOT_VISIBLE_FACE:0.2,_OPACITY_VISIBLE_FACE:0.98,_LIGHT_PI:b.math.round(Math.PI,3),_FRICTIONAL_FORCES:0.5,getDomNode:function(){return this._domNode},setTextColor:function(a,c){if(b.isSet(a))if(b.isSet(c)){this.textColor=a;this.selectedTextColor=c;this._updateTextColor()}},_validateProperties:function(){return true},
_raisePropertyError:function(a){b.log("[TagCloud] Error: "+a+" missing or invalid")},_initProperties:function(){this._isCircle=!b.isSet(this.asCircle)||!b.isSet(this.asCircle.tilt)?false:true;this._opacities=[];var a=this._OPACITY_NOT_VISIBLE_FACE,c=this.size*2+1,d=(this._OPACITY_VISIBLE_FACE-a)/(this.size*2),e=0;for(a=a;e<c;e++,a+=d)this._opacities[e]=b.math.round(a,2);c=this.tags.length;for(e=0;e<c;e++){d=this.tags[e];if(d.rating<0)d.rating=0;else if(d.rating>this._MAX_RATING)d.rating=this._MAX_RATING;
d.coeffRating=b.math.round(this.scaleFactors.ratioRating*(d.rating/this._MAX_RATING),2)}},_initDom:function(){this._domNode=document.createElement("div");this._overNode=document.createElement("div");this._domNode.appendChild(this._overNode);var a,c=this.tags.length;for(a=0;a<c;a++){var d=this.tags[a],e=document.createElement("div");this._domNode.appendChild(e);e.style.position="absolute";e.appendChild($(d.id));d.tagNode=e;d.colorOpacity=1}b.fx.apply(this._domNode,{position:"absolute",width:"100%",
height:"100%"});b.fx.apply(this._overNode,{position:"absolute",width:"100%",height:"100%","user-select":"none",zIndex:this._Z_INDEX_BACKGROUND});this._updateTextColor();console.log("b4 initTrtans:",b.fx);this._initTransformations();this._slide(0.1,0.1)},_initListeners:function(){if(this.canMove==true||this.canSelect==true){this._movementtracker=new b.ux.MovementTracker({target:this._overNode});b.subscribe("/movementtracker/events/mvtbegin",{context:this,method:"_handleMovementBegin"});b.subscribe("/movementtracker/events/mvtchanged",
{context:this,method:"_handleMovementChanged"});b.subscribe("/movementtracker/events/mvtstored",{context:this,method:"_handleMovementStored"})}},_handleMovementBegin:function(a){if(a.publisher.uId==this._movementtracker.uId){this._dragging=false;if(this.canSelect==true){a=a.movement.pointStatement[0];var c={x:this._overNode.getLeftPosition(),y:this._overNode.getTopPosition()};this._selectCoords={x:a.x-c.x,y:a.y-c.y}}}},_handleMovementChanged:function(a){if(a.publisher.uId==this._movementtracker.uId)if(this.canMove==
true){a=a.movement;var c=a.pointStatement[a.pointStatement.length-2],d=a.pointStatement[a.pointStatement.length-1];a=d.x-c.x;c=d.y-c.y;d=b.math.getAngle(this.size,a);if(a<0)d=-d;a=b.math.getAngle(this.size,c);if(c<0)a=-a;this._dragging=true;this._slide(d,a)}},_handleMovementStored:function(a){a.publisher.uId==this._movementtracker.uId&&this._dragging==false&&this.canSelect==true&&this._handleChoice(this._selectCoords.x,this._selectCoords.y)},_slide:function(a,c){this._updateAngles(a,c);this._updateCoords();
this._updateOpacity();this._updateTextSize();this._applyTransformations()},_updateOpacity:function(){var a,c=this.tags.length;for(a=0;a<c;a++){var d=this.tags[a],e=b.math.round(d.coords.z+this.size,0),g=this._opacities[e];b.isSet(g)||b.log("[TagCloud] warn: opacity not defined for z-position "+e);d.colorOpacity=g}},_updateTextSize:function(){var a,c=this.tags.length;for(a=0;a<c;a++){var d=this.tags[a],e=b.math.round(d.coords.z+this.size,0);d.coeffDepth=b.math.round(this.scaleFactors.ratioDepth*(e/
(this.size*2)),2);d.coeffScale=d.coeffDepth+d.coeffRating}},_updateAngles:function(a,c){this._angleX=b.math.round(a*this._FRICTIONAL_FORCES%(this._LIGHT_PI*2),3);this._angleY=b.math.round(c*this._FRICTIONAL_FORCES%(this._LIGHT_PI*2),3)},_updateCoords:function(){var a,c=this.tags.length;for(a=0;a<c;a++){var d=this.tags[a],e=[d.coords.x,d.coords.y,d.coords.z],g=b.math.createTransformMatrix();if(this.axis=="x"||this.axis=="xy")g.rotateAxisAngle(1,0,0,b.math.radToDeg(this._angleY));var f=b.math.createTransformMatrix();
if(this.axis=="y"||this.axis=="xy")f.rotateAxisAngle(0,1,0,b.math.radToDeg(-this._angleX));e=b.math.multiplyMatrixVector(g.getValues(),e);f=b.math.multiplyMatrixVector(f.getValues(),e);e=f[0];g=f[1];var h=f[2];if(this._isCircle)if(this.axis=="x")e=f[2]*-this.asCircle.tilt;else g=f[2]*this.asCircle.tilt;d.coords={x:e,y:g,z:h}}},_applyTransformations:function(){var a,c=this.tags.length;for(a=0;a<c;a++){var d=this.tags[a];b.fx.setTransformPart(d.tagNode,1,{type:"scale",x:d.coeffScale,y:d.coeffScale,
z:1});b.fx.setTransformPart(d.tagNode,2,{type:"translate",x:d.coords.x,y:d.coords.y,z:d.coords.z});b.fx.applyComposedTransform(d.tagNode)}this._updateTextColor()},_handleChoice:function(a,c){this._selection=null;var d=this._getNearestFaceIndex(a,c);if(d!=null){this._selection=this.tags[d].tagNode;d=this.tags[d];this._updateTextColor();b.publish("/tagcloud/events/selection",{tag:d})}},_getNearestFaceIndex:function(a,c){var d=null,e=[],g,f=this.tags.length;for(g=0;g<f;g++){var h=this.tags[g],i=h.tagNode.offsetWidth,
j=h.tagNode.offsetHeight,l=i*h.coeffScale-i,k=j*h.coeffScale-j,m=h.coords.x+this.size+this.shiftX-l/2;h=h.coords.y+this.size+this.shiftY-k/2;i=m+i+l;j=h+j+k;j=c>h&&c<j;a>m&&a<i&&j&&e.push(g)}f=-this.size;for(g=0;g<e.length;g++){m=e[g];j=this.tags[m].coords.z;if(j>f){f=j;d=m}}return d},_initTransformations:function(){for(var a=this.size,c=b.math.round(this._LIGHT_PI*(3-Math.sqrt(5)),2),d=2/this.tags.length,e=2*Math.PI/this.tags.length,g=this.tags.length,f=0,h=0,i=1-d/2;f<g;f++,h+=c,i-=d){var j=this.tags[f];
if(this._isCircle){var l=0,k=0;if(this.axis=="x"){l=e*f;k=Math.PI/2}else l=e*f+Math.PI/2;j.coords={x:a*Math.cos(k)*Math.cos(l),y:a*Math.cos(l)*Math.sin(k),z:a*Math.sin(l)}}else{l=a*Math.sqrt(1-i*i);j.coords={x:Math.cos(h)*l,y:Math.sin(h)*l,z:i*a}}console.log("tagcld:",b.fx);b.fx.initComposedTransform(j.tagNode)}b.fx.set3dTransform(this._domNode,{type:"translate",x:this.size+this.shiftX,y:this.size+this.shiftY,z:0});b.fx.set3dTransform(this._overNode,{type:"translate",x:-this.size-this.shiftX,y:-this.size-
this.shiftY,z:this.size})},_updateTextColor:function(){if(b.isSet(this.textColor)){var a=this.textColor,c,d=this.tags.length;for(c=0;c<d;c++){var e=this.tags[c];e.tagNode.style.color="rgba("+a.r+", "+a.g+", "+a.b+", "+e.colorOpacity+")"}}if(this._selection!=null&&b.isSet(this.selectedTextColor)){a=this.selectedTextColor;this._selection.style.color="rgba("+a.r+", "+a.g+", "+a.b+", 1)"}}};return b.ui.xyz.TagCloud});
define(["../../../_amd/core","../../../ui/layout/slidingpanels/js/slidingpanels","../../../ui/xy/spinner/js/spinner"],function(b){b.plugins.AsyncPanels=function(a){this.uId=b.getUId();this.pages=null;this.transitionType="default";this.duration=800;this.i18n={en_EN:{loading:"loading..."},fr_FR:{loading:"chargement..."}};this._sp=null;this._spPages=[];this._xhr=this._textNode=this._spinnerNode=this._loaderNode=null;b.mixin(this,a);if(this._validateProperties()!==false){this._initProperties();this._initDom()}};
b.plugins.AsyncPanels.prototype={slideTo:function(a){for(var c=this.pages.length,d=0;d<c;d++)if(b.isString(this.pages[d])&&this.pages[d]==a||!b.isString(this.pages[d])&&this.pages[d].id==a&&this.pages[d].loaded==true)this._sp.slideTo(a);else if(!b.isString(this.pages[d])&&this.pages[d].id==a&&!b.isSet(this.pages[d].loaded)){this._xhr=new b.Xhr({id:a,index:d});b.layer.show();var e=window.getComputedStyle(this._loaderNode).height,g=window.getComputedStyle(this._loaderNode).width;this._loaderNode.style.top=
(window.innerHeight-e.substring(0,e.length-2))/2+window.pageYOffset+"px";this._loaderNode.style.left=(window.innerWidth-g.substring(0,g.length-2))/2+"px";this._loaderNode.style.visibility="visible";this._xhr.sendData(this.pages[d].url,b.isSet(this.pages[d].parameters)?this.pages[d].parameters:null,b.isSet(this.pages[d].method)?this.pages[d].method:"GET",{method:"_onSuccess",context:this},{method:"_onFailure",context:this},null)}},slideBack:function(){this._sp.slideBack()},getDomNode:function(){return this._sp.getDomNode()},
_onSuccess:function(a){$(a.params.id).innerHTML=a.xhrObject.responseText;this._loaderNode.style.visibility="hidden";b.layer.hide();this.pages[a.params.index].loaded=true;this._sp.slideTo(a.params.id)},_onFailure:function(a){this._loaderNode.style.visibility="hidden";b.layer.hide();this._sp.slideTo(a.params.id)},_initDom:function(){this._sp=new b.ui.layout.SlidingPanels({duration:this.duration,transitionType:this.transitionType,pages:this._spPages});this._loaderNode=document.createElement("div");this._textNode=
document.createElement("div");this._loaderNode.className="w_window w_border w_radius w_bg_dark asp_loader";this._textNode.className="asp_text";this._textNode.innerHTML=_("loading",this);this._spinnerNode=(new b.ui.xy.Spinner({background:"dark",size:20})).getDomNode();this._loaderNode.appendChild(this._spinnerNode);this._loaderNode.appendChild(this._textNode);document.body.appendChild(this._loaderNode)},_initProperties:function(){for(var a=this.pages.length,c=0;c<a;c++)this._spPages[c]=b.isString(this.pages[c])?
this.pages[c]:this.pages[c].id},_validateProperties:function(){return true}};return b.plugins.AsyncPanels});
define(["../../../_amd/core","../../../fx/_xyz/js/3dfx","../../../math/_geometric/js/geometric"],function(b){b.plugins.SharingWheel=function(a){this.uId=b.getUId();this.shareItems=null;this.height=100;this._nbPetals=0;this._petalsList=[];this._slope=this._startY=this._startX=this._currentAngle=this._originAngle=this._originY=this._originX=0;this._linkNode=this._petalsNode=this._domNode=null;b.mixin(this,a);if(this._validateProperties()!==false){this._initProperties();this._initDom();this._initListeners()}};
b.plugins.SharingWheel.prototype={getDomNode:function(){return this._domNode},_initDom:function(){this._domNode=document.createElement("div");this._domNode.className="sh_wheel w_border w_bg_dark";b.fx.apply(this._domNode,{height:this.height+"px ",width:this.height+"px ","border-radius":this.height/2+"px"});this._petalsNode=document.createElement("div");this._petalsNode.className="sh_petals";this._linkNode=document.createElement("a");this._linkNode.target="_blank";for(var a=0;a<this._nbPetals;a++){var c=
document.createElement("div");c.className=a==0?"sh_petal selected":"sh_petal";b.ua.isAndroid?b.fx.apply(c,{height:this.height/2+"px ",width:this.height/2+"px ","transform-origin":this.height/2+1+"px "+this.height/2+"px"}):b.fx.apply(c,{height:this.height/2+"px ",width:this.height/2+"px ","transform-origin":this.height/2+1+"px "+this.height/2+"px","transform-style":"preserve-3d"});c.rotate(a*(360/this._nbPetals)+180/this._nbPetals);var d=document.createElement("div");d.className="sh_content";d.innerHTML=
this.shareItems[a].title;var e=Math.sqrt(2*Math.pow(this.height/2,2)*(1-Math.cos(b.math.degToRad(360/this._nbPetals)))),g=Math.sqrt(Math.pow(this.height/2,2)-Math.pow(e/2,2));b.fx.apply(d,{"transform-origin":b.ua.isAndroid?"100% 50%":"100% 0",width:e+"px"});b.fx.initComposedTransform(d);b.fx.setTransformPart(d,1,{type:"translate",x:0,y:g-this.height/2,z:0});b.fx.setTransformPart(d,2,{type:"rotate",x:0,y:0,z:1,angle:-180/this._nbPetals});b.fx.applyComposedTransform(d);c.appendChild(d);this._petalsNode.appendChild(c);
a==0?this._petalsList.push({petal:c,start:360-180/this._nbPetals,stop:180/this._nbPetals}):this._petalsList.push({petal:c,start:a*(360/this._nbPetals)-180/this._nbPetals,stop:a*(360/this._nbPetals)+180/this._nbPetals})}this._domNode.appendChild(this._petalsNode)},_initListeners:function(){b.ux.touch.addListener(this._domNode,"start",{context:this,method:"_touchStart",arguments:null},{preventDefault:true});b.ux.touch.addListener(this._domNode,"move",{context:this,method:"_touchMove",arguments:null},
{preventDefault:true});b.ux.touch.addListener(this._domNode,"end",{context:this,method:"_touchEnd",arguments:null},{preventDefault:true})},_touchStart:function(a){this._originX=this._petalsNode.getLeftPosition()+this.height/2;this._originY=this._petalsNode.getTopPosition()+this.height/2;this._startX=a.x;this._startY=a.y;this._slope=(this._originY-this._startY)/(this._startX-this._originX);this._petalsNode.rotate(this._originAngle)},_touchMove:function(a){var c=a.x;a=a.y;var d=Math.sqrt(Math.pow(this._startY-
this._originY,2)+Math.pow(this._startX-this._originX,2)),e=Math.sqrt(Math.pow(a-this._originY,2)+Math.pow(c-this._originX,2)),g=Math.sqrt(Math.pow(a-this._startY,2)+Math.pow(c-this._startX,2));this._currentAngle=b.math.radToDeg(Math.acos((d*d+e*e-g*g)/(2*d*e)));if(this._startX<this._originX)this._currentAngle=-this._currentAngle;if((c-this._originX)*this._slope<this._originY-a)this._currentAngle=-this._currentAngle;this._petalsNode.rotate(this._originAngle+this._currentAngle);this._selectPetal()},
_touchEnd:function(){this._originAngle+=this._currentAngle;if(this._originAngle>180)this._originAngle-=360;if(this._originAngle<-180)this._originAngle+=360;this._getSelectedPetal()},_selectPetal:function(){var a=this._originAngle+this._currentAngle;if(a>180)a-=360;if(a<-180)a+=360;if(a<0)a=360+a;a=360-a;if(a>=360-180/this._nbPetals||a<180/this._nbPetals){b.addClass(this._petalsList[0].petal,"selected");this._petalsList[0].selected=true}else{b.removeClass(this._petalsList[0].petal,"selected");this._petalsList[0].selected=
false}for(var c=1;c<this._petalsList.length;c++)if(a>=this._petalsList[c].start&&a<this._petalsList[c].stop){b.addClass(this._petalsList[c].petal,"selected");this._petalsList[c].selected=true}else{b.removeClass(this._petalsList[c].petal,"selected");this._petalsList[c].selected=false}},_getSelectedPetal:function(){for(var a=0;a<this._petalsList.length;a++)if(this._petalsList[a].selected==true){b.publish("/share/events/select",{itemId:a});if(!b.isUndefined(this.shareItems[a].shareUrl)&&this.shareItems[a].shareUrl!=
""){this._linkNode.href=this.shareItems[a].shareUrl;a=document.createEvent("MouseEvents");a.initEvent("click",true,true);this._linkNode.dispatchEvent(a)}return}},_initProperties:function(){this._nbPetals=this.shareItems.length},_validateProperties:function(){return true}};return b.plugins.SharingWheel});
define(["../../../_amd/core"],function(b){b.plugins.ScrollToRefresh=function(i){this.uId=b.getUId();b.mixin(this,i);if(this._validateProperties()!==false){this._initProperties();this._initDom();this.scroller.updateTargetSize()}};b.plugins.ScrollToRefresh.prototype={onScrolling:function(){var i=this.scroller.getViewProperties(),j=i.y;i=i.limitY;if(j>0){if(this._pds)if(j>this._pdoff)h(this._pds,c);else this._pds.isTriggered()&&j<this._pdoff-10&&h(this._pds,a)}else if(this._pus)if(j<i-this._puoff)h(this._pus,
c);else this._pus.isTriggered()&&j<this._puoff-10&&h(this._pus,a)},onEndScrolling:function(){var i=this;if(i._pds&&i._pds.isTriggered()){h(i._pds,d);i.scroller.updateShiftBounds(0,i._puoff);i.onTopReleased(function(){i._onLoaded(i._pds)})}if(i._pus&&i._pus.isTriggered()){h(i._pus,d);i.scroller.updateShiftBounds(i._pdoff,0);i.onBottomReleased(function(){i._onLoaded(i._pus)})}},_onLoaded:function(i){h(i,a);this.scroller.updateTargetSize();this.scroller.updateShiftBounds(this._pdoff,this._puoff)},_initDom:function(){if(this.topsection){this._pds=
f(this.topsection,"top");var i=this._pds.node,j=this.scrollerContent.childNodes;this.scrollerContent.insertBefore(i,j.length>0?j[0]:null);this._pdoff=i.offsetHeight}if(this.bottomsection){this._pus=f(this.bottomsection,"bottom");i=this._pus.node;this.scrollerContent.appendChild(i);this._puoff=i.offsetHeight}this.scroller.updateShiftBounds(this._pdoff,this._puoff)},_initProperties:function(){this._pdoff=this._puoff=0},_validateProperties:function(){return true}};var a="wait",c="triggered",d="released",
e=b.addClass,g=function(i,j){i.appendChild(j)},f=function(i,j){var l={state:"",isTriggered:function(){return this.state==c},angle:j=="top"?180:0,rotate:function(){this.angle=this.angle==0?180:0;this.icon.translate(0,0);this.icon.rotate(this.angle)}};b.mixin(l,i);var k=document.createElement("div"),m=document.createElement("div"),n=document.createElement("div"),o=document.createElement("div"),p=document.createElement("div"),q=document.createElement("div"),s=document.createElement("div"),t=document.createElement("div"),
u=document.createElement("div"),r=document.createElement("div");e(k,"str_section w_layout_box "+j);e(m,"str_sp w_expand");e(n,"str_sp w_expand");e(o,"str_text w_layout_box");e(p,"str_icon");e(q,"str_label "+a);e(s,"str_label "+c);e(t,"str_label "+d);e(r,"str_sp_box");b.fx.applyTransformTransition(p,"150ms","0ms","default");t.appendChild(r);t.appendChild(u);o.appendChild(p);o.appendChild(q);o.appendChild(s);o.appendChild(t);k.appendChild(m);k.appendChild(o);k.appendChild(n);q.innerHTML=l.waitText;
s.innerHTML=l.triggeredText;u.innerHTML=l.releasedText;g(r,l.spinner.getDomNode());l.node=k;l.spinnerNode=r;l.icon=p;l.rotate();h(l,a);return l},h=function(i,j){if(!(j==a&&i.state==a))if(!(j==c&&i.state!=a))if(!(j==d&&i.state!=c)){b.removeClass(i.node,i.state);e(i.node,j);i.state=j;j!=d&&i.rotate()}};return b.plugins.ScrollToRefresh});
define(["../../../_amd/core"],function(b){b.plugins.ScrollToLoad=function(a){this.uId=b.getUId();b.mixin(this,a);if(this._validateProperties()!==false){this._initProperties();this._initDom();this._initListeners();this._status=this._LOADING_STATUS;this._toggleStatus();this._contentHeight=this._pageCount=this._currentPage=0;this._updatePage()}};b.plugins.ScrollToLoad.prototype={_WAIT_STATUS:"wait",_LOADING_STATUS:"loading",onScroll:function(){if(this._status!=this._LOADING_STATUS){var a=this._currentPage,
c=this._contentHeight;this._updatePage();if(a!=this._currentPage||c!=this._contentHeight)this.onPageChanged(this._currentPage,this._pageCount,b.bind(this._loadMore,this),b.bind(this._wait,this))}},onClick:function(){this.onLoadMore(b.bind(this._loadMore,this),b.bind(this._wait,this))},_loadMore:function(){this._toggleStatus()},_wait:function(){this._toggleStatus();this.content.appendChild(this.loadingNode);this.scroller&&this.scroller.updateTargetSize()},_updatePage:function(){if(this.scroller)var a=
this.scroller.getViewProperties(),c=a.sizeY,d=a.viewportSizeY,e=-a.y;else{c=document.documentElement.scrollHeight;d=window.innerHeight;e=window.pageYOffset}var g=this.pageSize||d;a=c/g;g=this.pageSize||d;a=c/g;d=e+d;g=d/g;a=Math.max(Math.ceil(a),1);g=Math.floor(g);if(d>=c-2)g=a;this._pageCount=a;this._currentPage=g;this._contentHeight=c},_toggleStatus:function(){b.removeClass(this.loadingNode,this._status);this._status=this._status==this._LOADING_STATUS?this._WAIT_STATUS:this._LOADING_STATUS;b.addClass(this.loadingNode,
this._status)},_initDom:function(){var a=document.createElement("div"),c=document.createElement("div"),d=document.createElement("div"),e=document.createElement("div"),g=document.createElement("div"),f=document.createElement("div"),h=document.createElement("div");b.addClass(a,"stl_section w_layout_box");b.addClass(f,"stl_sp w_expand");b.addClass(h,"stl_sp w_expand");b.addClass(g,"stl_text w_layout_box");b.addClass(c,"stl_sp_box");b.addClass(d,"stl_label "+this._WAIT_STATUS);b.addClass(e,"stl_label "+
this._LOADING_STATUS);g.appendChild(c);g.appendChild(d);g.appendChild(e);a.appendChild(f);a.appendChild(g);a.appendChild(h);c.appendChild(this.spinner.getDomNode());d.innerHTML=this.waitText;e.innerHTML=this.loadingText;this.loadingNode=a;this.content.appendChild(a);this.scroller&&this.scroller.updateTargetSize()},_initListeners:function(){this.scroller||window.addEventListener("scroll",b.bind(this.onScroll,this),false);this.loadingNode.addEventListener("click",b.bind(this.onClick,this),false)},_initProperties:function(){},
_validateProperties:function(){return true}};return b.plugins.ScrollToLoad});
